; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.30319.01 

	TITLE	C:\Users\faelhs\mu-1.1\eMu - GameServer Sapphire S0\GameServer\SQLManager.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?gSQLManager@@3VSQLClass@@A			; gSQLManager
PUBLIC	?m_SqlConn@@3U_TAG_SQLCONNECTION@@A		; m_SqlConn
_BSS	SEGMENT
?gSQLManager@@3VSQLClass@@A DB 01600H DUP (?)		; gSQLManager
?m_SqlConn@@3U_TAG_SQLCONNECTION@@A DB 0604H DUP (?)	; m_SqlConn
_BSS	ENDS
PUBLIC	__$ArrayPad$
PUBLIC	?Execute@SQLClass@@QAAXPADZZ			; SQLClass::Execute
EXTRN	?Close@CBoundRecordSet@@QAE_NXZ:PROC		; CBoundRecordSet::Close
EXTRN	?Execute@CSQL@@QAE_NPBDPAVCBoundRecordSet@@_N@Z:PROC ; CSQL::Execute
EXTRN	_vsprintf:PROC
EXTRN	___security_cookie:DWORD
EXTRN	@__security_check_cookie@4:PROC
EXTRN	_memset:PROC
; Function compile flags: /Ogtp
; File c:\users\faelhs\mu-1.1\emu - gameserver sapphire s0\gameserver\sqlmanager.cpp
;	COMDAT ?Execute@SQLClass@@QAAXPADZZ
_TEXT	SEGMENT
_szBuffer$ = -1028					; size = 1024
__$ArrayPad$ = -4					; size = 4
_this$ = 8						; size = 4
_szQuery$ = 12						; size = 4
?Execute@SQLClass@@QAAXPADZZ PROC			; SQLClass::Execute, COMDAT

; 53   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 04 04 00
	00		 sub	 esp, 1028		; 00000404H
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax

; 54   : 	char szBuffer[1024] = {0};

  00013	68 ff 03 00 00	 push	 1023			; 000003ffH
  00018	8d 85 fd fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp+1]
  0001e	6a 00		 push	 0
  00020	50		 push	 eax
  00021	c6 85 fc fb ff
	ff 00		 mov	 BYTE PTR _szBuffer$[ebp], 0
  00028	e8 00 00 00 00	 call	 _memset

; 55   : 	// ---
; 56   : 	va_list pArguments;
; 57   : 	// ---
; 58   : 	va_start(pArguments, szQuery);
; 59   : 	// ---
; 60   : 	vsprintf(szBuffer, szQuery, pArguments);

  0002d	8b 55 0c	 mov	 edx, DWORD PTR _szQuery$[ebp]
  00030	8d 4d 10	 lea	 ecx, DWORD PTR _szQuery$[ebp+4]
  00033	51		 push	 ecx
  00034	52		 push	 edx
  00035	8d 85 fc fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp]
  0003b	50		 push	 eax
  0003c	e8 00 00 00 00	 call	 _vsprintf
  00041	83 c4 18	 add	 esp, 24			; 00000018H

; 61   : 	// ---
; 62   : 	va_end(pArguments);
; 63   : 	// ---
; 64   : 	PointsSql.Execute(szBuffer, &rsSql, true);

  00044	6a 01		 push	 1
  00046	68 00 00 00 00	 push	 OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  0004b	8d 8d fc fb ff
	ff		 lea	 ecx, DWORD PTR _szBuffer$[ebp]
  00051	51		 push	 ecx
  00052	b9 00 00 00 00	 mov	 ecx, OFFSET ?PointsSql@@3VCSQL@@A ; PointsSql
  00057	e8 00 00 00 00	 call	 ?Execute@CSQL@@QAE_NPBDPAVCBoundRecordSet@@_N@Z ; CSQL::Execute

; 65   : 	// ---
; 66   : 	rsSql.Close();

  0005c	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00061	e8 00 00 00 00	 call	 ?Close@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Close

; 67   : }

  00066	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00069	33 cd		 xor	 ecx, ebp
  0006b	e8 00 00 00 00	 call	 @__security_check_cookie@4
  00070	8b e5		 mov	 esp, ebp
  00072	5d		 pop	 ebp
  00073	c3		 ret	 0
?Execute@SQLClass@@QAAXPADZZ ENDP			; SQLClass::Execute
_TEXT	ENDS
PUBLIC	__$ArrayPad$
PUBLIC	?ReturnInt@SQLClass@@QAAHPAD0ZZ			; SQLClass::ReturnInt
EXTRN	?ToShortS@CSQLValue@@QAEFXZ:PROC		; CSQLValue::ToShortS
EXTRN	?Values@CBoundRecordSet@@QAE?AVCSQLValue@@PBD@Z:PROC ; CBoundRecordSet::Values
EXTRN	?Fetch@CBoundRecordSet@@QAE_NXZ:PROC		; CBoundRecordSet::Fetch
; Function compile flags: /Ogtp
;	COMDAT ?ReturnInt@SQLClass@@QAAHPAD0ZZ
_TEXT	SEGMENT
$T157358 = -1036					; size = 8
_szBuffer$ = -1028					; size = 1024
__$ArrayPad$ = -4					; size = 4
_this$ = 8						; size = 4
_szField$ = 12						; size = 4
_szQuery$ = 16						; size = 4
?ReturnInt@SQLClass@@QAAHPAD0ZZ PROC			; SQLClass::ReturnInt, COMDAT

; 95   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 0c 04 00
	00		 sub	 esp, 1036		; 0000040cH
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	56		 push	 esi
  00014	8b 75 0c	 mov	 esi, DWORD PTR _szField$[ebp]

; 96   : 	char szBuffer[1024] = {0};

  00017	68 ff 03 00 00	 push	 1023			; 000003ffH
  0001c	8d 85 fd fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp+1]
  00022	6a 00		 push	 0
  00024	50		 push	 eax
  00025	c6 85 fc fb ff
	ff 00		 mov	 BYTE PTR _szBuffer$[ebp], 0
  0002c	e8 00 00 00 00	 call	 _memset

; 97   : 	// ---
; 98   : 	va_list pArguments;
; 99   : 	// ---
; 100  : 	va_start(pArguments, szQuery);
; 101  : 	// ---
; 102  : 	vsprintf(szBuffer, szQuery, pArguments);

  00031	8b 55 10	 mov	 edx, DWORD PTR _szQuery$[ebp]
  00034	8d 4d 14	 lea	 ecx, DWORD PTR _szQuery$[ebp+4]
  00037	51		 push	 ecx
  00038	52		 push	 edx
  00039	8d 85 fc fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp]
  0003f	50		 push	 eax
  00040	e8 00 00 00 00	 call	 _vsprintf
  00045	83 c4 18	 add	 esp, 24			; 00000018H

; 103  : 	// ---
; 104  : 	va_end(pArguments);
; 105  : 	// ---
; 106  : 	PointsSql.Execute(szBuffer, &rsSql, true);

  00048	6a 01		 push	 1
  0004a	68 00 00 00 00	 push	 OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  0004f	8d 8d fc fb ff
	ff		 lea	 ecx, DWORD PTR _szBuffer$[ebp]
  00055	51		 push	 ecx
  00056	b9 00 00 00 00	 mov	 ecx, OFFSET ?PointsSql@@3VCSQL@@A ; PointsSql
  0005b	e8 00 00 00 00	 call	 ?Execute@CSQL@@QAE_NPBDPAVCBoundRecordSet@@_N@Z ; CSQL::Execute

; 107  : 	// ---
; 108  : 	rsSql.Fetch();

  00060	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00065	e8 00 00 00 00	 call	 ?Fetch@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Fetch

; 109  : 	// ---
; 110  : 	int value = rsSql.Values(szField).ToShortS();

  0006a	56		 push	 esi
  0006b	8d 95 f4 fb ff
	ff		 lea	 edx, DWORD PTR $T157358[ebp]
  00071	52		 push	 edx
  00072	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00077	e8 00 00 00 00	 call	 ?Values@CBoundRecordSet@@QAE?AVCSQLValue@@PBD@Z ; CBoundRecordSet::Values
  0007c	8b c8		 mov	 ecx, eax
  0007e	e8 00 00 00 00	 call	 ?ToShortS@CSQLValue@@QAEFXZ ; CSQLValue::ToShortS

; 111  : 	// ---
; 112  : 	rsSql.Close();

  00083	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00088	0f bf f0	 movsx	 esi, ax
  0008b	e8 00 00 00 00	 call	 ?Close@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Close

; 113  : 	// ---
; 114  : 	return value;
; 115  : }

  00090	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00093	8b c6		 mov	 eax, esi
  00095	33 cd		 xor	 ecx, ebp
  00097	5e		 pop	 esi
  00098	e8 00 00 00 00	 call	 @__security_check_cookie@4
  0009d	8b e5		 mov	 esp, ebp
  0009f	5d		 pop	 ebp
  000a0	c3		 ret	 0
?ReturnInt@SQLClass@@QAAHPAD0ZZ ENDP			; SQLClass::ReturnInt
_TEXT	ENDS
PUBLIC	__$ArrayPad$
PUBLIC	?ReturnInt64@SQLClass@@QAA_JPAD0ZZ		; SQLClass::ReturnInt64
EXTRN	?ToI64U@CSQLValue@@QAE_KXZ:PROC			; CSQLValue::ToI64U
; Function compile flags: /Ogtp
;	COMDAT ?ReturnInt64@SQLClass@@QAA_JPAD0ZZ
_TEXT	SEGMENT
$T157363 = -1036					; size = 8
_szBuffer$ = -1028					; size = 1024
__$ArrayPad$ = -4					; size = 4
_this$ = 8						; size = 4
_szField$ = 12						; size = 4
_szQuery$ = 16						; size = 4
?ReturnInt64@SQLClass@@QAA_JPAD0ZZ PROC			; SQLClass::ReturnInt64, COMDAT

; 118  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 0c 04 00
	00		 sub	 esp, 1036		; 0000040cH
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	56		 push	 esi
  00014	8b 75 0c	 mov	 esi, DWORD PTR _szField$[ebp]
  00017	57		 push	 edi

; 119  : 	char szBuffer[1024] = {0};

  00018	68 ff 03 00 00	 push	 1023			; 000003ffH
  0001d	8d 85 fd fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp+1]
  00023	6a 00		 push	 0
  00025	50		 push	 eax
  00026	c6 85 fc fb ff
	ff 00		 mov	 BYTE PTR _szBuffer$[ebp], 0
  0002d	e8 00 00 00 00	 call	 _memset

; 120  : 	// ---
; 121  : 	va_list pArguments;
; 122  : 	// ---
; 123  : 	va_start(pArguments,szQuery);
; 124  : 	// ---
; 125  : 	vsprintf(szBuffer, szQuery, pArguments);

  00032	8b 55 10	 mov	 edx, DWORD PTR _szQuery$[ebp]
  00035	8d 4d 14	 lea	 ecx, DWORD PTR _szQuery$[ebp+4]
  00038	51		 push	 ecx
  00039	52		 push	 edx
  0003a	8d 85 fc fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp]
  00040	50		 push	 eax
  00041	e8 00 00 00 00	 call	 _vsprintf
  00046	83 c4 18	 add	 esp, 24			; 00000018H

; 126  : 	// ---
; 127  : 	va_end(pArguments);
; 128  : 	// ---
; 129  : 	PointsSql.Execute(szBuffer, &rsSql, true);

  00049	6a 01		 push	 1
  0004b	68 00 00 00 00	 push	 OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00050	8d 8d fc fb ff
	ff		 lea	 ecx, DWORD PTR _szBuffer$[ebp]
  00056	51		 push	 ecx
  00057	b9 00 00 00 00	 mov	 ecx, OFFSET ?PointsSql@@3VCSQL@@A ; PointsSql
  0005c	e8 00 00 00 00	 call	 ?Execute@CSQL@@QAE_NPBDPAVCBoundRecordSet@@_N@Z ; CSQL::Execute

; 130  : 	// ---
; 131  : 	rsSql.Fetch();

  00061	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00066	e8 00 00 00 00	 call	 ?Fetch@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Fetch

; 132  : 	// ---
; 133  : 	__int64 value = rsSql.Values(szField).ToI64U();

  0006b	56		 push	 esi
  0006c	8d 95 f4 fb ff
	ff		 lea	 edx, DWORD PTR $T157363[ebp]
  00072	52		 push	 edx
  00073	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00078	e8 00 00 00 00	 call	 ?Values@CBoundRecordSet@@QAE?AVCSQLValue@@PBD@Z ; CBoundRecordSet::Values
  0007d	8b c8		 mov	 ecx, eax
  0007f	e8 00 00 00 00	 call	 ?ToI64U@CSQLValue@@QAE_KXZ ; CSQLValue::ToI64U

; 134  : 	// ---
; 135  : 	rsSql.Close();

  00084	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00089	8b f0		 mov	 esi, eax
  0008b	8b fa		 mov	 edi, edx
  0008d	e8 00 00 00 00	 call	 ?Close@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Close

; 136  : 	// ---
; 137  : 	return value;
; 138  : }

  00092	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  00095	8b d7		 mov	 edx, edi
  00097	5f		 pop	 edi
  00098	8b c6		 mov	 eax, esi
  0009a	33 cd		 xor	 ecx, ebp
  0009c	5e		 pop	 esi
  0009d	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000a2	8b e5		 mov	 esp, ebp
  000a4	5d		 pop	 ebp
  000a5	c3		 ret	 0
?ReturnInt64@SQLClass@@QAA_JPAD0ZZ ENDP			; SQLClass::ReturnInt64
_TEXT	ENDS
PUBLIC	__$ArrayPad$
PUBLIC	?ReturnFloat@SQLClass@@QAAMPAD0ZZ		; SQLClass::ReturnFloat
EXTRN	?ToFloat@CSQLValue@@QAEMXZ:PROC			; CSQLValue::ToFloat
EXTRN	__fltused:DWORD
; Function compile flags: /Ogtp
;	COMDAT ?ReturnFloat@SQLClass@@QAAMPAD0ZZ
_TEXT	SEGMENT
$T157368 = -1036					; size = 8
_value$ = -1032						; size = 4
_szBuffer$ = -1028					; size = 1024
__$ArrayPad$ = -4					; size = 4
_this$ = 8						; size = 4
_szField$ = 12						; size = 4
_szQuery$ = 16						; size = 4
?ReturnFloat@SQLClass@@QAAMPAD0ZZ PROC			; SQLClass::ReturnFloat, COMDAT

; 141  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 0c 04 00
	00		 sub	 esp, 1036		; 0000040cH
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	56		 push	 esi
  00014	8b 75 0c	 mov	 esi, DWORD PTR _szField$[ebp]

; 142  : 	char szBuffer[1024] = {0};

  00017	68 ff 03 00 00	 push	 1023			; 000003ffH
  0001c	8d 85 fd fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp+1]
  00022	6a 00		 push	 0
  00024	50		 push	 eax
  00025	c6 85 fc fb ff
	ff 00		 mov	 BYTE PTR _szBuffer$[ebp], 0
  0002c	e8 00 00 00 00	 call	 _memset

; 143  : 	// ---
; 144  : 	va_list pArguments;
; 145  : 	// ---
; 146  : 	va_start(pArguments,szQuery);
; 147  : 	// ---
; 148  : 	vsprintf(szBuffer,szQuery,pArguments);

  00031	8b 55 10	 mov	 edx, DWORD PTR _szQuery$[ebp]
  00034	8d 4d 14	 lea	 ecx, DWORD PTR _szQuery$[ebp+4]
  00037	51		 push	 ecx
  00038	52		 push	 edx
  00039	8d 85 fc fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp]
  0003f	50		 push	 eax
  00040	e8 00 00 00 00	 call	 _vsprintf
  00045	83 c4 18	 add	 esp, 24			; 00000018H

; 149  : 	// ---
; 150  : 	va_end(pArguments);
; 151  : 	// ---
; 152  : 	PointsSql.Execute(szBuffer, &rsSql, true);

  00048	6a 01		 push	 1
  0004a	68 00 00 00 00	 push	 OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  0004f	8d 8d fc fb ff
	ff		 lea	 ecx, DWORD PTR _szBuffer$[ebp]
  00055	51		 push	 ecx
  00056	b9 00 00 00 00	 mov	 ecx, OFFSET ?PointsSql@@3VCSQL@@A ; PointsSql
  0005b	e8 00 00 00 00	 call	 ?Execute@CSQL@@QAE_NPBDPAVCBoundRecordSet@@_N@Z ; CSQL::Execute

; 153  : 	// ---
; 154  : 	rsSql.Fetch();

  00060	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00065	e8 00 00 00 00	 call	 ?Fetch@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Fetch

; 155  : 	// ---
; 156  : 	float value = rsSql.Values(szField).ToFloat();

  0006a	56		 push	 esi
  0006b	8d 95 f4 fb ff
	ff		 lea	 edx, DWORD PTR $T157368[ebp]
  00071	52		 push	 edx
  00072	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00077	e8 00 00 00 00	 call	 ?Values@CBoundRecordSet@@QAE?AVCSQLValue@@PBD@Z ; CBoundRecordSet::Values
  0007c	8b c8		 mov	 ecx, eax
  0007e	e8 00 00 00 00	 call	 ?ToFloat@CSQLValue@@QAEMXZ ; CSQLValue::ToFloat
  00083	d9 9d f8 fb ff
	ff		 fstp	 DWORD PTR _value$[ebp]

; 157  : 	// ---
; 158  : 	rsSql.Close();

  00089	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  0008e	e8 00 00 00 00	 call	 ?Close@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Close

; 159  : 	// ---
; 160  : 	return value;

  00093	d9 85 f8 fb ff
	ff		 fld	 DWORD PTR _value$[ebp]

; 161  : }

  00099	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0009c	33 cd		 xor	 ecx, ebp
  0009e	5e		 pop	 esi
  0009f	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000a4	8b e5		 mov	 esp, ebp
  000a6	5d		 pop	 ebp
  000a7	c3		 ret	 0
?ReturnFloat@SQLClass@@QAAMPAD0ZZ ENDP			; SQLClass::ReturnFloat
_TEXT	ENDS
PUBLIC	__$ArrayPad$
PUBLIC	?ReturnDouble@SQLClass@@QAANPAD0ZZ		; SQLClass::ReturnDouble
EXTRN	?ToDouble@CSQLValue@@QAENXZ:PROC		; CSQLValue::ToDouble
; Function compile flags: /Ogtp
;	COMDAT ?ReturnDouble@SQLClass@@QAANPAD0ZZ
_TEXT	SEGMENT
$T157374 = -1036					; size = 8
_value$ = -1036						; size = 8
_szBuffer$ = -1028					; size = 1024
__$ArrayPad$ = -4					; size = 4
_this$ = 8						; size = 4
_szField$ = 12						; size = 4
_szQuery$ = 16						; size = 4
?ReturnDouble@SQLClass@@QAANPAD0ZZ PROC			; SQLClass::ReturnDouble, COMDAT

; 164  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 0c 04 00
	00		 sub	 esp, 1036		; 0000040cH
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	56		 push	 esi
  00014	8b 75 0c	 mov	 esi, DWORD PTR _szField$[ebp]

; 165  : 	char szBuffer[1024] = {0};

  00017	68 ff 03 00 00	 push	 1023			; 000003ffH
  0001c	8d 85 fd fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp+1]
  00022	6a 00		 push	 0
  00024	50		 push	 eax
  00025	c6 85 fc fb ff
	ff 00		 mov	 BYTE PTR _szBuffer$[ebp], 0
  0002c	e8 00 00 00 00	 call	 _memset

; 166  : 	// ---
; 167  : 	va_list pArguments;
; 168  : 	// ---
; 169  : 	va_start(pArguments,szQuery);
; 170  : 	// ---
; 171  : 	vsprintf(szBuffer,szQuery,pArguments);

  00031	8b 55 10	 mov	 edx, DWORD PTR _szQuery$[ebp]
  00034	8d 4d 14	 lea	 ecx, DWORD PTR _szQuery$[ebp+4]
  00037	51		 push	 ecx
  00038	52		 push	 edx
  00039	8d 85 fc fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp]
  0003f	50		 push	 eax
  00040	e8 00 00 00 00	 call	 _vsprintf
  00045	83 c4 18	 add	 esp, 24			; 00000018H

; 172  : 	// ---
; 173  : 	va_end(pArguments);
; 174  : 	// ---
; 175  : 	PointsSql.Execute(szBuffer, &rsSql, true);

  00048	6a 01		 push	 1
  0004a	68 00 00 00 00	 push	 OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  0004f	8d 8d fc fb ff
	ff		 lea	 ecx, DWORD PTR _szBuffer$[ebp]
  00055	51		 push	 ecx
  00056	b9 00 00 00 00	 mov	 ecx, OFFSET ?PointsSql@@3VCSQL@@A ; PointsSql
  0005b	e8 00 00 00 00	 call	 ?Execute@CSQL@@QAE_NPBDPAVCBoundRecordSet@@_N@Z ; CSQL::Execute

; 176  : 	// ---
; 177  : 	rsSql.Fetch();

  00060	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00065	e8 00 00 00 00	 call	 ?Fetch@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Fetch

; 178  : 	// ---
; 179  : 	double value = rsSql.Values(szField).ToDouble();

  0006a	56		 push	 esi
  0006b	8d 95 f4 fb ff
	ff		 lea	 edx, DWORD PTR $T157374[ebp]
  00071	52		 push	 edx
  00072	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00077	e8 00 00 00 00	 call	 ?Values@CBoundRecordSet@@QAE?AVCSQLValue@@PBD@Z ; CBoundRecordSet::Values
  0007c	8b c8		 mov	 ecx, eax
  0007e	e8 00 00 00 00	 call	 ?ToDouble@CSQLValue@@QAENXZ ; CSQLValue::ToDouble
  00083	dd 9d f4 fb ff
	ff		 fstp	 QWORD PTR _value$[ebp]

; 180  : 	// ---
; 181  : 	rsSql.Close();

  00089	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  0008e	e8 00 00 00 00	 call	 ?Close@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Close

; 182  : 	// ---
; 183  : 	return value;

  00093	dd 85 f4 fb ff
	ff		 fld	 QWORD PTR _value$[ebp]

; 184  : }

  00099	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  0009c	33 cd		 xor	 ecx, ebp
  0009e	5e		 pop	 esi
  0009f	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000a4	8b e5		 mov	 esp, ebp
  000a6	5d		 pop	 ebp
  000a7	c3		 ret	 0
?ReturnDouble@SQLClass@@QAANPAD0ZZ ENDP			; SQLClass::ReturnDouble
_TEXT	ENDS
PUBLIC	??_C@_0BC@HPBGPDIP@SELECT?5?$CK?5FROM?5?$CFs?$DL?$AA@ ; `string'
PUBLIC	??_C@_0BF@MLPFJLED@SELECT?5?$CK?5FROM?5?$CFs?5?$CFs?$DL?$AA@ ; `string'
PUBLIC	__$ArrayPad$
PUBLIC	?GetCountInt@SQLClass@@QAAHPADPBDZZ		; SQLClass::GetCountInt
EXTRN	__imp__wsprintfA:PROC
;	COMDAT ??_C@_0BC@HPBGPDIP@SELECT?5?$CK?5FROM?5?$CFs?$DL?$AA@
CONST	SEGMENT
??_C@_0BC@HPBGPDIP@SELECT?5?$CK?5FROM?5?$CFs?$DL?$AA@ DB 'SELECT * FROM %'
	DB	's;', 00H					; `string'
CONST	ENDS
;	COMDAT ??_C@_0BF@MLPFJLED@SELECT?5?$CK?5FROM?5?$CFs?5?$CFs?$DL?$AA@
CONST	SEGMENT
??_C@_0BF@MLPFJLED@SELECT?5?$CK?5FROM?5?$CFs?5?$CFs?$DL?$AA@ DB 'SELECT *'
	DB	' FROM %s %s;', 00H				; `string'
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ?GetCountInt@SQLClass@@QAAHPADPBDZZ
_TEXT	SEGMENT
_szQuery$ = -2052					; size = 1024
_szBuffer$ = -1028					; size = 1024
__$ArrayPad$ = -4					; size = 4
_this$ = 8						; size = 4
_Table$ = 12						; size = 4
_Optional$ = 16						; size = 4
?GetCountInt@SQLClass@@QAAHPADPBDZZ PROC		; SQLClass::GetCountInt, COMDAT

; 187  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 04 08 00
	00		 sub	 esp, 2052		; 00000804H
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	56		 push	 esi
  00014	8b 75 0c	 mov	 esi, DWORD PTR _Table$[ebp]

; 188  : 	char szBuffer[1024] = {0};

  00017	68 ff 03 00 00	 push	 1023			; 000003ffH
  0001c	8d 85 fd fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp+1]
  00022	6a 00		 push	 0
  00024	50		 push	 eax
  00025	c6 85 fc fb ff
	ff 00		 mov	 BYTE PTR _szBuffer$[ebp], 0
  0002c	e8 00 00 00 00	 call	 _memset

; 189  : 	char szQuery[1024] = {0};

  00031	68 ff 03 00 00	 push	 1023			; 000003ffH
  00036	8d 8d fd f7 ff
	ff		 lea	 ecx, DWORD PTR _szQuery$[ebp+1]
  0003c	6a 00		 push	 0
  0003e	51		 push	 ecx
  0003f	c6 85 fc f7 ff
	ff 00		 mov	 BYTE PTR _szQuery$[ebp], 0
  00046	e8 00 00 00 00	 call	 _memset

; 190  : 	// ---
; 191  : 	va_list pArguments;
; 192  : 	// ---
; 193  :     va_start(pArguments, Optional);
; 194  : 	// ---
; 195  :     vsprintf(szBuffer, Optional, pArguments);

  0004b	8b 45 10	 mov	 eax, DWORD PTR _Optional$[ebp]
  0004e	8d 55 14	 lea	 edx, DWORD PTR _Optional$[ebp+4]
  00051	52		 push	 edx
  00052	50		 push	 eax
  00053	8d 8d fc fb ff
	ff		 lea	 ecx, DWORD PTR _szBuffer$[ebp]
  00059	51		 push	 ecx
  0005a	e8 00 00 00 00	 call	 _vsprintf
  0005f	83 c4 24	 add	 esp, 36			; 00000024H

; 196  : 	// ---
; 197  :     va_end(pArguments);
; 198  : 	// ---
; 199  :     if (Optional)

  00062	83 7d 10 00	 cmp	 DWORD PTR _Optional$[ebp], 0
  00066	74 1f		 je	 SHORT $LN2@GetCountIn

; 200  : 	{
; 201  : 		wsprintfA(szQuery, "SELECT * FROM %s %s;", Table, szBuffer);

  00068	8d 95 fc fb ff
	ff		 lea	 edx, DWORD PTR _szBuffer$[ebp]
  0006e	52		 push	 edx
  0006f	56		 push	 esi
  00070	8d 85 fc f7 ff
	ff		 lea	 eax, DWORD PTR _szQuery$[ebp]
  00076	68 00 00 00 00	 push	 OFFSET ??_C@_0BF@MLPFJLED@SELECT?5?$CK?5FROM?5?$CFs?5?$CFs?$DL?$AA@
  0007b	50		 push	 eax
  0007c	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__wsprintfA
  00082	83 c4 10	 add	 esp, 16			; 00000010H

; 202  : 	}
; 203  :     else

  00085	eb 16		 jmp	 SHORT $LN1@GetCountIn
$LN2@GetCountIn:

; 204  : 	{
; 205  : 		wsprintfA(szQuery, "SELECT * FROM %s;", Table);

  00087	56		 push	 esi
  00088	8d 8d fc f7 ff
	ff		 lea	 ecx, DWORD PTR _szQuery$[ebp]
  0008e	68 00 00 00 00	 push	 OFFSET ??_C@_0BC@HPBGPDIP@SELECT?5?$CK?5FROM?5?$CFs?$DL?$AA@
  00093	51		 push	 ecx
  00094	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__wsprintfA
  0009a	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN1@GetCountIn:

; 206  : 	}
; 207  : 	// ---
; 208  : 	int count = rsSql.RowCount;

  0009d	8b 35 10 00 00
	00		 mov	 esi, DWORD PTR ?rsSql@@3VCBoundRecordSet@@A+16

; 209  : 	// ---
; 210  : 	rsSql.Close();

  000a3	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  000a8	e8 00 00 00 00	 call	 ?Close@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Close

; 211  : 	// ---
; 212  : 	ZeroMemory(szQuery, sizeof(szQuery));
; 213  : 	// ---
; 214  : 	return count;
; 215  : }

  000ad	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  000b0	8b c6		 mov	 eax, esi
  000b2	33 cd		 xor	 ecx, ebp
  000b4	5e		 pop	 esi
  000b5	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000ba	8b e5		 mov	 esp, ebp
  000bc	5d		 pop	 ebp
  000bd	c3		 ret	 0
?GetCountInt@SQLClass@@QAAHPADPBDZZ ENDP		; SQLClass::GetCountInt
_TEXT	ENDS
PUBLIC	?UpdateReset@SQLClass@@QAEXH@Z			; SQLClass::UpdateReset
EXTRN	?gObj@@3PAUOBJECTSTRUCT@@A:BYTE			; gObj
; Function compile flags: /Ogtp
;	COMDAT ?UpdateReset@SQLClass@@QAEXH@Z
_TEXT	SEGMENT
_aIndex$ = 8						; size = 4
?UpdateReset@SQLClass@@QAEXH@Z PROC			; SQLClass::UpdateReset, COMDAT
; _this$ = ecx

; 218  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	53		 push	 ebx

; 219  : 	this->Execute(this->m_Data.Query_Update_Reset, 
; 220  : 		this->m_Data.Coluna_Reset, 
; 221  : 		this->m_Data.Coluna_Reset, 
; 222  : 		this->m_Data.Coluna_ResetDay, 
; 223  : 		this->m_Data.Coluna_ResetDay, 
; 224  : 		this->m_Data.Coluna_ResetWeek, 
; 225  : 		this->m_Data.Coluna_ResetWeek, 
; 226  : 		this->m_Data.Coluna_ResetMonth, 
; 227  : 		this->m_Data.Coluna_ResetMonth, gObj[aIndex].Name);

  00004	8b 5d 08	 mov	 ebx, DWORD PTR _aIndex$[ebp]
  00007	56		 push	 esi
  00008	69 db 64 15 00
	00		 imul	 ebx, 5476		; 00001564H
  0000e	57		 push	 edi
  0000f	8d 81 00 07 00
	00		 lea	 eax, DWORD PTR [ecx+1792]
  00015	81 c3 6f 00 00
	00		 add	 ebx, OFFSET ?gObj@@3PAUOBJECTSTRUCT@@A+111
  0001b	53		 push	 ebx
  0001c	50		 push	 eax
  0001d	50		 push	 eax
  0001e	8d 91 00 06 00
	00		 lea	 edx, DWORD PTR [ecx+1536]
  00024	52		 push	 edx
  00025	52		 push	 edx
  00026	8d b1 00 05 00
	00		 lea	 esi, DWORD PTR [ecx+1280]
  0002c	56		 push	 esi
  0002d	56		 push	 esi
  0002e	8d b9 00 04 00
	00		 lea	 edi, DWORD PTR [ecx+1024]
  00034	57		 push	 edi
  00035	57		 push	 edi
  00036	8d 81 00 13 00
	00		 lea	 eax, DWORD PTR [ecx+4864]
  0003c	50		 push	 eax
  0003d	51		 push	 ecx
  0003e	e8 00 00 00 00	 call	 ?Execute@SQLClass@@QAAXPADZZ ; SQLClass::Execute
  00043	83 c4 2c	 add	 esp, 44			; 0000002cH
  00046	5f		 pop	 edi
  00047	5e		 pop	 esi
  00048	5b		 pop	 ebx

; 228  : }

  00049	5d		 pop	 ebp
  0004a	c2 04 00	 ret	 4
?UpdateReset@SQLClass@@QAEXH@Z ENDP			; SQLClass::UpdateReset
_TEXT	ENDS
PUBLIC	?UpdateMasterReset@SQLClass@@QAEXH@Z		; SQLClass::UpdateMasterReset
; Function compile flags: /Ogtp
;	COMDAT ?UpdateMasterReset@SQLClass@@QAEXH@Z
_TEXT	SEGMENT
_aIndex$ = 8						; size = 4
?UpdateMasterReset@SQLClass@@QAEXH@Z PROC		; SQLClass::UpdateMasterReset, COMDAT
; _this$ = ecx

; 231  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	53		 push	 ebx

; 232  : 	this->Execute(this->m_Data.Query_Update_MasterReset, 
; 233  : 		this->m_Data.Coluna_MasterReset, 
; 234  : 		this->m_Data.Coluna_MasterReset, 
; 235  : 		this->m_Data.Coluna_MasterResetDay, 
; 236  : 		this->m_Data.Coluna_MasterResetDay, 
; 237  : 		this->m_Data.Coluna_MasterResetWeek, 
; 238  : 		this->m_Data.Coluna_MasterResetWeek, 
; 239  : 		this->m_Data.Coluna_MasterResetMonth, 
; 240  : 		this->m_Data.Coluna_MasterResetMonth, gObj[aIndex].Name);

  00004	8b 5d 08	 mov	 ebx, DWORD PTR _aIndex$[ebp]
  00007	56		 push	 esi
  00008	69 db 64 15 00
	00		 imul	 ebx, 5476		; 00001564H
  0000e	57		 push	 edi
  0000f	8d 81 00 0b 00
	00		 lea	 eax, DWORD PTR [ecx+2816]
  00015	81 c3 6f 00 00
	00		 add	 ebx, OFFSET ?gObj@@3PAUOBJECTSTRUCT@@A+111
  0001b	53		 push	 ebx
  0001c	50		 push	 eax
  0001d	50		 push	 eax
  0001e	8d 91 00 0a 00
	00		 lea	 edx, DWORD PTR [ecx+2560]
  00024	52		 push	 edx
  00025	52		 push	 edx
  00026	8d b1 00 09 00
	00		 lea	 esi, DWORD PTR [ecx+2304]
  0002c	56		 push	 esi
  0002d	56		 push	 esi
  0002e	8d b9 00 08 00
	00		 lea	 edi, DWORD PTR [ecx+2048]
  00034	57		 push	 edi
  00035	57		 push	 edi
  00036	8d 81 00 15 00
	00		 lea	 eax, DWORD PTR [ecx+5376]
  0003c	50		 push	 eax
  0003d	51		 push	 ecx
  0003e	e8 00 00 00 00	 call	 ?Execute@SQLClass@@QAAXPADZZ ; SQLClass::Execute
  00043	83 c4 2c	 add	 esp, 44			; 0000002cH
  00046	5f		 pop	 edi
  00047	5e		 pop	 esi
  00048	5b		 pop	 ebx

; 241  : }

  00049	5d		 pop	 ebp
  0004a	c2 04 00	 ret	 4
?UpdateMasterReset@SQLClass@@QAEXH@Z ENDP		; SQLClass::UpdateMasterReset
_TEXT	ENDS
PUBLIC	??$strcpy_s@$0PP@@@YAHAAY0PP@DPBD@Z		; strcpy_s<255>
EXTRN	_strcpy_s:PROC
; Function compile flags: /Ogtp
; File c:\program files (x86)\microsoft visual studio 10.0\vc\include\string.h
;	COMDAT ??$strcpy_s@$0PP@@@YAHAAY0PP@DPBD@Z
_TEXT	SEGMENT
__Dest$ = 8						; size = 4
__Source$ = 12						; size = 4
??$strcpy_s@$0PP@@@YAHAAY0PP@DPBD@Z PROC		; strcpy_s<255>, COMDAT

; 104  : __DEFINE_CPP_OVERLOAD_SECURE_FUNC_0_1(errno_t, strcpy_s, _Deref_post_z_ char, _Dest, _In_z_ const char *, _Source)

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	8b 45 0c	 mov	 eax, DWORD PTR __Source$[ebp]
  00006	8b 4d 08	 mov	 ecx, DWORD PTR __Dest$[ebp]
  00009	50		 push	 eax
  0000a	68 ff 00 00 00	 push	 255			; 000000ffH
  0000f	51		 push	 ecx
  00010	e8 00 00 00 00	 call	 _strcpy_s
  00015	83 c4 0c	 add	 esp, 12			; 0000000cH
  00018	5d		 pop	 ebp
  00019	c3		 ret	 0
??$strcpy_s@$0PP@@@YAHAAY0PP@DPBD@Z ENDP		; strcpy_s<255>
_TEXT	ENDS
PUBLIC	??$strcpy_s@$0EAA@@@YAHAAY0EAA@DPBD@Z		; strcpy_s<1024>
; Function compile flags: /Ogtp
;	COMDAT ??$strcpy_s@$0EAA@@@YAHAAY0EAA@DPBD@Z
_TEXT	SEGMENT
__Dest$ = 8						; size = 4
__Source$ = 12						; size = 4
??$strcpy_s@$0EAA@@@YAHAAY0EAA@DPBD@Z PROC		; strcpy_s<1024>, COMDAT

; 104  : __DEFINE_CPP_OVERLOAD_SECURE_FUNC_0_1(errno_t, strcpy_s, _Deref_post_z_ char, _Dest, _In_z_ const char *, _Source)

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	8b 45 0c	 mov	 eax, DWORD PTR __Source$[ebp]
  00006	8b 4d 08	 mov	 ecx, DWORD PTR __Dest$[ebp]
  00009	50		 push	 eax
  0000a	68 00 04 00 00	 push	 1024			; 00000400H
  0000f	51		 push	 ecx
  00010	e8 00 00 00 00	 call	 _strcpy_s
  00015	83 c4 0c	 add	 esp, 12			; 0000000cH
  00018	5d		 pop	 ebp
  00019	c3		 ret	 0
??$strcpy_s@$0EAA@@@YAHAAY0EAA@DPBD@Z ENDP		; strcpy_s<1024>
_TEXT	ENDS
PUBLIC	??_C@_0CG@GENGKJHJ@?$FLSQL?5Server?$FN?5Connect?5to?5DataBase@ ; `string'
PUBLIC	??_C@_0EP@LGBMOHAH@Conex?co?5com?5SQL?5Server?5Falhou?5?$CB?6@ ; `string'
PUBLIC	??_C@_0CB@GGMKHPNP@Erro?5na?5conex?co?5com?5SQL?5Server?5?$CB@ ; `string'
PUBLIC	??_C@_0BC@FGHLJAGI@Query_Update_Cash?$AA@	; `string'
PUBLIC	??_C@_0P@MHACNCCN@Query_Get_Cash?$AA@		; `string'
PUBLIC	??_C@_0BC@PIOLOKNK@Query_Update_Gold?$AA@	; `string'
PUBLIC	??_C@_0P@GJJCKIJP@Query_Get_Gold?$AA@		; `string'
PUBLIC	??_C@_0BJ@OJDDHDEN@Query_Update_MasterReset?$AA@ ; `string'
PUBLIC	??_C@_0BG@EMKOIGIL@Query_Get_MasterReset?$AA@	; `string'
PUBLIC	??_C@_0BD@DNLOMKKF@Query_Update_Reset?$AA@	; `string'
PUBLIC	??_C@_0BA@DLJJAGPI@Query_Get_Reset?$AA@		; `string'
PUBLIC	??_C@_0BJ@JGAMFJGJ@Collumn_MasterResetMonth?$AA@ ; `string'
PUBLIC	??_C@_0BI@MCHKIABI@Collumn_MasterResetWeek?$AA@	; `string'
PUBLIC	??_C@_0BH@NEMNAKJM@Collumn_MasterResetDay?$AA@	; `string'
PUBLIC	??_C@_0BE@CNBOLNKH@Collumn_MasterReset?$AA@	; `string'
PUBLIC	??_C@_0BD@MFBKIPOE@Collumn_ResetMonth?$AA@	; `string'
PUBLIC	??_C@_0BC@GHDPDNOK@Collumn_ResetWeek?$AA@	; `string'
PUBLIC	??_C@_0BB@JLMFJDLL@Collumn_ResetDay?$AA@	; `string'
PUBLIC	??_C@_0O@IMGIJGHN@Collumn_Reset?$AA@		; `string'
PUBLIC	??_C@_0N@ILMOGMFD@Collumn_Cash?$AA@		; `string'
PUBLIC	??_C@_0N@CFFOBGOB@Collumn_Gold?$AA@		; `string'
PUBLIC	??_C@_04MLLLIHIP@null?$AA@			; `string'
PUBLIC	??_C@_08FJIAHGMM@Password?$AA@			; `string'
PUBLIC	??_C@_05DJDHLJAH@12345?$AA@			; `string'
PUBLIC	??_C@_04ODLBFFJE@User?$AA@			; `string'
PUBLIC	??_C@_02CKOPKKAC@sa?$AA@			; `string'
PUBLIC	??_C@_08HDBDMMBI@Database?$AA@			; `string'
PUBLIC	??_C@_08BCAJKAEC@MuOnline?$AA@			; `string'
PUBLIC	??_C@_03DGLBMECB@SQL?$AA@			; `string'
PUBLIC	??_C@_02MFEOMNPG@IP?$AA@			; `string'
PUBLIC	??_C@_09PFCHIMEP@127?40?40?41?$AA@		; `string'
PUBLIC	??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@ ; `string'
PUBLIC	??_C@_0N@KKFHAHLJ@?$HLSQL?5Server?$HN?$AA@	; `string'
PUBLIC	?Load@SQLClass@@QAEXXZ				; SQLClass::Load
EXTRN	?LogAdd@@YAXW4eLogColor@@PADZZ:PROC		; LogAdd
EXTRN	__imp__ExitProcess@4:PROC
EXTRN	__imp__MessageBoxA@16:PROC
EXTRN	?Connect@CSQL@@QAE_NPAU_TAG_SQLCONNECTION@@@Z:PROC ; CSQL::Connect
EXTRN	__imp__GetPrivateProfileStringA@24:PROC
;	COMDAT ??_C@_0CG@GENGKJHJ@?$FLSQL?5Server?$FN?5Connect?5to?5DataBase@
CONST	SEGMENT
??_C@_0CG@GENGKJHJ@?$FLSQL?5Server?$FN?5Connect?5to?5DataBase@ DB '[SQL S'
	DB	'erver] Connect to DataBase (%s)', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0EP@LGBMOHAH@Conex?co?5com?5SQL?5Server?5Falhou?5?$CB?6@
CONST	SEGMENT
??_C@_0EP@LGBMOHAH@Conex?co?5com?5SQL?5Server?5Falhou?5?$CB?6@ DB 'Conex', 0e3H
	DB	'o com SQL Server Falhou !', 0aH, 'Favor Verificar o arquivo '''
	DB	'Hgt_SQLConnect.ini''', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0CB@GGMKHPNP@Erro?5na?5conex?co?5com?5SQL?5Server?5?$CB@
CONST	SEGMENT
??_C@_0CB@GGMKHPNP@Erro?5na?5conex?co?5com?5SQL?5Server?5?$CB@ DB 'Erro n'
	DB	'a conex', 0e3H, 'o com SQL Server !', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0BC@FGHLJAGI@Query_Update_Cash?$AA@
CONST	SEGMENT
??_C@_0BC@FGHLJAGI@Query_Update_Cash?$AA@ DB 'Query_Update_Cash', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0P@MHACNCCN@Query_Get_Cash?$AA@
CONST	SEGMENT
??_C@_0P@MHACNCCN@Query_Get_Cash?$AA@ DB 'Query_Get_Cash', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BC@PIOLOKNK@Query_Update_Gold?$AA@
CONST	SEGMENT
??_C@_0BC@PIOLOKNK@Query_Update_Gold?$AA@ DB 'Query_Update_Gold', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0P@GJJCKIJP@Query_Get_Gold?$AA@
CONST	SEGMENT
??_C@_0P@GJJCKIJP@Query_Get_Gold?$AA@ DB 'Query_Get_Gold', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BJ@OJDDHDEN@Query_Update_MasterReset?$AA@
CONST	SEGMENT
??_C@_0BJ@OJDDHDEN@Query_Update_MasterReset?$AA@ DB 'Query_Update_MasterR'
	DB	'eset', 00H					; `string'
CONST	ENDS
;	COMDAT ??_C@_0BG@EMKOIGIL@Query_Get_MasterReset?$AA@
CONST	SEGMENT
??_C@_0BG@EMKOIGIL@Query_Get_MasterReset?$AA@ DB 'Query_Get_MasterReset', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BD@DNLOMKKF@Query_Update_Reset?$AA@
CONST	SEGMENT
??_C@_0BD@DNLOMKKF@Query_Update_Reset?$AA@ DB 'Query_Update_Reset', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BA@DLJJAGPI@Query_Get_Reset?$AA@
CONST	SEGMENT
??_C@_0BA@DLJJAGPI@Query_Get_Reset?$AA@ DB 'Query_Get_Reset', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BJ@JGAMFJGJ@Collumn_MasterResetMonth?$AA@
CONST	SEGMENT
??_C@_0BJ@JGAMFJGJ@Collumn_MasterResetMonth?$AA@ DB 'Collumn_MasterResetM'
	DB	'onth', 00H					; `string'
CONST	ENDS
;	COMDAT ??_C@_0BI@MCHKIABI@Collumn_MasterResetWeek?$AA@
CONST	SEGMENT
??_C@_0BI@MCHKIABI@Collumn_MasterResetWeek?$AA@ DB 'Collumn_MasterResetWe'
	DB	'ek', 00H					; `string'
CONST	ENDS
;	COMDAT ??_C@_0BH@NEMNAKJM@Collumn_MasterResetDay?$AA@
CONST	SEGMENT
??_C@_0BH@NEMNAKJM@Collumn_MasterResetDay?$AA@ DB 'Collumn_MasterResetDay'
	DB	00H						; `string'
CONST	ENDS
;	COMDAT ??_C@_0BE@CNBOLNKH@Collumn_MasterReset?$AA@
CONST	SEGMENT
??_C@_0BE@CNBOLNKH@Collumn_MasterReset?$AA@ DB 'Collumn_MasterReset', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BD@MFBKIPOE@Collumn_ResetMonth?$AA@
CONST	SEGMENT
??_C@_0BD@MFBKIPOE@Collumn_ResetMonth?$AA@ DB 'Collumn_ResetMonth', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BC@GHDPDNOK@Collumn_ResetWeek?$AA@
CONST	SEGMENT
??_C@_0BC@GHDPDNOK@Collumn_ResetWeek?$AA@ DB 'Collumn_ResetWeek', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0BB@JLMFJDLL@Collumn_ResetDay?$AA@
CONST	SEGMENT
??_C@_0BB@JLMFJDLL@Collumn_ResetDay?$AA@ DB 'Collumn_ResetDay', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0O@IMGIJGHN@Collumn_Reset?$AA@
CONST	SEGMENT
??_C@_0O@IMGIJGHN@Collumn_Reset?$AA@ DB 'Collumn_Reset', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@ILMOGMFD@Collumn_Cash?$AA@
CONST	SEGMENT
??_C@_0N@ILMOGMFD@Collumn_Cash?$AA@ DB 'Collumn_Cash', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@CFFOBGOB@Collumn_Gold?$AA@
CONST	SEGMENT
??_C@_0N@CFFOBGOB@Collumn_Gold?$AA@ DB 'Collumn_Gold', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_04MLLLIHIP@null?$AA@
CONST	SEGMENT
??_C@_04MLLLIHIP@null?$AA@ DB 'null', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_08FJIAHGMM@Password?$AA@
CONST	SEGMENT
??_C@_08FJIAHGMM@Password?$AA@ DB 'Password', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_05DJDHLJAH@12345?$AA@
CONST	SEGMENT
??_C@_05DJDHLJAH@12345?$AA@ DB '12345', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_04ODLBFFJE@User?$AA@
CONST	SEGMENT
??_C@_04ODLBFFJE@User?$AA@ DB 'User', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_02CKOPKKAC@sa?$AA@
CONST	SEGMENT
??_C@_02CKOPKKAC@sa?$AA@ DB 'sa', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_08HDBDMMBI@Database?$AA@
CONST	SEGMENT
??_C@_08HDBDMMBI@Database?$AA@ DB 'Database', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_08BCAJKAEC@MuOnline?$AA@
CONST	SEGMENT
??_C@_08BCAJKAEC@MuOnline?$AA@ DB 'MuOnline', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_03DGLBMECB@SQL?$AA@
CONST	SEGMENT
??_C@_03DGLBMECB@SQL?$AA@ DB 'SQL', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_02MFEOMNPG@IP?$AA@
CONST	SEGMENT
??_C@_02MFEOMNPG@IP?$AA@ DB 'IP', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_09PFCHIMEP@127?40?40?41?$AA@
CONST	SEGMENT
??_C@_09PFCHIMEP@127?40?40?41?$AA@ DB '127.0.0.1', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
CONST	SEGMENT
??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@ DB '.\Customs\SQL'
	DB	'Server\Hgt_SQLConnect.ini', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@KKFHAHLJ@?$HLSQL?5Server?$HN?$AA@
CONST	SEGMENT
??_C@_0N@KKFHAHLJ@?$HLSQL?5Server?$HN?$AA@ DB '{SQL Server}', 00H ; `string'
; Function compile flags: /Ogtp
; File c:\users\faelhs\mu-1.1\emu - gameserver sapphire s0\gameserver\sqlmanager.cpp
CONST	ENDS
;	COMDAT ?Load@SQLClass@@QAEXXZ
_TEXT	SEGMENT
?Load@SQLClass@@QAEXXZ PROC				; SQLClass::Load, COMDAT
; _this$ = ecx

; 11   : {

  00000	56		 push	 esi
  00001	57		 push	 edi

; 12   : 	strcpy_s(m_SqlConn.sDriver,"{SQL Server}");

  00002	68 00 00 00 00	 push	 OFFSET ??_C@_0N@KKFHAHLJ@?$HLSQL?5Server?$HN?$AA@
  00007	68 ff 00 00 00	 push	 255			; 000000ffH
  0000c	68 ff 00 00 00	 push	 OFFSET ?m_SqlConn@@3U_TAG_SQLCONNECTION@@A+255
  00011	8b f9		 mov	 edi, ecx
  00013	e8 00 00 00 00	 call	 _strcpy_s

; 13   : 	// ---
; 14   : 	GetPrivateProfileString("SQL", "IP", "127.0.0.1", m_SqlConn.sServer, sizeof(m_SqlConn.sServer), SQL_FILE);

  00018	8b 35 00 00 00
	00		 mov	 esi, DWORD PTR __imp__GetPrivateProfileStringA@24
  0001e	83 c4 0c	 add	 esp, 12			; 0000000cH
  00021	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  00026	68 ff 00 00 00	 push	 255			; 000000ffH
  0002b	68 fe 01 00 00	 push	 OFFSET ?m_SqlConn@@3U_TAG_SQLCONNECTION@@A+510
  00030	68 00 00 00 00	 push	 OFFSET ??_C@_09PFCHIMEP@127?40?40?41?$AA@
  00035	68 00 00 00 00	 push	 OFFSET ??_C@_02MFEOMNPG@IP?$AA@
  0003a	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  0003f	ff d6		 call	 esi

; 15   : 	GetPrivateProfileString("SQL", "Database", "MuOnline", m_SqlConn.sDatabase, sizeof(m_SqlConn.sDatabase), SQL_FILE);

  00041	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  00046	68 ff 00 00 00	 push	 255			; 000000ffH
  0004b	68 fd 02 00 00	 push	 OFFSET ?m_SqlConn@@3U_TAG_SQLCONNECTION@@A+765
  00050	68 00 00 00 00	 push	 OFFSET ??_C@_08BCAJKAEC@MuOnline?$AA@
  00055	68 00 00 00 00	 push	 OFFSET ??_C@_08HDBDMMBI@Database?$AA@
  0005a	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  0005f	ff d6		 call	 esi

; 16   : 	GetPrivateProfileString("SQL", "User", "sa", m_SqlConn.sUID, sizeof(m_SqlConn.sUID), SQL_FILE);

  00061	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  00066	68 ff 00 00 00	 push	 255			; 000000ffH
  0006b	68 fc 03 00 00	 push	 OFFSET ?m_SqlConn@@3U_TAG_SQLCONNECTION@@A+1020
  00070	68 00 00 00 00	 push	 OFFSET ??_C@_02CKOPKKAC@sa?$AA@
  00075	68 00 00 00 00	 push	 OFFSET ??_C@_04ODLBFFJE@User?$AA@
  0007a	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  0007f	ff d6		 call	 esi

; 17   : 	GetPrivateProfileString("SQL", "Password", "12345", m_SqlConn.sPwd, sizeof(m_SqlConn.sPwd), SQL_FILE);

  00081	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  00086	68 ff 00 00 00	 push	 255			; 000000ffH
  0008b	68 fb 04 00 00	 push	 OFFSET ?m_SqlConn@@3U_TAG_SQLCONNECTION@@A+1275
  00090	68 00 00 00 00	 push	 OFFSET ??_C@_05DJDHLJAH@12345?$AA@
  00095	68 00 00 00 00	 push	 OFFSET ??_C@_08FJIAHGMM@Password?$AA@
  0009a	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  0009f	ff d6		 call	 esi

; 18   : 	// ---
; 19   : 	GetPrivateProfileString("SQL", "Collumn_Gold", "null", this->m_Data.Coluna_Gold, sizeof(this->m_Data.Coluna_Gold), SQL_FILE);

  000a1	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  000a6	68 00 01 00 00	 push	 256			; 00000100H
  000ab	8d 87 00 02 00
	00		 lea	 eax, DWORD PTR [edi+512]
  000b1	50		 push	 eax
  000b2	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  000b7	68 00 00 00 00	 push	 OFFSET ??_C@_0N@CFFOBGOB@Collumn_Gold?$AA@
  000bc	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  000c1	ff d6		 call	 esi

; 20   : 	GetPrivateProfileString("SQL", "Collumn_Cash", "null", this->m_Data.Coluna_Cash, sizeof(this->m_Data.Coluna_Cash), SQL_FILE);

  000c3	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  000c8	68 00 01 00 00	 push	 256			; 00000100H
  000cd	8d 8f 00 03 00
	00		 lea	 ecx, DWORD PTR [edi+768]
  000d3	51		 push	 ecx
  000d4	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  000d9	68 00 00 00 00	 push	 OFFSET ??_C@_0N@ILMOGMFD@Collumn_Cash?$AA@
  000de	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  000e3	ff d6		 call	 esi

; 21   : 	// ---
; 22   : 	GetPrivateProfileString("SQL", "Collumn_Reset", "null", this->m_Data.Coluna_Reset, sizeof(this->m_Data.Coluna_Reset), SQL_FILE);

  000e5	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  000ea	68 00 01 00 00	 push	 256			; 00000100H
  000ef	8d 97 00 04 00
	00		 lea	 edx, DWORD PTR [edi+1024]
  000f5	52		 push	 edx
  000f6	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  000fb	68 00 00 00 00	 push	 OFFSET ??_C@_0O@IMGIJGHN@Collumn_Reset?$AA@
  00100	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  00105	ff d6		 call	 esi

; 23   : 	GetPrivateProfileString("SQL", "Collumn_ResetDay", "null", this->m_Data.Coluna_ResetDay, sizeof(this->m_Data.Coluna_ResetDay), SQL_FILE);

  00107	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  0010c	68 00 01 00 00	 push	 256			; 00000100H
  00111	8d 87 00 05 00
	00		 lea	 eax, DWORD PTR [edi+1280]
  00117	50		 push	 eax
  00118	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  0011d	68 00 00 00 00	 push	 OFFSET ??_C@_0BB@JLMFJDLL@Collumn_ResetDay?$AA@
  00122	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  00127	ff d6		 call	 esi

; 24   : 	GetPrivateProfileString("SQL", "Collumn_ResetWeek", "null", this->m_Data.Coluna_ResetWeek, sizeof(this->m_Data.Coluna_ResetWeek), SQL_FILE);

  00129	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  0012e	68 00 01 00 00	 push	 256			; 00000100H
  00133	8d 8f 00 06 00
	00		 lea	 ecx, DWORD PTR [edi+1536]
  00139	51		 push	 ecx
  0013a	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  0013f	68 00 00 00 00	 push	 OFFSET ??_C@_0BC@GHDPDNOK@Collumn_ResetWeek?$AA@
  00144	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  00149	ff d6		 call	 esi

; 25   : 	GetPrivateProfileString("SQL", "Collumn_ResetMonth", "null", this->m_Data.Coluna_ResetMonth, sizeof(this->m_Data.Coluna_ResetMonth), SQL_FILE);

  0014b	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  00150	68 00 01 00 00	 push	 256			; 00000100H
  00155	8d 97 00 07 00
	00		 lea	 edx, DWORD PTR [edi+1792]
  0015b	52		 push	 edx
  0015c	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  00161	68 00 00 00 00	 push	 OFFSET ??_C@_0BD@MFBKIPOE@Collumn_ResetMonth?$AA@
  00166	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  0016b	ff d6		 call	 esi

; 26   : 	// ---
; 27   : 	GetPrivateProfileString("SQL", "Collumn_MasterReset", "null", this->m_Data.Coluna_MasterReset, sizeof(this->m_Data.Coluna_MasterReset), SQL_FILE);

  0016d	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  00172	68 00 01 00 00	 push	 256			; 00000100H
  00177	8d 87 00 08 00
	00		 lea	 eax, DWORD PTR [edi+2048]
  0017d	50		 push	 eax
  0017e	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  00183	68 00 00 00 00	 push	 OFFSET ??_C@_0BE@CNBOLNKH@Collumn_MasterReset?$AA@
  00188	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  0018d	ff d6		 call	 esi

; 28   : 	GetPrivateProfileString("SQL", "Collumn_MasterResetDay", "null", this->m_Data.Coluna_MasterResetDay, sizeof(this->m_Data.Coluna_MasterResetDay), SQL_FILE);

  0018f	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  00194	68 00 01 00 00	 push	 256			; 00000100H
  00199	8d 8f 00 09 00
	00		 lea	 ecx, DWORD PTR [edi+2304]
  0019f	51		 push	 ecx
  001a0	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  001a5	68 00 00 00 00	 push	 OFFSET ??_C@_0BH@NEMNAKJM@Collumn_MasterResetDay?$AA@
  001aa	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  001af	ff d6		 call	 esi

; 29   : 	GetPrivateProfileString("SQL", "Collumn_MasterResetWeek", "null", this->m_Data.Coluna_MasterResetWeek, sizeof(this->m_Data.Coluna_MasterResetWeek), SQL_FILE);

  001b1	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  001b6	68 00 01 00 00	 push	 256			; 00000100H
  001bb	8d 97 00 0a 00
	00		 lea	 edx, DWORD PTR [edi+2560]
  001c1	52		 push	 edx
  001c2	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  001c7	68 00 00 00 00	 push	 OFFSET ??_C@_0BI@MCHKIABI@Collumn_MasterResetWeek?$AA@
  001cc	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  001d1	ff d6		 call	 esi

; 30   : 	GetPrivateProfileString("SQL", "Collumn_MasterResetMonth", "null", this->m_Data.Coluna_MasterResetMonth, sizeof(this->m_Data.Coluna_MasterResetMonth), SQL_FILE);

  001d3	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  001d8	68 00 01 00 00	 push	 256			; 00000100H
  001dd	8d 87 00 0b 00
	00		 lea	 eax, DWORD PTR [edi+2816]
  001e3	50		 push	 eax
  001e4	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  001e9	68 00 00 00 00	 push	 OFFSET ??_C@_0BJ@JGAMFJGJ@Collumn_MasterResetMonth?$AA@
  001ee	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  001f3	ff d6		 call	 esi

; 31   : 	// ---
; 32   : 	GetPrivateProfileString("SQL", "Query_Get_Reset", "null", this->m_Data.Query_Get_Reset, sizeof(this->m_Data.Query_Get_Reset), SQL_FILE);

  001f5	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  001fa	68 00 01 00 00	 push	 256			; 00000100H
  001ff	8d 8f 00 12 00
	00		 lea	 ecx, DWORD PTR [edi+4608]
  00205	51		 push	 ecx
  00206	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  0020b	68 00 00 00 00	 push	 OFFSET ??_C@_0BA@DLJJAGPI@Query_Get_Reset?$AA@
  00210	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  00215	ff d6		 call	 esi

; 33   : 	GetPrivateProfileString("SQL", "Query_Update_Reset", "null", this->m_Data.Query_Update_Reset, sizeof(this->m_Data.Query_Update_Reset), SQL_FILE);

  00217	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  0021c	68 00 01 00 00	 push	 256			; 00000100H
  00221	8d 97 00 13 00
	00		 lea	 edx, DWORD PTR [edi+4864]
  00227	52		 push	 edx
  00228	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  0022d	68 00 00 00 00	 push	 OFFSET ??_C@_0BD@DNLOMKKF@Query_Update_Reset?$AA@
  00232	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  00237	ff d6		 call	 esi

; 34   : 	GetPrivateProfileString("SQL", "Query_Get_MasterReset", "null", this->m_Data.Query_Get_MasterReset, sizeof(this->m_Data.Query_Get_MasterReset), SQL_FILE);

  00239	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  0023e	68 00 01 00 00	 push	 256			; 00000100H
  00243	8d 87 00 14 00
	00		 lea	 eax, DWORD PTR [edi+5120]
  00249	50		 push	 eax
  0024a	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  0024f	68 00 00 00 00	 push	 OFFSET ??_C@_0BG@EMKOIGIL@Query_Get_MasterReset?$AA@
  00254	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  00259	ff d6		 call	 esi

; 35   : 	GetPrivateProfileString("SQL", "Query_Update_MasterReset", "null", this->m_Data.Query_Update_MasterReset, sizeof(this->m_Data.Query_Update_MasterReset), SQL_FILE);

  0025b	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  00260	68 00 01 00 00	 push	 256			; 00000100H
  00265	8d 8f 00 15 00
	00		 lea	 ecx, DWORD PTR [edi+5376]
  0026b	51		 push	 ecx
  0026c	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  00271	68 00 00 00 00	 push	 OFFSET ??_C@_0BJ@OJDDHDEN@Query_Update_MasterReset?$AA@
  00276	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  0027b	ff d6		 call	 esi

; 36   : 	GetPrivateProfileString("SQL", "Query_Get_Gold", "null", this->m_Data.Query_Get_Gold, sizeof(this->m_Data.Query_Get_Gold), SQL_FILE);

  0027d	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  00282	68 00 01 00 00	 push	 256			; 00000100H
  00287	8d 97 00 0e 00
	00		 lea	 edx, DWORD PTR [edi+3584]
  0028d	52		 push	 edx
  0028e	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  00293	68 00 00 00 00	 push	 OFFSET ??_C@_0P@GJJCKIJP@Query_Get_Gold?$AA@
  00298	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  0029d	ff d6		 call	 esi

; 37   : 	GetPrivateProfileString("SQL", "Query_Update_Gold", "null", this->m_Data.Query_Update_Gold, sizeof(this->m_Data.Query_Update_Gold), SQL_FILE);

  0029f	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  002a4	68 00 01 00 00	 push	 256			; 00000100H
  002a9	8d 87 00 0f 00
	00		 lea	 eax, DWORD PTR [edi+3840]
  002af	50		 push	 eax
  002b0	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  002b5	68 00 00 00 00	 push	 OFFSET ??_C@_0BC@PIOLOKNK@Query_Update_Gold?$AA@
  002ba	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  002bf	ff d6		 call	 esi

; 38   : 	GetPrivateProfileString("SQL", "Query_Get_Cash", "null", this->m_Data.Query_Get_Cash, sizeof(this->m_Data.Query_Get_Cash), SQL_FILE);

  002c1	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  002c6	68 00 01 00 00	 push	 256			; 00000100H
  002cb	8d 8f 00 10 00
	00		 lea	 ecx, DWORD PTR [edi+4096]
  002d1	51		 push	 ecx
  002d2	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  002d7	68 00 00 00 00	 push	 OFFSET ??_C@_0P@MHACNCCN@Query_Get_Cash?$AA@
  002dc	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  002e1	ff d6		 call	 esi

; 39   : 	GetPrivateProfileString("SQL", "Query_Update_Cash", "null", this->m_Data.Query_Update_Cash, sizeof(this->m_Data.Query_Update_Cash), SQL_FILE);

  002e3	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@GPKOKHC@?4?2Customs?2SQLServer?2Hgt_SQLConne@
  002e8	68 00 01 00 00	 push	 256			; 00000100H
  002ed	81 c7 00 11 00
	00		 add	 edi, 4352		; 00001100H
  002f3	57		 push	 edi
  002f4	68 00 00 00 00	 push	 OFFSET ??_C@_04MLLLIHIP@null?$AA@
  002f9	68 00 00 00 00	 push	 OFFSET ??_C@_0BC@FGHLJAGI@Query_Update_Cash?$AA@
  002fe	68 00 00 00 00	 push	 OFFSET ??_C@_03DGLBMECB@SQL?$AA@
  00303	ff d6		 call	 esi

; 40   : 	// --- 
; 41   : 	if(PointsSql.Connect(&m_SqlConn) == false) 

  00305	68 00 00 00 00	 push	 OFFSET ?m_SqlConn@@3U_TAG_SQLCONNECTION@@A ; m_SqlConn
  0030a	b9 00 00 00 00	 mov	 ecx, OFFSET ?PointsSql@@3VCSQL@@A ; PointsSql
  0030f	e8 00 00 00 00	 call	 ?Connect@CSQL@@QAE_NPAU_TAG_SQLCONNECTION@@@Z ; CSQL::Connect
  00314	5f		 pop	 edi
  00315	5e		 pop	 esi
  00316	84 c0		 test	 al, al
  00318	75 1c		 jne	 SHORT $LN2@Load

; 42   : 	{
; 43   : 		MessageBoxA(NULL, "Conexão com SQL Server Falhou !\nFavor Verificar o arquivo 'Hgt_SQLConnect.ini'", "Erro na conexão com SQL Server !", MB_OK | MB_ICONERROR);

  0031a	6a 10		 push	 16			; 00000010H
  0031c	68 00 00 00 00	 push	 OFFSET ??_C@_0CB@GGMKHPNP@Erro?5na?5conex?co?5com?5SQL?5Server?5?$CB@
  00321	68 00 00 00 00	 push	 OFFSET ??_C@_0EP@LGBMOHAH@Conex?co?5com?5SQL?5Server?5Falhou?5?$CB?6@
  00326	6a 00		 push	 0
  00328	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__MessageBoxA@16

; 44   : 		ExitProcess(0);

  0032e	6a 00		 push	 0
  00330	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__ExitProcess@4
$LN8@Load:
$LN2@Load:

; 45   : 	} 
; 46   : 	else 
; 47   : 	{
; 48   : 		LogAdd(LOG_RED,  "[SQL Server] Connect to DataBase (%s)", m_SqlConn.sDatabase);

  00336	68 fd 02 00 00	 push	 OFFSET ?m_SqlConn@@3U_TAG_SQLCONNECTION@@A+765
  0033b	68 00 00 00 00	 push	 OFFSET ??_C@_0CG@GENGKJHJ@?$FLSQL?5Server?$FN?5Connect?5to?5DataBase@
  00340	6a 01		 push	 1
  00342	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd
  00347	83 c4 0c	 add	 esp, 12			; 0000000cH

; 49   : 	}
; 50   : }

  0034a	c3		 ret	 0
$LN7@Load:
?Load@SQLClass@@QAEXXZ ENDP				; SQLClass::Load
_TEXT	ENDS
PUBLIC	__$ArrayPad$
PUBLIC	?ReturnString@SQLClass@@QAAPADPAD0ZZ		; SQLClass::ReturnString
EXTRN	?ToString@CSQLValue@@QAEPADXZ:PROC		; CSQLValue::ToString
;	COMDAT ?szResult@?1??ReturnString@SQLClass@@QAAPADPAD0ZZ@4PADA
; File c:\program files (x86)\microsoft visual studio 10.0\vc\include\string.h
_BSS	SEGMENT
?szResult@?1??ReturnString@SQLClass@@QAAPADPAD0ZZ@4PADA DB 0400H DUP (?) ; `SQLClass::ReturnString'::`2'::szResult
; Function compile flags: /Ogtp
; File c:\users\faelhs\mu-1.1\emu - gameserver sapphire s0\gameserver\sqlmanager.cpp
_BSS	ENDS
;	COMDAT ?ReturnString@SQLClass@@QAAPADPAD0ZZ
_TEXT	SEGMENT
$T157399 = -1036					; size = 8
_szBuffer$ = -1028					; size = 1024
__$ArrayPad$ = -4					; size = 4
_this$ = 8						; size = 4
_szField$ = 12						; size = 4
_szQuery$ = 16						; size = 4
?ReturnString@SQLClass@@QAAPADPAD0ZZ PROC		; SQLClass::ReturnString, COMDAT

; 70   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 0c 04 00
	00		 sub	 esp, 1036		; 0000040cH
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	56		 push	 esi
  00014	8b 75 0c	 mov	 esi, DWORD PTR _szField$[ebp]

; 71   : 	char szBuffer[1024] = {0};

  00017	68 ff 03 00 00	 push	 1023			; 000003ffH
  0001c	8d 85 fd fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp+1]
  00022	6a 00		 push	 0
  00024	50		 push	 eax
  00025	c6 85 fc fb ff
	ff 00		 mov	 BYTE PTR _szBuffer$[ebp], 0
  0002c	e8 00 00 00 00	 call	 _memset

; 72   : 	// ---
; 73   : 	static char szResult[1024] = {0};
; 74   : 	// ---
; 75   : 	va_list pArguments;
; 76   : 	// ---
; 77   : 	va_start(pArguments, szQuery);
; 78   : 	// ---
; 79   : 	vsprintf(szBuffer, szQuery, pArguments);

  00031	8b 55 10	 mov	 edx, DWORD PTR _szQuery$[ebp]
  00034	8d 4d 14	 lea	 ecx, DWORD PTR _szQuery$[ebp+4]
  00037	51		 push	 ecx
  00038	52		 push	 edx
  00039	8d 85 fc fb ff
	ff		 lea	 eax, DWORD PTR _szBuffer$[ebp]
  0003f	50		 push	 eax
  00040	e8 00 00 00 00	 call	 _vsprintf
  00045	83 c4 18	 add	 esp, 24			; 00000018H

; 80   : 	// ---
; 81   : 	va_end(pArguments);
; 82   : 	// ---
; 83   : 	PointsSql.Execute(szBuffer, &rsSql, true);

  00048	6a 01		 push	 1
  0004a	68 00 00 00 00	 push	 OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  0004f	8d 8d fc fb ff
	ff		 lea	 ecx, DWORD PTR _szBuffer$[ebp]
  00055	51		 push	 ecx
  00056	b9 00 00 00 00	 mov	 ecx, OFFSET ?PointsSql@@3VCSQL@@A ; PointsSql
  0005b	e8 00 00 00 00	 call	 ?Execute@CSQL@@QAE_NPBDPAVCBoundRecordSet@@_N@Z ; CSQL::Execute

; 84   : 	// ---
; 85   : 	rsSql.Fetch();

  00060	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00065	e8 00 00 00 00	 call	 ?Fetch@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Fetch

; 86   : 	// ---
; 87   : 	strcpy_s(szResult, rsSql.Values(szField).ToString());

  0006a	56		 push	 esi
  0006b	8d 95 f4 fb ff
	ff		 lea	 edx, DWORD PTR $T157399[ebp]
  00071	52		 push	 edx
  00072	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00077	e8 00 00 00 00	 call	 ?Values@CBoundRecordSet@@QAE?AVCSQLValue@@PBD@Z ; CBoundRecordSet::Values
  0007c	8b c8		 mov	 ecx, eax
  0007e	e8 00 00 00 00	 call	 ?ToString@CSQLValue@@QAEPADXZ ; CSQLValue::ToString
  00083	50		 push	 eax
  00084	68 00 04 00 00	 push	 1024			; 00000400H
  00089	68 00 00 00 00	 push	 OFFSET ?szResult@?1??ReturnString@SQLClass@@QAAPADPAD0ZZ@4PADA
  0008e	e8 00 00 00 00	 call	 _strcpy_s
  00093	83 c4 0c	 add	 esp, 12			; 0000000cH

; 88   : 	// ---
; 89   : 	rsSql.Close();

  00096	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  0009b	e8 00 00 00 00	 call	 ?Close@CBoundRecordSet@@QAE_NXZ ; CBoundRecordSet::Close

; 90   : 	// ---
; 91   : 	return szResult;
; 92   : }

  000a0	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  000a3	33 cd		 xor	 ecx, ebp
  000a5	b8 00 00 00 00	 mov	 eax, OFFSET ?szResult@?1??ReturnString@SQLClass@@QAAPADPAD0ZZ@4PADA
  000aa	5e		 pop	 esi
  000ab	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000b0	8b e5		 mov	 esp, ebp
  000b2	5d		 pop	 ebp
  000b3	c3		 ret	 0
?ReturnString@SQLClass@@QAAPADPAD0ZZ ENDP		; SQLClass::ReturnString
_TEXT	ENDS
EXTRN	_atexit:PROC
EXTRN	??0CBoundRecordSet@@QAE@XZ:PROC			; CBoundRecordSet::CBoundRecordSet
; Function compile flags: /Ogtp
;	COMDAT ??__ErsSql@@YAXXZ
text$yc	SEGMENT
??__ErsSql@@YAXXZ PROC					; `dynamic initializer for 'rsSql'', COMDAT

; 6    : CBoundRecordSet rsSql;

  00000	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00005	e8 00 00 00 00	 call	 ??0CBoundRecordSet@@QAE@XZ ; CBoundRecordSet::CBoundRecordSet
  0000a	68 00 00 00 00	 push	 OFFSET ??__FrsSql@@YAXXZ ; `dynamic atexit destructor for 'rsSql''
  0000f	e8 00 00 00 00	 call	 _atexit
  00014	59		 pop	 ecx
  00015	c3		 ret	 0
??__ErsSql@@YAXXZ ENDP					; `dynamic initializer for 'rsSql''
text$yc	ENDS
EXTRN	??0CSQL@@QAE@XZ:PROC				; CSQL::CSQL
; Function compile flags: /Ogtp
;	COMDAT ??__EPointsSql@@YAXXZ
text$yc	SEGMENT
??__EPointsSql@@YAXXZ PROC				; `dynamic initializer for 'PointsSql'', COMDAT

; 7    : CSQL PointsSql;

  00000	b9 00 00 00 00	 mov	 ecx, OFFSET ?PointsSql@@3VCSQL@@A ; PointsSql
  00005	e8 00 00 00 00	 call	 ??0CSQL@@QAE@XZ		; CSQL::CSQL
  0000a	68 00 00 00 00	 push	 OFFSET ??__FPointsSql@@YAXXZ ; `dynamic atexit destructor for 'PointsSql''
  0000f	e8 00 00 00 00	 call	 _atexit
  00014	59		 pop	 ecx
  00015	c3		 ret	 0
??__EPointsSql@@YAXXZ ENDP				; `dynamic initializer for 'PointsSql''
text$yc	ENDS
EXTRN	??1CBoundRecordSet@@QAE@XZ:PROC			; CBoundRecordSet::~CBoundRecordSet
; Function compile flags: /Ogtp
;	COMDAT ??__FrsSql@@YAXXZ
text$yd	SEGMENT
??__FrsSql@@YAXXZ PROC					; `dynamic atexit destructor for 'rsSql'', COMDAT
  00000	b9 00 00 00 00	 mov	 ecx, OFFSET ?rsSql@@3VCBoundRecordSet@@A ; rsSql
  00005	e9 00 00 00 00	 jmp	 ??1CBoundRecordSet@@QAE@XZ ; CBoundRecordSet::~CBoundRecordSet
??__FrsSql@@YAXXZ ENDP					; `dynamic atexit destructor for 'rsSql''
text$yd	ENDS
EXTRN	??1CSQL@@QAE@XZ:PROC				; CSQL::~CSQL
; Function compile flags: /Ogtp
;	COMDAT ??__FPointsSql@@YAXXZ
text$yd	SEGMENT
??__FPointsSql@@YAXXZ PROC				; `dynamic atexit destructor for 'PointsSql'', COMDAT
  00000	b9 00 00 00 00	 mov	 ecx, OFFSET ?PointsSql@@3VCSQL@@A ; PointsSql
  00005	e9 00 00 00 00	 jmp	 ??1CSQL@@QAE@XZ		; CSQL::~CSQL
??__FPointsSql@@YAXXZ ENDP				; `dynamic atexit destructor for 'PointsSql''
text$yd	ENDS
PUBLIC	?PointsSql@@3VCSQL@@A				; PointsSql
PUBLIC	?rsSql@@3VCBoundRecordSet@@A			; rsSql
_BSS	SEGMENT
?PointsSql@@3VCSQL@@A DB 018H DUP (?)			; PointsSql
?rsSql@@3VCBoundRecordSet@@A DB 018H DUP (?)		; rsSql
_BSS	ENDS
CRT$XCU	SEGMENT
_rsSql$initializer$ DD FLAT:??__ErsSql@@YAXXZ
_PointsSql$initializer$ DD FLAT:??__EPointsSql@@YAXXZ
CRT$XCU	ENDS
END
