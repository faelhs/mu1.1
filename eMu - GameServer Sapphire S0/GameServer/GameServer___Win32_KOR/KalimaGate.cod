; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.30319.01 

	TITLE	C:\Users\faelhs\mu-1.1\eMu - GameServer Sapphire S0\GameServer\KalimaGate.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

_DATA	SEGMENT
_g_sttKALIMAGATE_LEVEL DD 028H
	DD	082H
	DD	014H
	DD	06eH
	DD	083H
	DD	0b4H
	DD	06fH
	DD	0a0H
	DD	0b5H
	DD	0e6H
	DD	0a1H
	DD	0d2H
	DD	0e7H
	DD	0118H
	DD	0d3H
	DD	0104H
	DD	0119H
	DD	014aH
	DD	0105H
	DD	0136H
	DD	014bH
	DD	015dH
	DD	0137H
	DD	015dH
	DD	015eH
	DD	0190H
	DD	015eH
	DD	0190H
_g_iKalimaGateGateIndex DD 058H
	DD	059H
	DD	05aH
	DD	05bH
	DD	05cH
	DD	05dH
	DD	074H
	ORG $+4
_g_sttDEVILSQUARE_LEVEL DD 0fH
	DD	082H
	DD	0aH
	DD	06eH
	DD	03aH
	DD	083H
	DD	0b4H
	DD	06fH
	DD	0a0H
	DD	03bH
	DD	0b5H
	DD	0e6H
	DD	0a1H
	DD	0d2H
	DD	03cH
	DD	0e7H
	DD	0118H
	DD	0d3H
	DD	0104H
	DD	03dH
	DD	0119H
	DD	014aH
	DD	0105H
	DD	0136H
	DD	06fH
	DD	014bH
	DD	0190H
	DD	0137H
	DD	0190H
	DD	070H
_g_sttBLOODCASTLE_LEVEL DD 0fH
	DD	050H
	DD	0aH
	DD	03cH
	DD	051H
	DD	082H
	DD	03dH
	DD	06eH
	DD	083H
	DD	0b4H
	DD	06fH
	DD	0a0H
	DD	0b5H
	DD	0e6H
	DD	0a1H
	DD	0d2H
	DD	0e7H
	DD	0118H
	DD	0d3H
	DD	0104H
	DD	0119H
	DD	014aH
	DD	0105H
	DD	0136H
	DD	014bH
	DD	0190H
	DD	0137H
	DD	0190H
_g_sttCHAOSCASTLE_LEVEL DD 0aH
	DD	031H
	DD	0aH
	DD	01dH
	DD	032H
	DD	077H
	DD	01eH
	DD	063H
	DD	078H
	DD	0b3H
	DD	064H
	DD	09fH
	DD	0b4H
	DD	0efH
	DD	0a0H
	DD	0dbH
	DD	0f0H
	DD	012bH
	DD	0dcH
	DD	0117H
	DD	012cH
	DD	0190H
	DD	0118H
	DD	0190H
_g_iChaosCastle_BlowOutDistance DD 03H
	DD	04H
	DD	03H
	DD	04H
	DD	02H
	DD	03H
	DD	00H
	DD	01H
_g_iChaosCastle_BlowOutDamage DD 0fH
	DD	0fH
	DD	0aH
	DD	05H
_g_iChaosCastle_EnterCost DD 061a8H
	DD	013880H
	DD	0249f0H
	DD	03d090H
	DD	061a80H
	DD	09eb10H
_g_iChaosCastle_GuardSetValue DD 09c4H
	DD	09c4H
	DD	09c4H
	DD	09c4H
	DD	09c4H
	DD	09c4H
_g_iChaosCastle_MonsterItems DD 01c0dH
	DD	01H
	DD	01c0eH
	DD	01H
	DD	01c0dH
	DD	01H
	DD	01c0eH
	DD	01H
	DD	01c0dH
	DD	01H
	DD	01c0eH
	DD	01H
	DD	01c0dH
	DD	01H
	DD	01c0eH
	DD	01H
	DD	01c0dH
	DD	01H
	DD	01c0eH
	DD	02H
	DD	01c0dH
	DD	01H
	DD	01c0eH
	DD	02H
_g_iChaosCastle_GroundAxis DD 017H
	DD	04bH
	DD	02cH
	DD	06cH
_g_iChaosCastle_DamageAxis DD 017H
	DD	04bH
	DD	02cH
	DD	06cH
	DD	019H
	DD	04dH
	DD	02aH
	DD	06aH
	DD	01bH
	DD	04fH
	DD	028H
	DD	068H
	DD	01dH
	DD	051H
	DD	026H
	DD	066H
_g_iChaosCastle_MapHollowZone DD 017H
	DD	04bH
	DD	02cH
	DD	04cH
	DD	02bH
	DD	04dH
	DD	02cH
	DD	06cH
	DD	017H
	DD	06bH
	DD	02aH
	DD	06cH
	DD	017H
	DD	04dH
	DD	018H
	DD	06aH
	DD	017H
	DD	04bH
	DD	02cH
	DD	04cH
	DD	02bH
	DD	04dH
	DD	02cH
	DD	06cH
	DD	017H
	DD	06bH
	DD	02aH
	DD	06cH
	DD	017H
	DD	04dH
	DD	018H
	DD	06aH
	DD	019H
	DD	04dH
	DD	02aH
	DD	04eH
	DD	029H
	DD	04fH
	DD	02aH
	DD	06aH
	DD	019H
	DD	069H
	DD	028H
	DD	06aH
	DD	019H
	DD	04fH
	DD	01aH
	DD	068H
	DD	01bH
	DD	04fH
	DD	028H
	DD	050H
	DD	027H
	DD	051H
	DD	028H
	DD	068H
	DD	01bH
	DD	067H
	DD	026H
	DD	068H
	DD	01bH
	DD	051H
	DD	01cH
	DD	066H
_DATA	ENDS
PUBLIC	??_7CKalimaGate@@6B@				; CKalimaGate::`vftable'
PUBLIC	??0CKalimaGate@@QAE@XZ				; CKalimaGate::CKalimaGate
PUBLIC	??_R4CKalimaGate@@6B@				; CKalimaGate::`RTTI Complete Object Locator'
PUBLIC	??_R0?AVCKalimaGate@@@8				; CKalimaGate `RTTI Type Descriptor'
PUBLIC	??_R3CKalimaGate@@8				; CKalimaGate::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2CKalimaGate@@8				; CKalimaGate::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@CKalimaGate@@8			; CKalimaGate::`RTTI Base Class Descriptor at (0,-1,0,64)'
EXTRN	__imp__InitializeCriticalSection@4:PROC
EXTRN	??_7type_info@@6B@:QWORD			; type_info::`vftable'
EXTRN	??_ECKalimaGate@@UAEPAXI@Z:PROC			; CKalimaGate::`vector deleting destructor'
;	COMDAT ??_R1A@?0A@EA@CKalimaGate@@8
; File c:\users\faelhs\mu-1.1\emu - gameserver sapphire s0\gameserver\kalimagate.cpp
rdata$r	SEGMENT
??_R1A@?0A@EA@CKalimaGate@@8 DD FLAT:??_R0?AVCKalimaGate@@@8 ; CKalimaGate::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	00H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3CKalimaGate@@8
rdata$r	ENDS
;	COMDAT ??_R2CKalimaGate@@8
rdata$r	SEGMENT
??_R2CKalimaGate@@8 DD FLAT:??_R1A@?0A@EA@CKalimaGate@@8 ; CKalimaGate::`RTTI Base Class Array'
rdata$r	ENDS
;	COMDAT ??_R3CKalimaGate@@8
rdata$r	SEGMENT
??_R3CKalimaGate@@8 DD 00H				; CKalimaGate::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	01H
	DD	FLAT:??_R2CKalimaGate@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVCKalimaGate@@@8
_DATA	SEGMENT
??_R0?AVCKalimaGate@@@8 DD FLAT:??_7type_info@@6B@	; CKalimaGate `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVCKalimaGate@@', 00H
_DATA	ENDS
;	COMDAT ??_R4CKalimaGate@@6B@
rdata$r	SEGMENT
??_R4CKalimaGate@@6B@ DD 00H				; CKalimaGate::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVCKalimaGate@@@8
	DD	FLAT:??_R3CKalimaGate@@8
rdata$r	ENDS
;	COMDAT ??_7CKalimaGate@@6B@
CONST	SEGMENT
??_7CKalimaGate@@6B@ DD FLAT:??_R4CKalimaGate@@6B@	; CKalimaGate::`vftable'
	DD	FLAT:??_ECKalimaGate@@UAEPAXI@Z
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ??0CKalimaGate@@QAE@XZ
_TEXT	SEGMENT
??0CKalimaGate@@QAE@XZ PROC				; CKalimaGate::CKalimaGate, COMDAT
; _this$ = ecx

; 18   : {

  00000	56		 push	 esi
  00001	8b f1		 mov	 esi, ecx

; 19   : 	InitializeCriticalSection(&this->m_critKalimaGate );

  00003	8d 46 04	 lea	 eax, DWORD PTR [esi+4]
  00006	50		 push	 eax
  00007	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7CKalimaGate@@6B@
  0000d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__InitializeCriticalSection@4

; 20   : }

  00013	8b c6		 mov	 eax, esi
  00015	5e		 pop	 esi
  00016	c3		 ret	 0
??0CKalimaGate@@QAE@XZ ENDP				; CKalimaGate::CKalimaGate
_TEXT	ENDS
PUBLIC	??1CKalimaGate@@UAE@XZ				; CKalimaGate::~CKalimaGate
EXTRN	__imp__DeleteCriticalSection@4:PROC
; Function compile flags: /Ogtp
;	COMDAT ??1CKalimaGate@@UAE@XZ
_TEXT	SEGMENT
??1CKalimaGate@@UAE@XZ PROC				; CKalimaGate::~CKalimaGate, COMDAT
; _this$ = ecx

; 23   : {

  00000	c7 01 00 00 00
	00		 mov	 DWORD PTR [ecx], OFFSET ??_7CKalimaGate@@6B@

; 24   : 	DeleteCriticalSection(&this->m_critKalimaGate );

  00006	83 c1 04	 add	 ecx, 4
  00009	51		 push	 ecx
  0000a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__DeleteCriticalSection@4

; 25   : }

  00010	c3		 ret	 0
??1CKalimaGate@@UAE@XZ ENDP				; CKalimaGate::~CKalimaGate
_TEXT	ENDS
PUBLIC	?CheckOverlapKundunMark@CKalimaGate@@QAEHHE@Z	; CKalimaGate::CheckOverlapKundunMark
EXTRN	?IsItem@CItem@@QAEHXZ:PROC			; CItem::IsItem
EXTRN	?gObj@@3PAUOBJECTSTRUCT@@A:BYTE			; gObj
EXTRN	__ftol2_sse:PROC
; Function compile flags: /Ogtp
;	COMDAT ?CheckOverlapKundunMark@CKalimaGate@@QAEHHE@Z
_TEXT	SEGMENT
_iIndex$ = 8						; size = 4
_btLevel$ = 12						; size = 1
?CheckOverlapKundunMark@CKalimaGate@@QAEHHE@Z PROC	; CKalimaGate::CheckOverlapKundunMark, COMDAT
; _this$ = ecx

; 314  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	53		 push	 ebx
  00004	56		 push	 esi
  00005	57		 push	 edi

; 315  : 	for ( int x = 0;x<MAIN_INVENTORY_SIZE;x++ )

  00006	8b 7d 08	 mov	 edi, DWORD PTR _iIndex$[ebp]
  00009	69 ff 64 15 00
	00		 imul	 edi, 5476		; 00001564H
  0000f	33 db		 xor	 ebx, ebx
  00011	8d bf 8c 0c 00
	00		 lea	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+3212]
  00017	33 f6		 xor	 esi, esi
  00019	8d a4 24 00 00
	00 00		 npad	 7
$LL7@CheckOverl:

; 316  : 	{
; 317  : 		if ( gObj[iIndex].pInventory[x].IsItem() == TRUE )

  00020	8b 0f		 mov	 ecx, DWORD PTR [edi]
  00022	03 ce		 add	 ecx, esi
  00024	e8 00 00 00 00	 call	 ?IsItem@CItem@@QAEHXZ	; CItem::IsItem
  00029	83 f8 01	 cmp	 eax, 1
  0002c	75 34		 jne	 SHORT $LN6@CheckOverl

; 318  : 		{
; 319  : 			if ( gObj[iIndex].pInventory[x].m_Type == ITEMGET(14, 29) )

  0002e	8b 07		 mov	 eax, DWORD PTR [edi]
  00030	b9 1d 1c 00 00	 mov	 ecx, 7197		; 00001c1dH
  00035	66 39 4c 30 06	 cmp	 WORD PTR [eax+esi+6], cx
  0003a	75 26		 jne	 SHORT $LN6@CheckOverl

; 320  : 			{
; 321  : 				if ( gObj[iIndex].pInventory[x].m_Level == btLevel )

  0003c	0f b6 55 0c	 movzx	 edx, BYTE PTR _btLevel$[ebp]
  00040	66 39 54 30 08	 cmp	 WORD PTR [eax+esi+8], dx
  00045	75 1b		 jne	 SHORT $LN6@CheckOverl

; 322  : 				{
; 323  : 					int iITEM_DUR = gObj[iIndex].pInventory[x].m_Durability;

  00047	d9 44 30 24	 fld	 DWORD PTR [eax+esi+36]
  0004b	e8 00 00 00 00	 call	 __ftol2_sse

; 324  : 
; 325  : 					if ( KUNDUN_MARK_RANGE(iITEM_DUR) != FALSE )

  00050	85 c0		 test	 eax, eax
  00052	78 0e		 js	 SHORT $LN6@CheckOverl
  00054	33 c9		 xor	 ecx, ecx
  00056	83 f8 04	 cmp	 eax, 4
  00059	0f 9e c1	 setle	 cl
  0005c	8b c1		 mov	 eax, ecx
  0005e	85 c0		 test	 eax, eax
  00060	75 19		 jne	 SHORT $LN13@CheckOverl
$LN6@CheckOverl:

; 315  : 	for ( int x = 0;x<MAIN_INVENTORY_SIZE;x++ )

  00062	81 c6 a8 00 00
	00		 add	 esi, 168		; 000000a8H
  00068	43		 inc	 ebx
  00069	81 fe e0 31 00
	00		 cmp	 esi, 12768		; 000031e0H
  0006f	7c af		 jl	 SHORT $LL7@CheckOverl

; 328  : 					}
; 329  : 				}
; 330  : 			}
; 331  : 		}
; 332  : 	}
; 333  : 
; 334  : 	return -1;

  00071	5f		 pop	 edi
  00072	5e		 pop	 esi
  00073	83 c8 ff	 or	 eax, -1
  00076	5b		 pop	 ebx

; 335  : }

  00077	5d		 pop	 ebp
  00078	c2 08 00	 ret	 8
$LN13@CheckOverl:
  0007b	5f		 pop	 edi
  0007c	5e		 pop	 esi

; 326  : 					{
; 327  : 						return x;

  0007d	8b c3		 mov	 eax, ebx
  0007f	5b		 pop	 ebx

; 335  : }

  00080	5d		 pop	 ebp
  00081	c2 08 00	 ret	 8
?CheckOverlapKundunMark@CKalimaGate@@QAEHHE@Z ENDP	; CKalimaGate::CheckOverlapKundunMark
_TEXT	ENDS
PUBLIC	?GetRandomLocation@CKalimaGate@@AAEHHAAE0@Z	; CKalimaGate::GetRandomLocation
EXTRN	?GetAttr@MapClass@@QAEEHH@Z:PROC		; MapClass::GetAttr
EXTRN	_rand:PROC
EXTRN	?MapC@@3PAVMapClass@@A:BYTE			; MapC
; Function compile flags: /Ogtp
;	COMDAT ?GetRandomLocation@CKalimaGate@@AAEHHAAE0@Z
_TEXT	SEGMENT
_iUY$ = -4						; size = 4
tv211 = 8						; size = 4
_iMapNumber$ = 8					; size = 4
_iUX$ = 12						; size = 4
_cX$ = 12						; size = 4
_cY$ = 16						; size = 4
?GetRandomLocation@CKalimaGate@@AAEHHAAE0@Z PROC	; CKalimaGate::GetRandomLocation, COMDAT
; _this$ = ecx

; 339  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx

; 340  : 	int iCount = 100;
; 341  : 	int iUX = cX;
; 342  : 	int iUY = cY;

  00004	8b 4d 10	 mov	 ecx, DWORD PTR _cY$[ebp]
  00007	0f b6 11	 movzx	 edx, BYTE PTR [ecx]
  0000a	53		 push	 ebx
  0000b	56		 push	 esi
  0000c	8b 75 0c	 mov	 esi, DWORD PTR _cX$[ebp]
  0000f	0f b6 06	 movzx	 eax, BYTE PTR [esi]
  00012	89 45 0c	 mov	 DWORD PTR _iUX$[ebp], eax
  00015	8b 45 08	 mov	 eax, DWORD PTR _iMapNumber$[ebp]
  00018	69 c0 08 07 05
	00		 imul	 eax, 329480		; 00050708H
  0001e	8d 88 00 00 00
	00		 lea	 ecx, DWORD PTR ?MapC@@3PAVMapClass@@A[eax]
  00024	57		 push	 edi
  00025	bf 64 00 00 00	 mov	 edi, 100		; 00000064H
  0002a	89 55 fc	 mov	 DWORD PTR _iUY$[ebp], edx

; 343  : 
; 344  : 	while ( iCount-- > 0 )

  0002d	89 4d 08	 mov	 DWORD PTR tv211[ebp], ecx
$LL3@GetRandomL:
  00030	4f		 dec	 edi

; 345  : 	{
; 346  : 		cX = ( rand() %6) * (((rand()%2==0)?-1:1)) + iUX;

  00031	e8 00 00 00 00	 call	 _rand
  00036	8b d8		 mov	 ebx, eax
  00038	81 e3 01 00 00
	80		 and	 ebx, -2147483647	; 80000001H
  0003e	79 05		 jns	 SHORT $LN9@GetRandomL
  00040	4b		 dec	 ebx
  00041	83 cb fe	 or	 ebx, -2			; fffffffeH
  00044	43		 inc	 ebx
$LN9@GetRandomL:
  00045	f7 db		 neg	 ebx
  00047	1a db		 sbb	 bl, bl
  00049	80 e3 02	 and	 bl, 2
  0004c	fe cb		 dec	 bl
  0004e	e8 00 00 00 00	 call	 _rand
  00053	99		 cdq
  00054	b9 06 00 00 00	 mov	 ecx, 6
  00059	f7 f9		 idiv	 ecx
  0005b	8a c2		 mov	 al, dl
  0005d	f6 eb		 imul	 bl
  0005f	02 45 0c	 add	 al, BYTE PTR _iUX$[ebp]
  00062	88 06		 mov	 BYTE PTR [esi], al

; 347  : 		cY = (rand()%6) * (((rand()%2==0)?-1:1)) + iUY;

  00064	e8 00 00 00 00	 call	 _rand
  00069	8b d8		 mov	 ebx, eax
  0006b	81 e3 01 00 00
	80		 and	 ebx, -2147483647	; 80000001H
  00071	79 05		 jns	 SHORT $LN10@GetRandomL
  00073	4b		 dec	 ebx
  00074	83 cb fe	 or	 ebx, -2			; fffffffeH
  00077	43		 inc	 ebx
$LN10@GetRandomL:
  00078	f7 db		 neg	 ebx
  0007a	1a db		 sbb	 bl, bl
  0007c	80 e3 02	 and	 bl, 2
  0007f	fe cb		 dec	 bl
  00081	e8 00 00 00 00	 call	 _rand
  00086	99		 cdq
  00087	b9 06 00 00 00	 mov	 ecx, 6
  0008c	f7 f9		 idiv	 ecx
  0008e	8a c2		 mov	 al, dl
  00090	8b 55 10	 mov	 edx, DWORD PTR _cY$[ebp]
  00093	f6 eb		 imul	 bl
  00095	02 45 fc	 add	 al, BYTE PTR _iUY$[ebp]
  00098	88 02		 mov	 BYTE PTR [edx], al

; 348  : 
; 349  : 		BYTE btMapAttr = MapC[iMapNumber].GetAttr(cX,cY);
; 350  : 
; 351  : 		if ( btMapAttr == 0 )

  0009a	0f b6 0e	 movzx	 ecx, BYTE PTR [esi]
  0009d	0f b6 c0	 movzx	 eax, al
  000a0	50		 push	 eax
  000a1	51		 push	 ecx
  000a2	8b 4d 08	 mov	 ecx, DWORD PTR tv211[ebp]
  000a5	e8 00 00 00 00	 call	 ?GetAttr@MapClass@@QAEEHH@Z ; MapClass::GetAttr
  000aa	84 c0		 test	 al, al
  000ac	74 13		 je	 SHORT $LN7@GetRandomL

; 343  : 
; 344  : 	while ( iCount-- > 0 )

  000ae	85 ff		 test	 edi, edi
  000b0	0f 8f 7a ff ff
	ff		 jg	 $LL3@GetRandomL

; 354  : 		}
; 355  : 	}
; 356  : 
; 357  : 	return FALSE;

  000b6	5f		 pop	 edi
  000b7	5e		 pop	 esi
  000b8	33 c0		 xor	 eax, eax
  000ba	5b		 pop	 ebx

; 358  : }

  000bb	8b e5		 mov	 esp, ebp
  000bd	5d		 pop	 ebp
  000be	c2 0c 00	 ret	 12			; 0000000cH
$LN7@GetRandomL:
  000c1	5f		 pop	 edi
  000c2	5e		 pop	 esi

; 352  : 		{
; 353  : 			return TRUE;

  000c3	b8 01 00 00 00	 mov	 eax, 1
  000c8	5b		 pop	 ebx

; 358  : }

  000c9	8b e5		 mov	 esp, ebp
  000cb	5d		 pop	 ebp
  000cc	c2 0c 00	 ret	 12			; 0000000cH
?GetRandomLocation@CKalimaGate@@AAEHHAAE0@Z ENDP	; CKalimaGate::GetRandomLocation
_TEXT	ENDS
PUBLIC	?GetKalimaGateLevel@CKalimaGate@@AAEHH@Z	; CKalimaGate::GetKalimaGateLevel
; Function compile flags: /Ogtp
;	COMDAT ?GetKalimaGateLevel@CKalimaGate@@AAEHH@Z
_TEXT	SEGMENT
_iIndex$ = 8						; size = 4
?GetKalimaGateLevel@CKalimaGate@@AAEHH@Z PROC		; CKalimaGate::GetKalimaGateLevel, COMDAT
; _this$ = ecx

; 361  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 362  : 	if ( gObj[iIndex].Class == CLASS_MAGUMSA || gObj[iIndex].Class == CLASS_DARKLORD )	// DarkLord and MagicGLadiaro

  00003	8b 4d 08	 mov	 ecx, DWORD PTR _iIndex$[ebp]
  00006	69 c9 64 15 00
	00		 imul	 ecx, 5476		; 00001564H
  0000c	0f b7 81 98 00
	00 00		 movzx	 eax, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ecx+152]
  00013	83 f8 03	 cmp	 eax, 3
  00016	74 34		 je	 SHORT $LN12@GetKalimaG
  00018	83 f8 04	 cmp	 eax, 4
  0001b	74 2f		 je	 SHORT $LN12@GetKalimaG

; 369  : 				{
; 370  : 					return i;
; 371  : 				}
; 372  : 			}
; 373  : 		}
; 374  : 	}
; 375  : 	else
; 376  : 	{
; 377  : 		for ( int i =0;i<KALIMA_FLOORS;i++)

  0001d	0f bf 91 9c 00
	00 00		 movsx	 edx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ecx+156]
  00024	33 c0		 xor	 eax, eax
  00026	b9 04 00 00 00	 mov	 ecx, OFFSET _g_sttKALIMAGATE_LEVEL+4
  0002b	eb 03 8d 49 00	 npad	 5
$LL5@GetKalimaG:

; 378  : 		{
; 379  : 			if ( gObj[iIndex].Level >= g_sttKALIMAGATE_LEVEL[i].iLOWER_BOUND )

  00030	3b 51 fc	 cmp	 edx, DWORD PTR [ecx-4]
  00033	7c 04		 jl	 SHORT $LN4@GetKalimaG

; 380  : 			{
; 381  : 				if ( gObj[iIndex].Level <= g_sttKALIMAGATE_LEVEL[i].iUPPER_BOUND )

  00035	3b 11		 cmp	 edx, DWORD PTR [ecx]
  00037	7e 3f		 jle	 SHORT $LN14@GetKalimaG
$LN4@GetKalimaG:

; 369  : 				{
; 370  : 					return i;
; 371  : 				}
; 372  : 			}
; 373  : 		}
; 374  : 	}
; 375  : 	else
; 376  : 	{
; 377  : 		for ( int i =0;i<KALIMA_FLOORS;i++)

  00039	83 c1 10	 add	 ecx, 16			; 00000010H
  0003c	40		 inc	 eax
  0003d	81 f9 74 00 00
	00		 cmp	 ecx, OFFSET _g_sttKALIMAGATE_LEVEL+116
  00043	7c eb		 jl	 SHORT $LL5@GetKalimaG

; 382  : 				{
; 383  : 					return i;
; 384  : 				}
; 385  : 			}
; 386  : 		}
; 387  : 	}
; 388  : 	return -1;

  00045	83 c8 ff	 or	 eax, -1

; 389  : }

  00048	5d		 pop	 ebp
  00049	c2 04 00	 ret	 4
$LN12@GetKalimaG:

; 363  : 	{
; 364  : 		for ( int i =0;i<KALIMA_FLOORS;i++)

  0004c	0f bf 91 9c 00
	00 00		 movsx	 edx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ecx+156]
  00053	33 c0		 xor	 eax, eax
  00055	b9 0c 00 00 00	 mov	 ecx, OFFSET _g_sttKALIMAGATE_LEVEL+12
  0005a	8d 9b 00 00 00
	00		 npad	 6
$LL11@GetKalimaG:

; 365  : 		{
; 366  : 			if ( gObj[iIndex].Level >= g_sttKALIMAGATE_LEVEL[i].iLOWER_BOUND_MAGUMSA )

  00060	3b 51 fc	 cmp	 edx, DWORD PTR [ecx-4]
  00063	7c 04		 jl	 SHORT $LN10@GetKalimaG

; 367  : 			{
; 368  : 				if ( gObj[iIndex].Level <= g_sttKALIMAGATE_LEVEL[i].iUPPER_BOUND_MAGUMSA )

  00065	3b 11		 cmp	 edx, DWORD PTR [ecx]
  00067	7e 0f		 jle	 SHORT $LN14@GetKalimaG
$LN10@GetKalimaG:

; 363  : 	{
; 364  : 		for ( int i =0;i<KALIMA_FLOORS;i++)

  00069	83 c1 10	 add	 ecx, 16			; 00000010H
  0006c	40		 inc	 eax
  0006d	81 f9 7c 00 00
	00		 cmp	 ecx, OFFSET _g_sttKALIMAGATE_LEVEL+124
  00073	7c eb		 jl	 SHORT $LL11@GetKalimaG

; 382  : 				{
; 383  : 					return i;
; 384  : 				}
; 385  : 			}
; 386  : 		}
; 387  : 	}
; 388  : 	return -1;

  00075	83 c8 ff	 or	 eax, -1
$LN14@GetKalimaG:

; 389  : }

  00078	5d		 pop	 ebp
  00079	c2 04 00	 ret	 4
?GetKalimaGateLevel@CKalimaGate@@AAEHH@Z ENDP		; CKalimaGate::GetKalimaGateLevel
_TEXT	ENDS
PUBLIC	??_C@_0FF@FPKJHAJK@?$FLKalima?$FN?5DeleteKalimaGate?$CI?$CJ?5?9?5ou@ ; `string'
PUBLIC	?DeleteKalimaGate@CKalimaGate@@QAEHHH@Z		; CKalimaGate::DeleteKalimaGate
EXTRN	__imp__LeaveCriticalSection@4:PROC
EXTRN	?LogAdd@@YAXW4eLogColor@@PADZZ:PROC		; LogAdd
EXTRN	?gObjCharZeroSet@@YAXH@Z:PROC			; gObjCharZeroSet
EXTRN	?gObjDel@@YAFH@Z:PROC				; gObjDel
EXTRN	?GCDiePlayerSend@@YAXPAUOBJECTSTRUCT@@HEH@Z:PROC ; GCDiePlayerSend
EXTRN	__imp__EnterCriticalSection@4:PROC
EXTRN	___security_cookie:DWORD
EXTRN	__except_handler4:PROC
EXTRN	__local_unwind4:PROC
;	COMDAT ??_C@_0FF@FPKJHAJK@?$FLKalima?$FN?5DeleteKalimaGate?$CI?$CJ?5?9?5ou@
CONST	SEGMENT
??_C@_0FF@FPKJHAJK@?$FLKalima?$FN?5DeleteKalimaGate?$CI?$CJ?5?9?5ou@ DB '['
	DB	'Kalima] DeleteKalimaGate() - out of Index (iKalimaGateIndex:%'
	DB	'd, iCallOwnerIndex:%d)', 00H		; `string'
CONST	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__sehtable$?DeleteKalimaGate@CKalimaGate@@QAEHHH@Z DD 0fffffffeH
	DD	00H
	DD	0ffffffd4H
	DD	00H
	DD	0fffffffeH
	DD	00H
	DD	FLAT:$LN11@DeleteKali
; Function compile flags: /Ogtp
xdata$x	ENDS
;	COMDAT ?DeleteKalimaGate@CKalimaGate@@QAEHHH@Z
_TEXT	SEGMENT
_this$ = -28						; size = 4
__$SEHRec$ = -24					; size = 24
_iKalimaGateIndex$ = 8					; size = 4
_iCallOwnerIndex$ = 12					; size = 4
?DeleteKalimaGate@CKalimaGate@@QAEHHH@Z PROC		; CKalimaGate::DeleteKalimaGate, COMDAT
; _this$ = ecx

; 393  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	6a fe		 push	 -2			; fffffffeH
  00005	68 00 00 00 00	 push	 OFFSET __sehtable$?DeleteKalimaGate@CKalimaGate@@QAEHHH@Z
  0000a	68 00 00 00 00	 push	 OFFSET __except_handler4
  0000f	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00015	50		 push	 eax
  00016	83 ec 0c	 sub	 esp, 12			; 0000000cH
  00019	53		 push	 ebx
  0001a	56		 push	 esi
  0001b	57		 push	 edi
  0001c	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00021	31 45 f8	 xor	 DWORD PTR __$SEHRec$[ebp+16], eax
  00024	33 c5		 xor	 eax, ebp
  00026	50		 push	 eax
  00027	8d 45 f0	 lea	 eax, DWORD PTR __$SEHRec$[ebp+8]
  0002a	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00030	89 4d e4	 mov	 DWORD PTR _this$[ebp], ecx

; 394  : 	EnterCriticalSection(&this->m_critKalimaGate);

  00033	83 c1 04	 add	 ecx, 4
  00036	51		 push	 ecx
  00037	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 395  : 
; 396  : 	__try

  0003d	33 db		 xor	 ebx, ebx
  0003f	89 5d fc	 mov	 DWORD PTR __$SEHRec$[ebp+20], ebx

; 397  : 	{
; 398  : 		if ( OBJMAX_RANGE(iKalimaGateIndex )== false || OBJMAX_RANGE(iCallOwnerIndex ) == false)

  00042	8b 75 08	 mov	 esi, DWORD PTR _iKalimaGateIndex$[ebp]
  00045	3b f3		 cmp	 esi, ebx
  00047	0f 8c 87 00 00
	00		 jl	 $LN15@DeleteKali
  0004d	33 c0		 xor	 eax, eax
  0004f	81 fe e7 1c 00
	00		 cmp	 esi, 7399		; 00001ce7H
  00055	0f 9e c0	 setle	 al
  00058	3b c3		 cmp	 eax, ebx
  0005a	74 78		 je	 SHORT $LN15@DeleteKali
  0005c	8b 7d 0c	 mov	 edi, DWORD PTR _iCallOwnerIndex$[ebp]
  0005f	3b fb		 cmp	 edi, ebx
  00061	7c 74		 jl	 SHORT $LN1@DeleteKali
  00063	33 c0		 xor	 eax, eax
  00065	81 ff e7 1c 00
	00		 cmp	 edi, 7399		; 00001ce7H
  0006b	0f 9e c0	 setle	 al
  0006e	3b c3		 cmp	 eax, ebx
  00070	74 65		 je	 SHORT $LN1@DeleteKali

; 403  : 		}
; 404  : 
; 405  : 		GCDiePlayerSend( &gObj[iKalimaGateIndex], iKalimaGateIndex, 0 , 0);

  00072	53		 push	 ebx
  00073	53		 push	 ebx
  00074	56		 push	 esi
  00075	8b c6		 mov	 eax, esi
  00077	69 c0 64 15 00
	00		 imul	 eax, 5476		; 00001564H
  0007d	05 00 00 00 00	 add	 eax, OFFSET ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  00082	50		 push	 eax
  00083	e8 00 00 00 00	 call	 ?GCDiePlayerSend@@YAXPAUOBJECTSTRUCT@@HEH@Z ; GCDiePlayerSend

; 406  : 		gObj[iCallOwnerIndex].m_cKalimaGateExist = FALSE;

  00088	8b c7		 mov	 eax, edi
  0008a	69 c0 64 15 00
	00		 imul	 eax, 5476		; 00001564H
  00090	88 98 2c 02 00
	00		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[eax+556], bl

; 407  : 		gObj[iCallOwnerIndex].m_iKalimaGateIndex = -1;

  00096	c7 80 30 02 00
	00 ff ff ff ff	 mov	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[eax+560], -1

; 408  : 		gObjDel(iKalimaGateIndex);

  000a0	56		 push	 esi
  000a1	e8 00 00 00 00	 call	 ?gObjDel@@YAFH@Z	; gObjDel

; 409  : 		gObjCharZeroSet(iKalimaGateIndex);

  000a6	56		 push	 esi
  000a7	e8 00 00 00 00	 call	 ?gObjCharZeroSet@@YAXH@Z ; gObjCharZeroSet
  000ac	83 c4 18	 add	 esp, 24			; 00000018H

; 410  : 	}
; 411  : 	__finally

  000af	c7 45 fc fe ff
	ff ff		 mov	 DWORD PTR __$SEHRec$[ebp+20], -2 ; fffffffeH
  000b6	e8 52 00 00 00	 call	 $LN13@DeleteKali
$LN14@DeleteKali:

; 414  : 	}
; 415  : 	return true;

  000bb	b8 01 00 00 00	 mov	 eax, 1

; 416  : }

  000c0	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  000c3	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  000ca	59		 pop	 ecx
  000cb	5f		 pop	 edi
  000cc	5e		 pop	 esi
  000cd	5b		 pop	 ebx
  000ce	8b e5		 mov	 esp, ebp
  000d0	5d		 pop	 ebp
  000d1	c2 08 00	 ret	 8
$LN15@DeleteKali:

; 410  : 	}
; 411  : 	__finally

  000d4	8b 7d 0c	 mov	 edi, DWORD PTR _iCallOwnerIndex$[ebp]
$LN1@DeleteKali:

; 399  : 		{
; 400  : 			LogAdd(LOG_BLACK, "[Kalima] DeleteKalimaGate() - out of Index (iKalimaGateIndex:%d, iCallOwnerIndex:%d)",
; 401  : 				iKalimaGateIndex, iCallOwnerIndex);

  000d7	57		 push	 edi
  000d8	56		 push	 esi
  000d9	68 00 00 00 00	 push	 OFFSET ??_C@_0FF@FPKJHAJK@?$FLKalima?$FN?5DeleteKalimaGate?$CI?$CJ?5?9?5ou@
  000de	53		 push	 ebx
  000df	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 402  : 			return 0;

  000e4	6a fe		 push	 -2			; fffffffeH
  000e6	8d 4d f0	 lea	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  000e9	51		 push	 ecx
  000ea	68 00 00 00 00	 push	 OFFSET ___security_cookie
  000ef	e8 00 00 00 00	 call	 __local_unwind4
  000f4	83 c4 1c	 add	 esp, 28			; 0000001cH
  000f7	33 c0		 xor	 eax, eax

; 416  : }

  000f9	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  000fc	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00103	59		 pop	 ecx
  00104	5f		 pop	 edi
  00105	5e		 pop	 esi
  00106	5b		 pop	 ebx
  00107	8b e5		 mov	 esp, ebp
  00109	5d		 pop	 ebp
  0010a	c2 08 00	 ret	 8
$LN11@DeleteKali:
$LN17@DeleteKali:
$LN13@DeleteKali:

; 412  : 	{
; 413  : 		LeaveCriticalSection(&this->m_critKalimaGate);

  0010d	8b 55 e4	 mov	 edx, DWORD PTR _this$[ebp]
  00110	83 c2 04	 add	 edx, 4
  00113	52		 push	 edx
  00114	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4
$LN12@DeleteKali:
$LN16@DeleteKali:
  0011a	c3		 ret	 0
?DeleteKalimaGate@CKalimaGate@@QAEHHH@Z ENDP		; CKalimaGate::DeleteKalimaGate
_TEXT	ENDS
PUBLIC	??_C@_0EA@CCDLFCDJ@?$FLKalima?$FN?5DeleteKalimaGate?$CI?$CJ?5?9?5ou@ ; `string'
PUBLIC	?DeleteKalimaGate@CKalimaGate@@QAEHH@Z		; CKalimaGate::DeleteKalimaGate
;	COMDAT ??_C@_0EA@CCDLFCDJ@?$FLKalima?$FN?5DeleteKalimaGate?$CI?$CJ?5?9?5ou@
CONST	SEGMENT
??_C@_0EA@CCDLFCDJ@?$FLKalima?$FN?5DeleteKalimaGate?$CI?$CJ?5?9?5ou@ DB '['
	DB	'Kalima] DeleteKalimaGate() - out of Index (iCallOwnerIndex:%d'
	DB	')', 00H					; `string'
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ?DeleteKalimaGate@CKalimaGate@@QAEHH@Z
_TEXT	SEGMENT
_iCallOwnerIndex$ = 8					; size = 4
?DeleteKalimaGate@CKalimaGate@@QAEHH@Z PROC		; CKalimaGate::DeleteKalimaGate, COMDAT
; _this$ = ecx

; 420  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi

; 421  : 	if ( OBJMAX_RANGE(iCallOwnerIndex ) == FALSE )

  00004	8b 75 08	 mov	 esi, DWORD PTR _iCallOwnerIndex$[ebp]
  00007	57		 push	 edi
  00008	8b f9		 mov	 edi, ecx
  0000a	85 f6		 test	 esi, esi
  0000c	78 0f		 js	 SHORT $LN13@DeleteKali@2
  0000e	33 c0		 xor	 eax, eax
  00010	81 fe e7 1c 00
	00		 cmp	 esi, 7399		; 00001ce7H
  00016	0f 9e c0	 setle	 al
  00019	85 c0		 test	 eax, eax
  0001b	75 18		 jne	 SHORT $LN4@DeleteKali@2
$LN13@DeleteKali@2:

; 422  : 	{	
; 423  : 		LogAdd(LOG_BLACK, "[Kalima] DeleteKalimaGate() - out of Index (iCallOwnerIndex:%d)",
; 424  : 			iCallOwnerIndex);

  0001d	56		 push	 esi
  0001e	68 00 00 00 00	 push	 OFFSET ??_C@_0EA@CCDLFCDJ@?$FLKalima?$FN?5DeleteKalimaGate?$CI?$CJ?5?9?5ou@
  00023	6a 00		 push	 0
  00025	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd
  0002a	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN1@DeleteKali@2:

; 436  : 	{
; 437  : 		return FALSE;

  0002d	5f		 pop	 edi
  0002e	33 c0		 xor	 eax, eax
  00030	5e		 pop	 esi

; 441  : }

  00031	5d		 pop	 ebp
  00032	c2 04 00	 ret	 4
$LN4@DeleteKali@2:

; 425  : 		return false;
; 426  : 	}
; 427  : 
; 428  : 	int iKalimaGateIndex = gObj[iCallOwnerIndex].m_iKalimaGateIndex;

  00035	8b c6		 mov	 eax, esi
  00037	69 c0 64 15 00
	00		 imul	 eax, 5476		; 00001564H
  0003d	8b 90 30 02 00
	00		 mov	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[eax+560]

; 429  : 
; 430  : 	if (  OBJMAX_RANGE (iKalimaGateIndex ) == FALSE )

  00043	85 d2		 test	 edx, edx
  00045	78 e6		 js	 SHORT $LN1@DeleteKali@2
  00047	33 c0		 xor	 eax, eax
  00049	81 fa e7 1c 00
	00		 cmp	 edx, 7399		; 00001ce7H
  0004f	0f 9e c0	 setle	 al
  00052	85 c0		 test	 eax, eax

; 431  : 	{	
; 432  : 		return false;

  00054	74 d7		 je	 SHORT $LN1@DeleteKali@2

; 433  : 	}
; 434  : 
; 435  : 	if ( gObj[iKalimaGateIndex].Live == FALSE || !KALIMA_ATTRIBUTE_RANGE(gObj[iKalimaGateIndex].m_Attribute) )

  00056	8b c2		 mov	 eax, edx
  00058	69 c0 64 15 00
	00		 imul	 eax, 5476		; 00001564H
  0005e	80 b8 62 00 00
	00 00		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[eax+98], 0
  00065	74 c6		 je	 SHORT $LN1@DeleteKali@2
  00067	0f b7 80 26 03
	00 00		 movzx	 eax, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[eax+806]
  0006e	66 83 f8 33	 cmp	 ax, 51			; 00000033H
  00072	7c b9		 jl	 SHORT $LN1@DeleteKali@2
  00074	33 c9		 xor	 ecx, ecx
  00076	66 83 f8 3a	 cmp	 ax, 58			; 0000003aH
  0007a	0f 9e c1	 setle	 cl
  0007d	8b c1		 mov	 eax, ecx
  0007f	85 c0		 test	 eax, eax
  00081	74 aa		 je	 SHORT $LN1@DeleteKali@2

; 438  : 	}
; 439  : 
; 440  : 	return this->DeleteKalimaGate(iKalimaGateIndex, iCallOwnerIndex);

  00083	56		 push	 esi
  00084	52		 push	 edx
  00085	8b cf		 mov	 ecx, edi
  00087	e8 00 00 00 00	 call	 ?DeleteKalimaGate@CKalimaGate@@QAEHHH@Z ; CKalimaGate::DeleteKalimaGate
  0008c	5f		 pop	 edi
  0008d	5e		 pop	 esi

; 441  : }

  0008e	5d		 pop	 ebp
  0008f	c2 04 00	 ret	 4
?DeleteKalimaGate@CKalimaGate@@QAEHH@Z ENDP		; CKalimaGate::DeleteKalimaGate
_TEXT	ENDS
PUBLIC	??_C@_0FA@KLLHPHHL@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ ; `string'
PUBLIC	??_C@_0JC@FDOJEAMO@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Create?5Kalima?5@ ; `string'
PUBLIC	__real@447a0000
PUBLIC	??_C@_0FE@DCIHOCIF@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ ; `string'
PUBLIC	??_C@_0GN@ELAOECBK@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ ; `string'
PUBLIC	??_C@_0FO@JJMJIIJC@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ ; `string'
PUBLIC	??_C@_0DG@GKLFNKKH@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Try?5to?5Create?5@ ; `string'
PUBLIC	?CreateKalimaGate2@CKalimaGate@@QAEHHHEE@Z	; CKalimaGate::CreateKalimaGate2
EXTRN	__imp__GetTickCount@0:PROC
EXTRN	?gObjSetMonster@@YAHHH@Z:PROC			; gObjSetMonster
EXTRN	?GetAttr@CMonsterAttr@@QAEPAUMONSTER_ATTRIBUTE@@H@Z:PROC ; CMonsterAttr::GetAttr
EXTRN	?gMAttr@@3VCMonsterAttr@@A:BYTE			; gMAttr
EXTRN	?gObjAddMonster@@YAFH@Z:PROC			; gObjAddMonster
EXTRN	?GCServerMsgStringSend@@YAXPADHE@Z:PROC		; GCServerMsgStringSend
EXTRN	?Get@CMsg@@QAEPADH@Z:PROC			; CMsg::Get
EXTRN	?lMsg@@3VCMsg@@A:BYTE				; lMsg
EXTRN	?gObjIsConnected@@YAHH@Z:PROC			; gObjIsConnected
EXTRN	__fltused:DWORD
;	COMDAT ??_C@_0FA@KLLHPHHL@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
CONST	SEGMENT
??_C@_0FA@KLLHPHHL@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ DB '['
	DB	'Kalima] [%s][%s] Failed to Summon Kalima Gate (NextMap) - Map'
	DB	'Number Error : %d', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0JC@FDOJEAMO@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Create?5Kalima?5@
CONST	SEGMENT
??_C@_0JC@FDOJEAMO@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Create?5Kalima?5@ DB '['
	DB	'Kalima] [%s][%s] Create Kalima Gate Successfuly (NextMap) (Li'
	DB	've:%d, GateTick:%u, DieRegen:%d, Map:%d, X:%d, Y:%d, SummonIn'
	DB	'dex:%d, OwnerIndex:%d)', 00H		; `string'
CONST	ENDS
;	COMDAT __real@447a0000
CONST	SEGMENT
__real@447a0000 DD 0447a0000r			; 1000
CONST	ENDS
;	COMDAT ??_C@_0FE@DCIHOCIF@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
CONST	SEGMENT
??_C@_0FE@DCIHOCIF@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ DB '['
	DB	'Kalima] [%s][%s] Kalima Gate Vanished (NextMap) - lpMATTR == '
	DB	'NULL (SummonIndex:%d)', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0GN@ELAOECBK@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
CONST	SEGMENT
??_C@_0GN@ELAOECBK@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ DB '['
	DB	'Kalima] [%s][%s] Failed to Summon Kalima Gate (NextMap) - Fai'
	DB	'led to get Location (MapNumber:%d, X:%d, Y:%d)', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0FO@JJMJIIJC@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
CONST	SEGMENT
??_C@_0FO@JJMJIIJC@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ DB '['
	DB	'Kalima] [%s][%s] Failed to Summon Kalima Gate (NextMap) - Alr'
	DB	'eady Have Gate (SummonIndex:%d)', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0DG@GKLFNKKH@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Try?5to?5Create?5@
CONST	SEGMENT
??_C@_0DG@GKLFNKKH@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Try?5to?5Create?5@ DB '['
	DB	'Kalima] [%s][%s] Try to Create Kalima Gate (NextMap)', 00H ; `string'
CONST	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__sehtable$?CreateKalimaGate2@CKalimaGate@@QAEHHHEE@Z DD 0fffffffeH
	DD	00H
	DD	0ffffffc8H
	DD	00H
	DD	0fffffffeH
	DD	00H
	DD	FLAT:$LN13@CreateKali
; Function compile flags: /Ogtp
xdata$x	ENDS
;	COMDAT ?CreateKalimaGate2@CKalimaGate@@QAEHHHEE@Z
_TEXT	SEGMENT
_this$ = -40						; size = 4
tv419 = -36						; size = 4
tv420 = -32						; size = 4
_cX$155877 = -25					; size = 1
__$SEHRec$ = -24					; size = 24
_iIndex$ = 8						; size = 4
_iMonMapNumber$ = 12					; size = 4
_cTX$ = 16						; size = 1
_cY$155878 = 19						; size = 1
_lpMATTR$155884 = 20					; size = 4
_cTY$ = 20						; size = 1
?CreateKalimaGate2@CKalimaGate@@QAEHHHEE@Z PROC		; CKalimaGate::CreateKalimaGate2, COMDAT
; _this$ = ecx

; 446  : {	

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	6a fe		 push	 -2			; fffffffeH
  00005	68 00 00 00 00	 push	 OFFSET __sehtable$?CreateKalimaGate2@CKalimaGate@@QAEHHHEE@Z
  0000a	68 00 00 00 00	 push	 OFFSET __except_handler4
  0000f	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00015	50		 push	 eax
  00016	83 ec 18	 sub	 esp, 24			; 00000018H
  00019	53		 push	 ebx
  0001a	56		 push	 esi
  0001b	57		 push	 edi
  0001c	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00021	31 45 f8	 xor	 DWORD PTR __$SEHRec$[ebp+16], eax
  00024	33 c5		 xor	 eax, ebp
  00026	50		 push	 eax
  00027	8d 45 f0	 lea	 eax, DWORD PTR __$SEHRec$[ebp+8]
  0002a	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00030	89 4d d8	 mov	 DWORD PTR _this$[ebp], ecx

; 447  : 	BOOL bKalimaGateCreateSucceed = FALSE;
; 448  : 	int iMonsterIndex = -1;
; 449  : 
; 450  : 	EnterCriticalSection(&this->m_critKalimaGate);

  00033	83 c1 04	 add	 ecx, 4
  00036	51		 push	 ecx
  00037	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 451  : 
; 452  : 	__try

  0003d	9b		 fwait
  0003e	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR __$SEHRec$[ebp+20], 0

; 453  : 	{
; 454  : 		if ( !gObjIsConnected(iIndex))

  00045	8b 5d 08	 mov	 ebx, DWORD PTR _iIndex$[ebp]
  00048	53		 push	 ebx
  00049	e8 00 00 00 00	 call	 ?gObjIsConnected@@YAHH@Z ; gObjIsConnected
  0004e	83 c4 04	 add	 esp, 4
  00051	85 c0		 test	 eax, eax
  00053	75 2a		 jne	 SHORT $LN8@CreateKali

; 455  : 			return FALSE;

  00055	6a fe		 push	 -2			; fffffffeH
  00057	9b		 fwait
  00058	8d 45 f0	 lea	 eax, DWORD PTR __$SEHRec$[ebp+8]
  0005b	50		 push	 eax
  0005c	68 00 00 00 00	 push	 OFFSET ___security_cookie
  00061	e8 00 00 00 00	 call	 __local_unwind4
  00066	83 c4 0c	 add	 esp, 12			; 0000000cH
  00069	33 c0		 xor	 eax, eax

; 557  : }

  0006b	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  0006e	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00075	59		 pop	 ecx
  00076	5f		 pop	 edi
  00077	5e		 pop	 esi
  00078	5b		 pop	 ebx
  00079	8b e5		 mov	 esp, ebp
  0007b	5d		 pop	 ebp
  0007c	c2 10 00	 ret	 16			; 00000010H
$LN8@CreateKali:

; 456  : 
; 457  : 		LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Try to Create Kalima Gate (NextMap)",
; 458  : 			gObj[iIndex].AccountID, gObj[iIndex].Name);

  0007f	69 db 64 15 00
	00		 imul	 ebx, 5476		; 00001564H
  00085	8d bb 6f 00 00
	00		 lea	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ebx+111]
  0008b	89 7d dc	 mov	 DWORD PTR tv419[ebp], edi
  0008e	8d b3 64 00 00
	00		 lea	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ebx+100]
  00094	89 75 e0	 mov	 DWORD PTR tv420[ebp], esi
  00097	57		 push	 edi
  00098	56		 push	 esi
  00099	68 00 00 00 00	 push	 OFFSET ??_C@_0DG@GKLFNKKH@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Try?5to?5Create?5@
  0009e	6a 00		 push	 0
  000a0	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd
  000a5	83 c4 10	 add	 esp, 16			; 00000010H

; 459  : 
; 460  : 		if ( iMonMapNumber < MAP_INDEX_KALIMA1 || iMonMapNumber > MAP_INDEX_KALIMA6-1 )

  000a8	8b 4d 0c	 mov	 ecx, DWORD PTR _iMonMapNumber$[ebp]
  000ab	8d 51 e8	 lea	 edx, DWORD PTR [ecx-24]
  000ae	83 fa 04	 cmp	 edx, 4
  000b1	0f 87 c8 02 00
	00		 ja	 $LN6@CreateKali

; 466  : 		}
; 467  : 
; 468  : 		if ( gObj[iIndex].m_cKalimaGateExist == TRUE )

  000b7	80 bb 2c 02 00
	00 01		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ebx+556], 1
  000be	75 5a		 jne	 SHORT $LN5@CreateKali

; 469  : 		{
; 470  : 			GCServerMsgStringSend(lMsg.Get(MSGGET(4, 224)), iIndex, 1);

  000c0	6a 01		 push	 1
  000c2	8b 45 08	 mov	 eax, DWORD PTR _iIndex$[ebp]
  000c5	50		 push	 eax
  000c6	68 e0 04 00 00	 push	 1248			; 000004e0H
  000cb	b9 00 00 00 00	 mov	 ecx, OFFSET ?lMsg@@3VCMsg@@A ; lMsg
  000d0	e8 00 00 00 00	 call	 ?Get@CMsg@@QAEPADH@Z	; CMsg::Get
  000d5	50		 push	 eax
  000d6	e8 00 00 00 00	 call	 ?GCServerMsgStringSend@@YAXPADHE@Z ; GCServerMsgStringSend

; 471  : 
; 472  : 			LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Failed to Summon Kalima Gate (NextMap) - Already Have Gate (SummonIndex:%d)",
; 473  : 				gObj[iIndex].AccountID, gObj[iIndex].Name, gObj[iIndex].m_iKalimaGateIndex);

  000db	8b 8b 30 02 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ebx+560]
  000e1	51		 push	 ecx
  000e2	57		 push	 edi
  000e3	56		 push	 esi
  000e4	68 00 00 00 00	 push	 OFFSET ??_C@_0FO@JJMJIIJC@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
  000e9	6a 00		 push	 0
  000eb	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 474  : 	
; 475  : 			return FALSE;

  000f0	6a fe		 push	 -2			; fffffffeH
  000f2	9b		 fwait
  000f3	8d 55 f0	 lea	 edx, DWORD PTR __$SEHRec$[ebp+8]
  000f6	52		 push	 edx
  000f7	68 00 00 00 00	 push	 OFFSET ___security_cookie
  000fc	e8 00 00 00 00	 call	 __local_unwind4
  00101	83 c4 2c	 add	 esp, 44			; 0000002cH
  00104	33 c0		 xor	 eax, eax

; 557  : }

  00106	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  00109	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00110	59		 pop	 ecx
  00111	5f		 pop	 edi
  00112	5e		 pop	 esi
  00113	5b		 pop	 ebx
  00114	8b e5		 mov	 esp, ebp
  00116	5d		 pop	 ebp
  00117	c2 10 00	 ret	 16			; 00000010H
$LN5@CreateKali:

; 476  : 		}
; 477  : 
; 478  : 		int iMonsterType = iMonMapNumber + 129;

  0011a	8d b1 81 00 00
	00		 lea	 esi, DWORD PTR [ecx+129]

; 479  : 		BYTE cX = cTX;

  00120	8a 45 10	 mov	 al, BYTE PTR _cTX$[ebp]
  00123	88 45 e7	 mov	 BYTE PTR _cX$155877[ebp], al

; 480  : 		BYTE cY = cTY;

  00126	8a 55 14	 mov	 dl, BYTE PTR _cTY$[ebp]
  00129	88 55 13	 mov	 BYTE PTR _cY$155878[ebp], dl

; 481  : 		BYTE btMapAttr = MapC[iMonMapNumber].GetAttr(cX, cY);

  0012c	0f b6 d2	 movzx	 edx, dl
  0012f	52		 push	 edx
  00130	0f b6 c0	 movzx	 eax, al
  00133	50		 push	 eax
  00134	69 c9 08 07 05
	00		 imul	 ecx, 329480		; 00050708H
  0013a	81 c1 00 00 00
	00		 add	 ecx, OFFSET ?MapC@@3PAVMapClass@@A ; MapC
  00140	e8 00 00 00 00	 call	 ?GetAttr@MapClass@@QAEEHH@Z ; MapClass::GetAttr

; 482  : 
; 483  : 		if ( btMapAttr != 0 )

  00145	84 c0		 test	 al, al
  00147	74 61		 je	 SHORT $LN3@CreateKali

; 484  : 		{
; 485  : 			if ( this->GetRandomLocation(iMonMapNumber, cX, cY) == FALSE )

  00149	8d 4d 13	 lea	 ecx, DWORD PTR _cY$155878[ebp]
  0014c	51		 push	 ecx
  0014d	8d 55 e7	 lea	 edx, DWORD PTR _cX$155877[ebp]
  00150	52		 push	 edx
  00151	8b 45 0c	 mov	 eax, DWORD PTR _iMonMapNumber$[ebp]
  00154	50		 push	 eax
  00155	8b 4d d8	 mov	 ecx, DWORD PTR _this$[ebp]
  00158	e8 00 00 00 00	 call	 ?GetRandomLocation@CKalimaGate@@AAEHHAAE0@Z ; CKalimaGate::GetRandomLocation
  0015d	85 c0		 test	 eax, eax
  0015f	75 49		 jne	 SHORT $LN3@CreateKali

; 486  : 			{
; 487  : 				LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Failed to Summon Kalima Gate (NextMap) - Failed to get Location (MapNumber:%d, X:%d, Y:%d)",
; 488  : 					gObj[iIndex].AccountID, gObj[iIndex].Name, iMonMapNumber, cX, cY);

  00161	0f b6 4d 13	 movzx	 ecx, BYTE PTR _cY$155878[ebp]
  00165	51		 push	 ecx
  00166	0f b6 55 e7	 movzx	 edx, BYTE PTR _cX$155877[ebp]
  0016a	52		 push	 edx
  0016b	8b 45 0c	 mov	 eax, DWORD PTR _iMonMapNumber$[ebp]
  0016e	50		 push	 eax
  0016f	57		 push	 edi
  00170	8b 4d e0	 mov	 ecx, DWORD PTR tv420[ebp]
  00173	51		 push	 ecx
  00174	68 00 00 00 00	 push	 OFFSET ??_C@_0GN@ELAOECBK@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
  00179	6a 00		 push	 0
  0017b	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 489  : 
; 490  : 				return FALSE;

  00180	6a fe		 push	 -2			; fffffffeH
  00182	9b		 fwait
  00183	8d 55 f0	 lea	 edx, DWORD PTR __$SEHRec$[ebp+8]
  00186	52		 push	 edx
  00187	68 00 00 00 00	 push	 OFFSET ___security_cookie
  0018c	e8 00 00 00 00	 call	 __local_unwind4
  00191	83 c4 28	 add	 esp, 40			; 00000028H
  00194	33 c0		 xor	 eax, eax

; 557  : }

  00196	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  00199	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  001a0	59		 pop	 ecx
  001a1	5f		 pop	 edi
  001a2	5e		 pop	 esi
  001a3	5b		 pop	 ebx
  001a4	8b e5		 mov	 esp, ebp
  001a6	5d		 pop	 ebp
  001a7	c2 10 00	 ret	 16			; 00000010H
$LN3@CreateKali:

; 491  : 			}
; 492  : 		}
; 493  : 
; 494  : 		iMonsterIndex = gObjAddMonster(iMonMapNumber);

  001aa	8b 45 0c	 mov	 eax, DWORD PTR _iMonMapNumber$[ebp]
  001ad	50		 push	 eax
  001ae	e8 00 00 00 00	 call	 ?gObjAddMonster@@YAFH@Z	; gObjAddMonster
  001b3	83 c4 04	 add	 esp, 4
  001b6	0f bf f8	 movsx	 edi, ax

; 495  : 
; 496  : 		if ( iMonsterIndex >= 0 )

  001b9	85 ff		 test	 edi, edi
  001bb	0f 88 98 01 00
	00		 js	 $LN2@CreateKali

; 497  : 		{
; 498  : 			MONSTER_ATTRIBUTE * lpMATTR = gMAttr.GetAttr(iMonsterType);

  001c1	56		 push	 esi
  001c2	b9 00 00 00 00	 mov	 ecx, OFFSET ?gMAttr@@3VCMonsterAttr@@A ; gMAttr
  001c7	e8 00 00 00 00	 call	 ?GetAttr@CMonsterAttr@@QAEPAUMONSTER_ATTRIBUTE@@H@Z ; CMonsterAttr::GetAttr
  001cc	89 45 14	 mov	 DWORD PTR _lpMATTR$155884[ebp], eax

; 499  : 
; 500  : 			if ( !lpMATTR )

  001cf	85 c0		 test	 eax, eax
  001d1	75 45		 jne	 SHORT $LN1@CreateKali

; 501  : 			{
; 502  : 				gObjDel(iMonsterIndex);

  001d3	57		 push	 edi
  001d4	e8 00 00 00 00	 call	 ?gObjDel@@YAFH@Z	; gObjDel

; 503  : 
; 504  : 				LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Kalima Gate Vanished (NextMap) - lpMATTR == NULL (SummonIndex:%d)",
; 505  : 					gObj[iIndex].AccountID, gObj[iIndex].Name, iMonsterIndex);

  001d9	57		 push	 edi
  001da	8b 4d dc	 mov	 ecx, DWORD PTR tv419[ebp]
  001dd	51		 push	 ecx
  001de	8b 55 e0	 mov	 edx, DWORD PTR tv420[ebp]
  001e1	52		 push	 edx
  001e2	68 00 00 00 00	 push	 OFFSET ??_C@_0FE@DCIHOCIF@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
  001e7	6a 00		 push	 0
  001e9	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 506  : 
; 507  : 				return FALSE;

  001ee	6a fe		 push	 -2			; fffffffeH
  001f0	9b		 fwait
  001f1	8d 45 f0	 lea	 eax, DWORD PTR __$SEHRec$[ebp+8]
  001f4	50		 push	 eax
  001f5	68 00 00 00 00	 push	 OFFSET ___security_cookie
  001fa	e8 00 00 00 00	 call	 __local_unwind4
  001ff	83 c4 24	 add	 esp, 36			; 00000024H
  00202	33 c0		 xor	 eax, eax

; 557  : }

  00204	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  00207	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  0020e	59		 pop	 ecx
  0020f	5f		 pop	 edi
  00210	5e		 pop	 esi
  00211	5b		 pop	 ebx
  00212	8b e5		 mov	 esp, ebp
  00214	5d		 pop	 ebp
  00215	c2 10 00	 ret	 16			; 00000010H
$LN1@CreateKali:

; 508  : 			}
; 509  : 
; 510  : 			gObjSetMonster(iMonsterIndex, iMonsterType);

  00218	56		 push	 esi
  00219	57		 push	 edi
  0021a	e8 00 00 00 00	 call	 ?gObjSetMonster@@YAHHH@Z ; gObjSetMonster
  0021f	83 c4 08	 add	 esp, 8

; 511  : 			gObj[iMonsterIndex].Live = TRUE;

  00222	8b f7		 mov	 esi, edi
  00224	69 f6 64 15 00
	00		 imul	 esi, 5476		; 00001564H
  0022a	c6 86 62 00 00
	00 01		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+98], 1

; 512  : 			gObj[iMonsterIndex].Life = 1000.0;

  00231	d9 05 00 00 00
	00		 fld	 DWORD PTR __real@447a0000
  00237	d9 96 bc 00 00
	00		 fst	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+188]

; 513  : 			gObj[iMonsterIndex].MaxLife = 1000.0;

  0023d	d9 9e c0 00 00
	00		 fstp	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+192]

; 514  : 			gObj[iMonsterIndex].m_PosNum = -1;

  00243	83 c9 ff	 or	 ecx, -1
  00246	66 89 8e 10 02
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+528], cx

; 515  : 			gObj[iMonsterIndex].X = cX;

  0024d	8a 55 e7	 mov	 dl, BYTE PTR _cX$155877[ebp]
  00250	0f b6 c2	 movzx	 eax, dl
  00253	66 89 86 04 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+260], ax

; 516  : 			gObj[iMonsterIndex].Y = cY;

  0025a	0f b6 4d 13	 movzx	 ecx, BYTE PTR _cY$155878[ebp]
  0025e	66 89 8e 06 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+262], cx

; 517  : 			gObj[iMonsterIndex].MTX = cX;

  00265	66 89 86 24 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+292], ax

; 518  : 			gObj[iMonsterIndex].MTY = cY;

  0026c	66 89 8e 26 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+294], cx

; 519  : 			gObj[iMonsterIndex].TX = cX;

  00273	66 89 86 20 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+288], ax

; 520  : 			gObj[iMonsterIndex].TY = cY;

  0027a	66 89 8e 22 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+290], cx

; 521  : 			gObj[iMonsterIndex].m_OldX = cX;

  00281	66 89 86 1c 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+284], ax

; 522  : 			gObj[iMonsterIndex].m_OldY = cY;

  00288	66 89 8e 1e 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+286], cx

; 523  : 			gObj[iMonsterIndex].StartX = cX;

  0028f	88 96 1a 01 00
	00		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+282], dl

; 524  : 			gObj[iMonsterIndex].StartY = cY;

  00295	0f b6 55 13	 movzx	 edx, BYTE PTR _cY$155878[ebp]
  00299	88 96 1b 01 00
	00		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+283], dl

; 525  : 			gObj[iMonsterIndex].MapNumber = iMonMapNumber;

  0029f	8a 45 0c	 mov	 al, BYTE PTR _iMonMapNumber$[ebp]
  002a2	88 86 09 01 00
	00		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+265], al

; 526  : 			gObj[iMonsterIndex].m_MoveRange = 0;

  002a8	33 c9		 xor	 ecx, ecx
  002aa	66 89 8e 1e 03
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+798], cx

; 527  : 			gObj[iMonsterIndex].m_cKalimaGateEnterCount = 0;

  002b1	88 8e 34 02 00
	00		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564], cl

; 528  : 
; 529  : 			gObj[iIndex].m_cKalimaGateExist = TRUE;

  002b7	c6 83 2c 02 00
	00 01		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ebx+556], 1

; 530  : 			gObj[iIndex].m_iKalimaGateIndex = iMonsterIndex;

  002be	89 bb 30 02 00
	00		 mov	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ebx+560], edi

; 531  : 
; 532  : 			gObj[iMonsterIndex].Level = lpMATTR->m_Level;

  002c4	8b 55 14	 mov	 edx, DWORD PTR _lpMATTR$155884[ebp]
  002c7	66 8b 42 1c	 mov	 ax, WORD PTR [edx+28]
  002cb	66 89 86 9c 00
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+156], ax

; 533  : 			gObj[iMonsterIndex].Type = OBJ_MONSTER;

  002d2	b9 02 00 00 00	 mov	 ecx, 2
  002d7	66 89 8e 60 00
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+96], cx

; 534  : 			gObj[iMonsterIndex].MaxRegenTime = 1000;

  002de	c7 86 0c 02 00
	00 e8 03 00 00	 mov	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+524], 1000 ; 000003e8H

; 535  : 			gObj[iMonsterIndex].Dir = 1;

  002e8	c6 86 08 01 00
	00 01		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+264], 1

; 536  : 
; 537  : 			gObj[iMonsterIndex].m_RecallMon = iIndex;

  002ef	8b 5d 08	 mov	 ebx, DWORD PTR _iIndex$[ebp]
  002f2	89 9e cc 02 00
	00		 mov	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+716], ebx

; 538  : 			gObj[iMonsterIndex].RegenTime = GetTickCount();

  002f8	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  002fe	89 86 08 02 00
	00		 mov	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+520], eax

; 539  : 			gObj[iMonsterIndex].m_Attribute = 58;

  00304	ba 3a 00 00 00	 mov	 edx, 58			; 0000003aH
  00309	66 89 96 26 03
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+806], dx

; 540  : 			gObj[iMonsterIndex].DieRegen = FALSE;

  00310	c6 86 02 02 00
	00 00		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+514], 0

; 541  : 			
; 542  : 			LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Create Kalima Gate Successfuly (NextMap) (Live:%d, GateTick:%u, DieRegen:%d, Map:%d, X:%d, Y:%d, SummonIndex:%d, OwnerIndex:%d)",
; 543  : 				gObj[iIndex].AccountID, gObj[iIndex].Name, gObj[iMonsterIndex].Live, gObj[iMonsterIndex].RegenTime,
; 544  : 				gObj[iMonsterIndex].DieRegen, gObj[iMonsterIndex].MapNumber, gObj[iMonsterIndex].X,
; 545  : 				gObj[iMonsterIndex].Y, iMonsterIndex, iIndex);

  00317	53		 push	 ebx
  00318	57		 push	 edi
  00319	0f bf 86 06 01
	00 00		 movsx	 eax, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+262]
  00320	50		 push	 eax
  00321	0f bf 8e 04 01
	00 00		 movsx	 ecx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+260]
  00328	51		 push	 ecx
  00329	0f b6 96 09 01
	00 00		 movzx	 edx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+265]
  00330	52		 push	 edx
  00331	6a 00		 push	 0
  00333	8b 86 08 02 00
	00		 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+520]
  00339	50		 push	 eax
  0033a	0f b6 8e 62 00
	00 00		 movzx	 ecx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+98]
  00341	51		 push	 ecx
  00342	8b 55 dc	 mov	 edx, DWORD PTR tv419[ebp]
  00345	52		 push	 edx
  00346	8b 45 e0	 mov	 eax, DWORD PTR tv420[ebp]
  00349	50		 push	 eax
  0034a	68 00 00 00 00	 push	 OFFSET ??_C@_0JC@FDOJEAMO@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Create?5Kalima?5@
  0034f	6a 00		 push	 0
  00351	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd
  00356	83 c4 30	 add	 esp, 48			; 00000030H
$LN2@CreateKali:

; 546  : 			bKalimaGateCreateSucceed = TRUE;
; 547  : 
; 548  : 
; 549  : 		}
; 550  : 	}
; 551  : 	__finally

  00359	9b		 fwait
  0035a	c7 45 fc fe ff
	ff ff		 mov	 DWORD PTR __$SEHRec$[ebp+20], -2 ; fffffffeH
  00361	e8 52 00 00 00	 call	 $LN15@CreateKali
$LN16@CreateKali:

; 554  : 	}
; 555  : 
; 556  : 	return TRUE;

  00366	b8 01 00 00 00	 mov	 eax, 1

; 557  : }

  0036b	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  0036e	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00375	59		 pop	 ecx
  00376	5f		 pop	 edi
  00377	5e		 pop	 esi
  00378	5b		 pop	 ebx
  00379	8b e5		 mov	 esp, ebp
  0037b	5d		 pop	 ebp
  0037c	c2 10 00	 ret	 16			; 00000010H
$LN6@CreateKali:

; 461  : 		{
; 462  : 			LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Failed to Summon Kalima Gate (NextMap) - MapNumber Error : %d",
; 463  : 				gObj[iIndex].AccountID, gObj[iIndex].Name, iMonMapNumber);

  0037f	51		 push	 ecx
  00380	57		 push	 edi
  00381	56		 push	 esi
  00382	68 00 00 00 00	 push	 OFFSET ??_C@_0FA@KLLHPHHL@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
  00387	6a 00		 push	 0
  00389	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 464  : 
; 465  : 			return FALSE;

  0038e	6a fe		 push	 -2			; fffffffeH
  00390	9b		 fwait
  00391	8d 4d f0	 lea	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  00394	51		 push	 ecx
  00395	68 00 00 00 00	 push	 OFFSET ___security_cookie
  0039a	e8 00 00 00 00	 call	 __local_unwind4
  0039f	83 c4 20	 add	 esp, 32			; 00000020H
  003a2	33 c0		 xor	 eax, eax

; 557  : }

  003a4	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  003a7	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  003ae	59		 pop	 ecx
  003af	5f		 pop	 edi
  003b0	5e		 pop	 esi
  003b1	5b		 pop	 ebx
  003b2	8b e5		 mov	 esp, ebp
  003b4	5d		 pop	 ebp
  003b5	c2 10 00	 ret	 16			; 00000010H
$LN13@CreateKali:
$LN19@CreateKali:
$LN15@CreateKali:

; 552  : 	{
; 553  : 		LeaveCriticalSection(&this->m_critKalimaGate);

  003b8	8b 55 d8	 mov	 edx, DWORD PTR _this$[ebp]
  003bb	83 c2 04	 add	 edx, 4
  003be	52		 push	 edx
  003bf	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4
$LN14@CreateKali:
$LN18@CreateKali:
  003c5	c3		 ret	 0
?CreateKalimaGate2@CKalimaGate@@QAEHHHEE@Z ENDP		; CKalimaGate::CreateKalimaGate2
_TEXT	ENDS
PUBLIC	??_C@_0GN@EGMLLHID@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Tra@ ; `string'
PUBLIC	??_C@_0DG@DFEBENJO@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5mov@ ; `string'
PUBLIC	??_C@_0FM@NAJNPHPN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ ; `string'
PUBLIC	??_C@_0FK@FFJOIHJB@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ ; `string'
PUBLIC	??_C@_0FM@NCEGFJNE@?$FLKalima?$FN?5Kalima?5Gate?5Vanished?5?$CIN@ ; `string'
PUBLIC	?KalimaGateAct2@CKalimaGate@@QAEXH@Z		; CKalimaGate::KalimaGateAct2
EXTRN	?gObjMoveGate@@YAHHH@Z:PROC			; gObjMoveGate
;	COMDAT ??_C@_0GN@EGMLLHID@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Tra@
CONST	SEGMENT
??_C@_0GN@EGMLLHID@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Tra@ DB '['
	DB	'Kalima] [%s][%s] - [%s][%s] Transported by Kalima Gate (NextM'
	DB	'ap) (SummonIndex:%d, GateNo.:%d, MapNumber:%d)', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0DG@DFEBENJO@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5mov@
CONST	SEGMENT
??_C@_0DG@DFEBENJO@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5mov@ DB '['
	DB	'Kalima] [%s][%s] - [%s][%s] move fail (MapNumber:%d)', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0FM@NAJNPHPN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
CONST	SEGMENT
??_C@_0FM@NAJNPHPN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ DB '['
	DB	'Kalima] [%s][%s] Kalima Gate Vanished (NextMap) - Time Out (S'
	DB	'ummonIndex:%d, EnterCount:%d)', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0FK@FFJOIHJB@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
CONST	SEGMENT
??_C@_0FK@FFJOIHJB@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ DB '['
	DB	'Kalima] [%s][%s] Kalima Gate Vanished - Enter Count Over (Sum'
	DB	'monIndex:%d, EnterCount:%d)', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0FM@NCEGFJNE@?$FLKalima?$FN?5Kalima?5Gate?5Vanished?5?$CIN@
CONST	SEGMENT
??_C@_0FM@NCEGFJNE@?$FLKalima?$FN?5Kalima?5Gate?5Vanished?5?$CIN@ DB '[Ka'
	DB	'lima] Kalima Gate Vanished (NextMap) - Summoner Vanished (Sum'
	DB	'monIndex:%d, EnterCount:%d)', 00H		; `string'
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ?KalimaGateAct2@CKalimaGate@@QAEXH@Z
_TEXT	SEGMENT
_iMoveMapLevel$155917 = -12				; size = 4
_i$155906 = -8						; size = 4
tv517 = -4						; size = 4
_this$ = -4						; size = 4
_iIndex$ = 8						; size = 4
?KalimaGateAct2@CKalimaGate@@QAEXH@Z PROC		; CKalimaGate::KalimaGateAct2, COMDAT
; _this$ = ecx

; 563  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH
  00006	57		 push	 edi

; 564  : 	LPOBJ lpObj = NULL;
; 565  : 	LPOBJ lpObjCallOwner = NULL;
; 566  : 
; 567  : 	if ( OBJMAX_RANGE(iIndex) == FALSE )

  00007	8b 7d 08	 mov	 edi, DWORD PTR _iIndex$[ebp]
  0000a	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx
  0000d	85 ff		 test	 edi, edi
  0000f	0f 88 9d 02 00
	00		 js	 $LN27@KalimaGate
  00015	33 c0		 xor	 eax, eax
  00017	81 ff e7 1c 00
	00		 cmp	 edi, 7399		; 00001ce7H
  0001d	0f 9e c0	 setle	 al
  00020	85 c0		 test	 eax, eax
  00022	0f 84 8a 02 00
	00		 je	 $LN27@KalimaGate

; 568  : 		return;
; 569  : 
; 570  : 	if ( gObj[iIndex].Live == 0 )

  00028	56		 push	 esi
  00029	8b f7		 mov	 esi, edi
  0002b	69 f6 64 15 00
	00		 imul	 esi, 5476		; 00001564H
  00031	80 be 62 00 00
	00 00		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+98], 0
  00038	0f 84 73 02 00
	00		 je	 $LN33@KalimaGate

; 571  : 		return;
; 572  : 
; 573  : 	if ( !gObjIsConnected(gObj[iIndex].m_RecallMon ) )

  0003e	8b 86 cc 02 00
	00		 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+716]
  00044	50		 push	 eax
  00045	e8 00 00 00 00	 call	 ?gObjIsConnected@@YAHH@Z ; gObjIsConnected
  0004a	83 c4 04	 add	 esp, 4
  0004d	85 c0		 test	 eax, eax
  0004f	75 3c		 jne	 SHORT $LN19@KalimaGate

; 574  : 	{
; 575  : 		LogAdd(LOG_BLACK, "[Kalima] Kalima Gate Vanished (NextMap) - Summoner Vanished (SummonIndex:%d, EnterCount:%d)",
; 576  : 			iIndex, gObj[iIndex].m_cKalimaGateEnterCount);

  00051	0f be 8e 34 02
	00 00		 movsx	 ecx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564]
  00058	51		 push	 ecx
  00059	57		 push	 edi
  0005a	68 00 00 00 00	 push	 OFFSET ??_C@_0FM@NCEGFJNE@?$FLKalima?$FN?5Kalima?5Gate?5Vanished?5?$CIN@
  0005f	50		 push	 eax
  00060	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 577  : 
; 578  : 		GCDiePlayerSend(&gObj[iIndex], iIndex, 0, 0);

  00065	6a 00		 push	 0
  00067	6a 00		 push	 0
  00069	8d 96 00 00 00
	00		 lea	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi]
  0006f	57		 push	 edi
  00070	52		 push	 edx
  00071	e8 00 00 00 00	 call	 ?GCDiePlayerSend@@YAXPAUOBJECTSTRUCT@@HEH@Z ; GCDiePlayerSend

; 579  : 		gObjDel(iIndex);

  00076	57		 push	 edi
  00077	e8 00 00 00 00	 call	 ?gObjDel@@YAFH@Z	; gObjDel

; 580  : 		gObjCharZeroSet(iIndex);

  0007c	57		 push	 edi
  0007d	e8 00 00 00 00	 call	 ?gObjCharZeroSet@@YAXH@Z ; gObjCharZeroSet
  00082	83 c4 28	 add	 esp, 40			; 00000028H
  00085	5e		 pop	 esi
  00086	5f		 pop	 edi

; 660  : 										break;
; 661  : 								}
; 662  : 							}
; 663  : 						}
; 664  : 					}
; 665  : 				}
; 666  : 			}
; 667  : 		}
; 668  : 	}
; 669  : }

  00087	8b e5		 mov	 esp, ebp
  00089	5d		 pop	 ebp
  0008a	c2 04 00	 ret	 4
$LN19@KalimaGate:
  0008d	53		 push	 ebx

; 581  : 
; 582  : 		return;
; 583  : 	}
; 584  : 
; 585  : 	lpObj = &gObj[iIndex];
; 586  : 	lpObjCallOwner = &gObj[lpObj->m_RecallMon];

  0008e	8b 9e cc 02 00
	00		 mov	 ebx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+716]
  00094	69 db 64 15 00
	00		 imul	 ebx, 5476		; 00001564H
  0009a	81 c3 00 00 00
	00		 add	 ebx, OFFSET ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj

; 587  : 
; 588  : 	if ( gObj[iIndex].m_cKalimaGateEnterCount >= MAX_KALIMA_ENTER )

  000a0	80 be 34 02 00
	00 05		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564], 5
  000a7	7c 41		 jl	 SHORT $LN18@KalimaGate

; 589  : 	{
; 590  : 		lpObjCallOwner->AccountID[MAX_ACCOUNT_LEN]=0;

  000a9	c6 43 6e 00	 mov	 BYTE PTR [ebx+110], 0

; 591  : 		lpObjCallOwner->Name[MAX_ACCOUNT_LEN]=0;

  000ad	c6 43 79 00	 mov	 BYTE PTR [ebx+121], 0

; 592  : 
; 593  : 		LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Kalima Gate Vanished - Enter Count Over (SummonIndex:%d, EnterCount:%d)",
; 594  : 			lpObjCallOwner->AccountID, lpObjCallOwner->Name, iIndex, gObj[iIndex].m_cKalimaGateEnterCount);

  000b1	0f be 86 34 02
	00 00		 movsx	 eax, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564]
  000b8	50		 push	 eax
  000b9	57		 push	 edi
  000ba	8d 4b 6f	 lea	 ecx, DWORD PTR [ebx+111]
  000bd	51		 push	 ecx
  000be	83 c3 64	 add	 ebx, 100		; 00000064H
  000c1	53		 push	 ebx
  000c2	68 00 00 00 00	 push	 OFFSET ??_C@_0FK@FFJOIHJB@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
  000c7	6a 00		 push	 0
  000c9	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 595  : 
; 596  : 		this->DeleteKalimaGate(iIndex, gObj[iIndex].m_RecallMon);

  000ce	8b 96 cc 02 00
	00		 mov	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+716]
  000d4	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  000d7	83 c4 18	 add	 esp, 24			; 00000018H
  000da	52		 push	 edx
  000db	57		 push	 edi
  000dc	e8 00 00 00 00	 call	 ?DeleteKalimaGate@CKalimaGate@@QAEHHH@Z ; CKalimaGate::DeleteKalimaGate
  000e1	5b		 pop	 ebx
  000e2	5e		 pop	 esi
  000e3	5f		 pop	 edi

; 660  : 										break;
; 661  : 								}
; 662  : 							}
; 663  : 						}
; 664  : 					}
; 665  : 				}
; 666  : 			}
; 667  : 		}
; 668  : 	}
; 669  : }

  000e4	8b e5		 mov	 esp, ebp
  000e6	5d		 pop	 ebp
  000e7	c2 04 00	 ret	 4
$LN18@KalimaGate:

; 597  : 
; 598  : 		return;
; 599  : 	}
; 600  : 
; 601  : 	DWORD dwTickCount = GetTickCount();

  000ea	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0

; 602  : 
; 603  : 	if ( dwTickCount > (lpObj->RegenTime+60000) )

  000f0	8b 8e 08 02 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+520]
  000f6	81 c1 60 ea 00
	00		 add	 ecx, 60000		; 0000ea60H
  000fc	3b c1		 cmp	 eax, ecx
  000fe	76 43		 jbe	 SHORT $LN17@KalimaGate

; 604  : 	{
; 605  : 		lpObjCallOwner->AccountID[MAX_ACCOUNT_LEN]=0;

  00100	c6 43 6e 00	 mov	 BYTE PTR [ebx+110], 0

; 606  : 		lpObjCallOwner->Name[MAX_ACCOUNT_LEN]=0;

  00104	c6 43 79 00	 mov	 BYTE PTR [ebx+121], 0

; 607  : 
; 608  : 		LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Kalima Gate Vanished (NextMap) - Time Out (SummonIndex:%d, EnterCount:%d)",
; 609  : 			lpObjCallOwner->AccountID, lpObjCallOwner->Name, iIndex, gObj[iIndex].m_cKalimaGateEnterCount);

  00108	0f be 96 34 02
	00 00		 movsx	 edx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564]
  0010f	52		 push	 edx
  00110	57		 push	 edi
  00111	8d 43 6f	 lea	 eax, DWORD PTR [ebx+111]
  00114	50		 push	 eax
  00115	8d 4b 64	 lea	 ecx, DWORD PTR [ebx+100]
  00118	51		 push	 ecx
  00119	68 00 00 00 00	 push	 OFFSET ??_C@_0FM@NAJNPHPN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
  0011e	6a 00		 push	 0
  00120	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 610  : 
; 611  : 		this->DeleteKalimaGate(lpObj->m_Index, lpObjCallOwner->m_Index);

  00125	8b 13		 mov	 edx, DWORD PTR [ebx]
  00127	8b 86 00 00 00
	00		 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi]
  0012d	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00130	83 c4 18	 add	 esp, 24			; 00000018H
  00133	52		 push	 edx
  00134	50		 push	 eax
  00135	e8 00 00 00 00	 call	 ?DeleteKalimaGate@CKalimaGate@@QAEHHH@Z ; CKalimaGate::DeleteKalimaGate
  0013a	5b		 pop	 ebx
  0013b	5e		 pop	 esi
  0013c	5f		 pop	 edi

; 660  : 										break;
; 661  : 								}
; 662  : 							}
; 663  : 						}
; 664  : 					}
; 665  : 				}
; 666  : 			}
; 667  : 		}
; 668  : 	}
; 669  : }

  0013d	8b e5		 mov	 esp, ebp
  0013f	5d		 pop	 ebp
  00140	c2 04 00	 ret	 4
$LN17@KalimaGate:

; 612  : 
; 613  : 		return;
; 614  : 	}
; 615  : 
; 616  : 	if ( lpObj->VPCount < 1 )

  00143	83 be 98 0a 00
	00 01		 cmp	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+2712], 1
  0014a	0f 8c 60 01 00
	00		 jl	 $LN34@KalimaGate

; 617  : 		return;
; 618  : 
; 619  : 	if ( lpObj->MapNumber < MAP_INDEX_KALIMA1 || lpObj->MapNumber > MAP_INDEX_KALIMA6-1 )

  00150	8a 86 09 01 00
	00		 mov	 al, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+265]
  00156	3c 18		 cmp	 al, 24			; 00000018H
  00158	0f 82 52 01 00
	00		 jb	 $LN34@KalimaGate
  0015e	3c 1c		 cmp	 al, 28			; 0000001cH
  00160	0f 87 4a 01 00
	00		 ja	 $LN34@KalimaGate

; 620  : 		return;
; 621  : 
; 622  : 	int tObjNum = -1;
; 623  : 
; 624  : 	for ( int i=0;i<MAX_VIEWPORT_MONSTER;i++)

  00166	8d 8e 92 03 00
	00		 lea	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+914]
  0016c	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _i$155906[ebp], 0
  00173	89 4d fc	 mov	 DWORD PTR tv517[ebp], ecx
$LL32@KalimaGate:

; 625  : 	{
; 626  : 		tObjNum = lpObj->VpPlayer[i].number;

  00176	8b 55 fc	 mov	 edx, DWORD PTR tv517[ebp]
  00179	0f bf 0a	 movsx	 ecx, WORD PTR [edx]

; 627  : 
; 628  : 		if ( tObjNum >= 0 )

  0017c	85 c9		 test	 ecx, ecx
  0017e	0f 88 18 01 00
	00		 js	 $LN12@KalimaGate

; 629  : 		{
; 630  : 			if ( gObj[tObjNum].Type == OBJ_USER )

  00184	8b f9		 mov	 edi, ecx
  00186	69 ff 64 15 00
	00		 imul	 edi, 5476		; 00001564H
  0018c	66 83 bf 60 00
	00 00 01	 cmp	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+96], 1
  00194	0f 85 02 01 00
	00		 jne	 $LN12@KalimaGate

; 631  : 			{
; 632  : 				if ( gObj[tObjNum].Live )

  0019a	80 bf 62 00 00
	00 00		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+98], 0
  001a1	0f 84 f5 00 00
	00		 je	 $LN12@KalimaGate

; 633  : 				{
; 634  : 					if ( abs(lpObj->Y - gObj[tObjNum].Y) < 2 )

  001a7	0f bf 97 06 01
	00 00		 movsx	 edx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+262]
  001ae	0f bf 86 06 01
	00 00		 movsx	 eax, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+262]
  001b5	2b c2		 sub	 eax, edx
  001b7	99		 cdq
  001b8	33 c2		 xor	 eax, edx
  001ba	2b c2		 sub	 eax, edx
  001bc	83 f8 02	 cmp	 eax, 2
  001bf	0f 8d d7 00 00
	00		 jge	 $LN12@KalimaGate

; 635  : 					{
; 636  : 						if ( abs(lpObj->X - gObj[tObjNum].X) < 2 )

  001c5	0f bf 97 04 01
	00 00		 movsx	 edx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+260]
  001cc	0f bf 86 04 01
	00 00		 movsx	 eax, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+260]
  001d3	2b c2		 sub	 eax, edx
  001d5	99		 cdq
  001d6	33 c2		 xor	 eax, edx
  001d8	2b c2		 sub	 eax, edx
  001da	83 f8 02	 cmp	 eax, 2
  001dd	0f 8d b9 00 00
	00		 jge	 $LN12@KalimaGate

; 637  : 						{
; 638  : 							if ( lpObj->m_RecallMon == tObjNum || (gObj[tObjNum].PartyNumber != -1 && lpObjCallOwner->PartyNumber == gObj[tObjNum].PartyNumber ))

  001e3	39 8e cc 02 00
	00		 cmp	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+716], ecx
  001e9	74 1b		 je	 SHORT $LN4@KalimaGate
  001eb	8b 87 a8 02 00
	00		 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+680]
  001f1	83 f8 ff	 cmp	 eax, -1
  001f4	0f 84 a2 00 00
	00		 je	 $LN12@KalimaGate
  001fa	39 83 a8 02 00
	00		 cmp	 DWORD PTR [ebx+680], eax
  00200	0f 85 96 00 00
	00		 jne	 $LN12@KalimaGate
$LN4@KalimaGate:

; 639  : 							{
; 640  : 								int iMoveMapLevel = lpObj->MapNumber - MAP_INDEX_KALIMA1+1;	// #error "Deatwway - remove the -1

  00206	0f b6 86 09 01
	00 00		 movzx	 eax, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+265]
  0020d	83 e8 17	 sub	 eax, 23			; 00000017H
  00210	89 45 f4	 mov	 DWORD PTR _iMoveMapLevel$155917[ebp], eax

; 641  : 								int iGateNumber = g_iKalimaGateGateIndex[iMoveMapLevel];

  00213	8b 04 85 00 00
	00 00		 mov	 eax, DWORD PTR _g_iKalimaGateGateIndex[eax*4]

; 642  : 
; 643  : 								if ( !gObjMoveGate(tObjNum, iGateNumber))

  0021a	50		 push	 eax
  0021b	51		 push	 ecx
  0021c	e8 00 00 00 00	 call	 ?gObjMoveGate@@YAHHH@Z	; gObjMoveGate
  00221	83 c4 08	 add	 esp, 8
  00224	85 c0		 test	 eax, eax
  00226	75 2f		 jne	 SHORT $LN3@KalimaGate

; 644  : 								{
; 645  : 									LogAdd(LOG_BLACK, "[Kalima] [%s][%s] - [%s][%s] move fail (MapNumber:%d)",
; 646  : 										lpObjCallOwner->AccountID, lpObjCallOwner->Name,
; 647  : 										gObj[tObjNum].AccountID, gObj[tObjNum].Name,
; 648  : 										lpObj->MapNumber);

  00228	0f b6 86 09 01
	00 00		 movzx	 eax, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+265]
  0022f	50		 push	 eax
  00230	8d 8f 6f 00 00
	00		 lea	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+111]
  00236	51		 push	 ecx
  00237	8d 97 64 00 00
	00		 lea	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+100]
  0023d	52		 push	 edx
  0023e	8d 43 6f	 lea	 eax, DWORD PTR [ebx+111]
  00241	50		 push	 eax
  00242	8d 4b 64	 lea	 ecx, DWORD PTR [ebx+100]
  00245	51		 push	 ecx
  00246	68 00 00 00 00	 push	 OFFSET ??_C@_0DG@DFEBENJO@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5mov@
  0024b	6a 00		 push	 0
  0024d	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd
  00252	83 c4 1c	 add	 esp, 28			; 0000001cH

; 649  : 								}
; 650  : 								else

  00255	eb 45		 jmp	 SHORT $LN12@KalimaGate
$LN3@KalimaGate:

; 651  : 								{
; 652  : 									LogAdd(LOG_BLACK, "[Kalima] [%s][%s] - [%s][%s] Transported by Kalima Gate (NextMap) (SummonIndex:%d, GateNo.:%d, MapNumber:%d)",
; 653  : 										lpObjCallOwner->AccountID, lpObjCallOwner->Name,
; 654  : 										gObj[tObjNum].AccountID, gObj[tObjNum].Name,
; 655  : 										iIndex, iMoveMapLevel+1, lpObj->MapNumber);

  00257	0f b6 96 09 01
	00 00		 movzx	 edx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+265]
  0025e	8b 45 f4	 mov	 eax, DWORD PTR _iMoveMapLevel$155917[ebp]
  00261	8b 4d 08	 mov	 ecx, DWORD PTR _iIndex$[ebp]
  00264	52		 push	 edx
  00265	40		 inc	 eax
  00266	50		 push	 eax
  00267	51		 push	 ecx
  00268	8d 97 6f 00 00
	00		 lea	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+111]
  0026e	52		 push	 edx
  0026f	8d 87 64 00 00
	00		 lea	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+100]
  00275	50		 push	 eax
  00276	8d 4b 6f	 lea	 ecx, DWORD PTR [ebx+111]
  00279	51		 push	 ecx
  0027a	8d 53 64	 lea	 edx, DWORD PTR [ebx+100]
  0027d	52		 push	 edx
  0027e	68 00 00 00 00	 push	 OFFSET ??_C@_0GN@EGMLLHID@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Tra@
  00283	6a 00		 push	 0
  00285	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 656  : 
; 657  : 									gObj[iIndex].m_cKalimaGateEnterCount++;

  0028a	fe 86 34 02 00
	00		 inc	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564]
  00290	83 c4 24	 add	 esp, 36			; 00000024H

; 658  : 
; 659  : 									if ( gObj[iIndex].m_cKalimaGateEnterCount >= MAX_KALIMA_ENTER )

  00293	80 be 34 02 00
	00 05		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564], 5
  0029a	7d 14		 jge	 SHORT $LN34@KalimaGate
$LN12@KalimaGate:

; 620  : 		return;
; 621  : 
; 622  : 	int tObjNum = -1;
; 623  : 
; 624  : 	for ( int i=0;i<MAX_VIEWPORT_MONSTER;i++)

  0029c	8b 45 f8	 mov	 eax, DWORD PTR _i$155906[ebp]
  0029f	83 45 fc 0c	 add	 DWORD PTR tv517[ebp], 12 ; 0000000cH
  002a3	40		 inc	 eax
  002a4	89 45 f8	 mov	 DWORD PTR _i$155906[ebp], eax
  002a7	83 f8 14	 cmp	 eax, 20			; 00000014H
  002aa	0f 8c c6 fe ff
	ff		 jl	 $LL32@KalimaGate
$LN34@KalimaGate:
  002b0	5b		 pop	 ebx
$LN33@KalimaGate:
  002b1	5e		 pop	 esi
$LN27@KalimaGate:
  002b2	5f		 pop	 edi

; 660  : 										break;
; 661  : 								}
; 662  : 							}
; 663  : 						}
; 664  : 					}
; 665  : 				}
; 666  : 			}
; 667  : 		}
; 668  : 	}
; 669  : }

  002b3	8b e5		 mov	 esp, ebp
  002b5	5d		 pop	 ebp
  002b6	c2 04 00	 ret	 4
?KalimaGateAct2@CKalimaGate@@QAEXH@Z ENDP		; CKalimaGate::KalimaGateAct2
_TEXT	ENDS
PUBLIC	?GetKalimaGateLevel2@CKalimaGate@@QAEHH@Z	; CKalimaGate::GetKalimaGateLevel2
; Function compile flags: /Ogtp
;	COMDAT ?GetKalimaGateLevel2@CKalimaGate@@QAEHH@Z
_TEXT	SEGMENT
_iIndex$ = 8						; size = 4
?GetKalimaGateLevel2@CKalimaGate@@QAEHH@Z PROC		; CKalimaGate::GetKalimaGateLevel2, COMDAT
; _this$ = ecx

; 675  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 676  : 	if ( gObj[iIndex].Class == CLASS_MAGUMSA || gObj[iIndex].Class == CLASS_DARKLORD )	// DarkLord and MagicGLadiaro

  00003	8b 4d 08	 mov	 ecx, DWORD PTR _iIndex$[ebp]
  00006	69 c9 64 15 00
	00		 imul	 ecx, 5476		; 00001564H
  0000c	0f b7 81 98 00
	00 00		 movzx	 eax, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ecx+152]
  00013	83 f8 03	 cmp	 eax, 3
  00016	74 34		 je	 SHORT $LN12@GetKalimaG@2
  00018	83 f8 04	 cmp	 eax, 4
  0001b	74 2f		 je	 SHORT $LN12@GetKalimaG@2

; 683  : 				{
; 684  : 					return i;
; 685  : 				}
; 686  : 			}
; 687  : 		}
; 688  : 	}
; 689  : 	else
; 690  : 	{
; 691  : 		for ( int i =0;i<KALIMA_FLOORS;i++)

  0001d	0f bf 91 9c 00
	00 00		 movsx	 edx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ecx+156]
  00024	33 c0		 xor	 eax, eax
  00026	b9 04 00 00 00	 mov	 ecx, OFFSET _g_sttKALIMAGATE_LEVEL+4
  0002b	eb 03 8d 49 00	 npad	 5
$LL5@GetKalimaG@2:

; 692  : 		{
; 693  : 			if ( gObj[iIndex].Level >= g_sttKALIMAGATE_LEVEL[i].iLOWER_BOUND )

  00030	3b 51 fc	 cmp	 edx, DWORD PTR [ecx-4]
  00033	7c 04		 jl	 SHORT $LN4@GetKalimaG@2

; 694  : 			{
; 695  : 				if ( gObj[iIndex].Level <= g_sttKALIMAGATE_LEVEL[i].iUPPER_BOUND )

  00035	3b 11		 cmp	 edx, DWORD PTR [ecx]
  00037	7e 3f		 jle	 SHORT $LN14@GetKalimaG@2
$LN4@GetKalimaG@2:

; 683  : 				{
; 684  : 					return i;
; 685  : 				}
; 686  : 			}
; 687  : 		}
; 688  : 	}
; 689  : 	else
; 690  : 	{
; 691  : 		for ( int i =0;i<KALIMA_FLOORS;i++)

  00039	83 c1 10	 add	 ecx, 16			; 00000010H
  0003c	40		 inc	 eax
  0003d	81 f9 74 00 00
	00		 cmp	 ecx, OFFSET _g_sttKALIMAGATE_LEVEL+116
  00043	7c eb		 jl	 SHORT $LL5@GetKalimaG@2

; 696  : 				{
; 697  : 					return i;
; 698  : 				}
; 699  : 			}
; 700  : 		}
; 701  : 	}
; 702  : 	return -1;

  00045	83 c8 ff	 or	 eax, -1

; 703  : }

  00048	5d		 pop	 ebp
  00049	c2 04 00	 ret	 4
$LN12@GetKalimaG@2:

; 677  : 	{
; 678  : 		for ( int i =0;i<KALIMA_FLOORS;i++)

  0004c	0f bf 91 9c 00
	00 00		 movsx	 edx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ecx+156]
  00053	33 c0		 xor	 eax, eax
  00055	b9 0c 00 00 00	 mov	 ecx, OFFSET _g_sttKALIMAGATE_LEVEL+12
  0005a	8d 9b 00 00 00
	00		 npad	 6
$LL11@GetKalimaG@2:

; 679  : 		{
; 680  : 			if ( gObj[iIndex].Level >= g_sttKALIMAGATE_LEVEL[i].iLOWER_BOUND_MAGUMSA )

  00060	3b 51 fc	 cmp	 edx, DWORD PTR [ecx-4]
  00063	7c 04		 jl	 SHORT $LN10@GetKalimaG@2

; 681  : 			{
; 682  : 				if ( gObj[iIndex].Level <= g_sttKALIMAGATE_LEVEL[i].iUPPER_BOUND_MAGUMSA )

  00065	3b 11		 cmp	 edx, DWORD PTR [ecx]
  00067	7e 0f		 jle	 SHORT $LN14@GetKalimaG@2
$LN10@GetKalimaG@2:

; 677  : 	{
; 678  : 		for ( int i =0;i<KALIMA_FLOORS;i++)

  00069	83 c1 10	 add	 ecx, 16			; 00000010H
  0006c	40		 inc	 eax
  0006d	81 f9 7c 00 00
	00		 cmp	 ecx, OFFSET _g_sttKALIMAGATE_LEVEL+124
  00073	7c eb		 jl	 SHORT $LL11@GetKalimaG@2

; 696  : 				{
; 697  : 					return i;
; 698  : 				}
; 699  : 			}
; 700  : 		}
; 701  : 	}
; 702  : 	return -1;

  00075	83 c8 ff	 or	 eax, -1
$LN14@GetKalimaG@2:

; 703  : }

  00078	5d		 pop	 ebp
  00079	c2 04 00	 ret	 4
?GetKalimaGateLevel2@CKalimaGate@@QAEHH@Z ENDP		; CKalimaGate::GetKalimaGateLevel2
_TEXT	ENDS
EXTRN	??3@YAXPAX@Z:PROC				; operator delete
; Function compile flags: /Ogtp
;	COMDAT ??_GCKalimaGate@@UAEPAXI@Z
_TEXT	SEGMENT
___flags$ = 8						; size = 4
??_GCKalimaGate@@UAEPAXI@Z PROC				; CKalimaGate::`scalar deleting destructor', COMDAT
; _this$ = ecx
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	8b f1		 mov	 esi, ecx
  00006	e8 00 00 00 00	 call	 ??1CKalimaGate@@UAE@XZ	; CKalimaGate::~CKalimaGate
  0000b	f6 45 08 01	 test	 BYTE PTR ___flags$[ebp], 1
  0000f	74 09		 je	 SHORT $LN4@scalar
  00011	56		 push	 esi
  00012	e8 00 00 00 00	 call	 ??3@YAXPAX@Z		; operator delete
  00017	83 c4 04	 add	 esp, 4
$LN4@scalar:
  0001a	8b c6		 mov	 eax, esi
  0001c	5e		 pop	 esi
  0001d	5d		 pop	 ebp
  0001e	c2 04 00	 ret	 4
??_GCKalimaGate@@UAEPAXI@Z ENDP				; CKalimaGate::`scalar deleting destructor'
_TEXT	ENDS
PUBLIC	??_C@_0JE@GBKKIBCM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Create?5Kalima?5@ ; `string'
PUBLIC	??_C@_0EK@OMOPGPDM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ ; `string'
PUBLIC	??_C@_0FM@OJLJJEMN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ ; `string'
PUBLIC	??_C@_0GD@BNDCCFJF@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ ; `string'
PUBLIC	??_C@_0FE@NNCGKIKM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ ; `string'
PUBLIC	??_C@_0FM@IGFLMFGN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ ; `string'
PUBLIC	??_C@_0EN@GPHOBJAE@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ ; `string'
PUBLIC	??_C@_0CM@PDFGAPNC@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Try?5to?5Create?5@ ; `string'
PUBLIC	?CreateKalimaGate@CKalimaGate@@QAEHHEEE@Z	; CKalimaGate::CreateKalimaGate
;	COMDAT ??_C@_0JE@GBKKIBCM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Create?5Kalima?5@
CONST	SEGMENT
??_C@_0JE@GBKKIBCM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Create?5Kalima?5@ DB '['
	DB	'Kalima] [%s][%s] Create Kalima Gate Successfuly (Live:%d, Gat'
	DB	'eTick:%u, DieRegen:%d, Map:%d, X:%d, Y:%d, SummonIndex:%d, Ow'
	DB	'nerIndex:%d, GateNo.:%d)', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EK@OMOPGPDM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
CONST	SEGMENT
??_C@_0EK@OMOPGPDM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ DB '['
	DB	'Kalima] [%s][%s] Kalima Gate Vanished - lpMATTR == NULL (Summ'
	DB	'onIndex:%d)', 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_0FM@OJLJJEMN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
CONST	SEGMENT
??_C@_0FM@OJLJJEMN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ DB '['
	DB	'Kalima] [%s][%s] Failed to Summon Kalima Gate - Uable to Summ'
	DB	'on in this Map (MapNumber:%d)', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0GD@BNDCCFJF@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
CONST	SEGMENT
??_C@_0GD@BNDCCFJF@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ DB '['
	DB	'Kalima] [%s][%s] Failed to Summon Kalima Gate - Failed to get'
	DB	' Location (MapNumber:%d, X:%d, Y:%d)', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0FE@NNCGKIKM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
CONST	SEGMENT
??_C@_0FE@NNCGKIKM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ DB '['
	DB	'Kalima] [%s][%s] Failed to Summon Kalima Gate - Already Have '
	DB	'Gate (SummonIndex:%d)', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0FM@IGFLMFGN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
CONST	SEGMENT
??_C@_0FM@IGFLMFGN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ DB '['
	DB	'Kalima] [%s][%s] Failed to Summon Kalima Gate - Called in Saf'
	DB	'tey Area (Map:%d, X:%d, Y:%d)', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0EN@GPHOBJAE@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
CONST	SEGMENT
??_C@_0EN@GPHOBJAE@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@ DB '['
	DB	'Kalima] [%s][%s] Failed to Summon Kalima Gate - Gate Level Ch'
	DB	'eck Error : %d', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0CM@PDFGAPNC@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Try?5to?5Create?5@
CONST	SEGMENT
??_C@_0CM@PDFGAPNC@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Try?5to?5Create?5@ DB '['
	DB	'Kalima] [%s][%s] Try to Create Kalima Gate', 00H ; `string'
CONST	ENDS
;	COMDAT xdata$x
xdata$x	SEGMENT
__sehtable$?CreateKalimaGate@CKalimaGate@@QAEHHEEE@Z DD 0fffffffeH
	DD	00H
	DD	0ffffffc0H
	DD	00H
	DD	0fffffffeH
	DD	00H
	DD	FLAT:$LN26@CreateKali@2
; Function compile flags: /Ogtp
xdata$x	ENDS
;	COMDAT ?CreateKalimaGate@CKalimaGate@@QAEHHEEE@Z
_TEXT	SEGMENT
tv583 = -48						; size = 4
tv611 = -44						; size = 4
_this$ = -40						; size = 4
_iMapNumber$155726 = -36				; size = 4
tv579 = -32						; size = 4
tv580 = -28						; size = 4
__$SEHRec$ = -24					; size = 24
_iIndex$ = 8						; size = 4
_btLevel$ = 12						; size = 1
_cY$155730 = 15						; size = 1
_cTX$ = 16						; size = 1
_cX$155729 = 19						; size = 1
_lpMATTR$155749 = 20					; size = 4
_cTY$ = 20						; size = 1
?CreateKalimaGate@CKalimaGate@@QAEHHEEE@Z PROC		; CKalimaGate::CreateKalimaGate, COMDAT
; _this$ = ecx

; 29   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	6a fe		 push	 -2			; fffffffeH
  00005	68 00 00 00 00	 push	 OFFSET __sehtable$?CreateKalimaGate@CKalimaGate@@QAEHHEEE@Z
  0000a	68 00 00 00 00	 push	 OFFSET __except_handler4
  0000f	64 a1 00 00 00
	00		 mov	 eax, DWORD PTR fs:0
  00015	50		 push	 eax
  00016	83 ec 20	 sub	 esp, 32			; 00000020H
  00019	53		 push	 ebx
  0001a	56		 push	 esi
  0001b	57		 push	 edi
  0001c	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  00021	31 45 f8	 xor	 DWORD PTR __$SEHRec$[ebp+16], eax
  00024	33 c5		 xor	 eax, ebp
  00026	50		 push	 eax
  00027	8d 45 f0	 lea	 eax, DWORD PTR __$SEHRec$[ebp+8]
  0002a	64 a3 00 00 00
	00		 mov	 DWORD PTR fs:0, eax
  00030	89 4d d8	 mov	 DWORD PTR _this$[ebp], ecx

; 30   : 	BOOL bKalimaGateCreateSucceed=FALSE;
; 31   : 	int iMonsterIndex=-1;
; 32   : 
; 33   : 	
; 34   : 	EnterCriticalSection(&this->m_critKalimaGate );

  00033	83 c1 04	 add	 ecx, 4
  00036	51		 push	 ecx
  00037	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__EnterCriticalSection@4

; 35   : 	
; 36   : 	__try

  0003d	9b		 fwait
  0003e	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR __$SEHRec$[ebp+20], 0

; 37   : 	{
; 38   : 		int iKalimaGateLevel;
; 39   : 		int iMapNumber;
; 40   : 		BYTE btMapAttr;
; 41   : 		int iMonsterType;
; 42   : 		BYTE cX;
; 43   : 		BYTE cY;
; 44   : 
; 45   : 		
; 46   : 		if ( gObjIsConnected(iIndex) == PLAYER_EMPTY )

  00045	8b 5d 08	 mov	 ebx, DWORD PTR _iIndex$[ebp]
  00048	53		 push	 ebx
  00049	e8 00 00 00 00	 call	 ?gObjIsConnected@@YAHH@Z ; gObjIsConnected
  0004e	83 c4 04	 add	 esp, 4
  00051	85 c0		 test	 eax, eax
  00053	75 2a		 jne	 SHORT $LN13@CreateKali@2

; 47   : 		{
; 48   : 			return false;

  00055	6a fe		 push	 -2			; fffffffeH
  00057	9b		 fwait
  00058	8d 45 f0	 lea	 eax, DWORD PTR __$SEHRec$[ebp+8]
  0005b	50		 push	 eax
  0005c	68 00 00 00 00	 push	 OFFSET ___security_cookie
  00061	e8 00 00 00 00	 call	 __local_unwind4
  00066	83 c4 0c	 add	 esp, 12			; 0000000cH
  00069	33 c0		 xor	 eax, eax

; 185  : }

  0006b	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  0006e	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00075	59		 pop	 ecx
  00076	5f		 pop	 edi
  00077	5e		 pop	 esi
  00078	5b		 pop	 ebx
  00079	8b e5		 mov	 esp, ebp
  0007b	5d		 pop	 ebp
  0007c	c2 10 00	 ret	 16			; 00000010H
$LN13@CreateKali@2:

; 49   : 		}
; 50   : 
; 51   : 		LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Try to Create Kalima Gate", gObj[iIndex].AccountID, gObj[iIndex].Name);

  0007f	8b fb		 mov	 edi, ebx
  00081	69 ff 64 15 00
	00		 imul	 edi, 5476		; 00001564H
  00087	8d b7 6f 00 00
	00		 lea	 esi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+111]
  0008d	89 75 e0	 mov	 DWORD PTR tv579[ebp], esi
  00090	8d 87 64 00 00
	00		 lea	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+100]
  00096	89 45 e4	 mov	 DWORD PTR tv580[ebp], eax
  00099	56		 push	 esi
  0009a	50		 push	 eax
  0009b	68 00 00 00 00	 push	 OFFSET ??_C@_0CM@PDFGAPNC@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Try?5to?5Create?5@
  000a0	6a 00		 push	 0
  000a2	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd
  000a7	83 c4 10	 add	 esp, 16			; 00000010H

; 52   : 		iKalimaGateLevel = this->GetKalimaGateLevel(iIndex);

  000aa	53		 push	 ebx
  000ab	8b 4d d8	 mov	 ecx, DWORD PTR _this$[ebp]
  000ae	e8 00 00 00 00	 call	 ?GetKalimaGateLevel@CKalimaGate@@AAEHH@Z ; CKalimaGate::GetKalimaGateLevel

; 53   : 
; 54   : 		if ( iKalimaGateLevel < btLevel-1 )

  000b3	0f b6 5d 0c	 movzx	 ebx, BYTE PTR _btLevel$[ebp]
  000b7	4b		 dec	 ebx
  000b8	89 5d d0	 mov	 DWORD PTR tv583[ebp], ebx
  000bb	3b c3		 cmp	 eax, ebx
  000bd	7d 2a		 jge	 SHORT $LN12@CreateKali@2

; 55   : 		{
; 56   : 			return false;

  000bf	6a fe		 push	 -2			; fffffffeH
  000c1	9b		 fwait
  000c2	8d 4d f0	 lea	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  000c5	51		 push	 ecx
  000c6	68 00 00 00 00	 push	 OFFSET ___security_cookie
  000cb	e8 00 00 00 00	 call	 __local_unwind4
  000d0	83 c4 0c	 add	 esp, 12			; 0000000cH
  000d3	33 c0		 xor	 eax, eax

; 185  : }

  000d5	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  000d8	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  000df	59		 pop	 ecx
  000e0	5f		 pop	 edi
  000e1	5e		 pop	 esi
  000e2	5b		 pop	 ebx
  000e3	8b e5		 mov	 esp, ebp
  000e5	5d		 pop	 ebp
  000e6	c2 10 00	 ret	 16			; 00000010H
$LN12@CreateKali@2:

; 57   : 		}
; 58   : 
; 59   : 		iKalimaGateLevel = btLevel-1;
; 60   : 
; 61   : 		if (  DS_MAP_RANGE(gObj[iIndex].MapNumber) )

  000e9	8a 87 09 01 00
	00		 mov	 al, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+265]
  000ef	3c 09		 cmp	 al, 9
  000f1	74 0b		 je	 SHORT $LN30@CreateKali@2
  000f3	33 c9		 xor	 ecx, ecx
  000f5	3c 20		 cmp	 al, 32			; 00000020H
  000f7	0f 94 c1	 sete	 cl
  000fa	85 c9		 test	 ecx, ecx
  000fc	74 2a		 je	 SHORT $LN11@CreateKali@2
$LN30@CreateKali@2:

; 62   : 		{
; 63   : 			return false;

  000fe	6a fe		 push	 -2			; fffffffeH
  00100	9b		 fwait
  00101	8d 55 f0	 lea	 edx, DWORD PTR __$SEHRec$[ebp+8]
  00104	52		 push	 edx
  00105	68 00 00 00 00	 push	 OFFSET ___security_cookie
  0010a	e8 00 00 00 00	 call	 __local_unwind4
  0010f	83 c4 0c	 add	 esp, 12			; 0000000cH
  00112	33 c0		 xor	 eax, eax

; 185  : }

  00114	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  00117	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  0011e	59		 pop	 ecx
  0011f	5f		 pop	 edi
  00120	5e		 pop	 esi
  00121	5b		 pop	 ebx
  00122	8b e5		 mov	 esp, ebp
  00124	5d		 pop	 ebp
  00125	c2 10 00	 ret	 16			; 00000010H
$LN11@CreateKali@2:

; 64   : 		}
; 65   : 
; 66   : 		if ( BC_MAP_RANGE(gObj[iIndex].MapNumber) )

  00128	3c 0b		 cmp	 al, 11			; 0000000bH
  0012a	72 0c		 jb	 SHORT $LN10@CreateKali@2
  0012c	b9 11 00 00 00	 mov	 ecx, 17			; 00000011H
  00131	3a c8		 cmp	 cl, al
  00133	1b c9		 sbb	 ecx, ecx
  00135	41		 inc	 ecx

; 67   : 		{
; 68   : 			return false;

  00136	75 c6		 jne	 SHORT $LN30@CreateKali@2
$LN10@CreateKali@2:

; 69   : 		}
; 70   : 
; 71   : 		if ( CC_MAP_RANGE(gObj[iIndex].MapNumber) )

  00138	3c 12		 cmp	 al, 18			; 00000012H
  0013a	72 0c		 jb	 SHORT $LN9@CreateKali@2
  0013c	b9 17 00 00 00	 mov	 ecx, 23			; 00000017H
  00141	3a c8		 cmp	 cl, al
  00143	1b c9		 sbb	 ecx, ecx
  00145	41		 inc	 ecx

; 72   : 		{
; 73   : 			return false;

  00146	75 b6		 jne	 SHORT $LN30@CreateKali@2
$LN9@CreateKali@2:

; 74   : 		}
; 75   : 
; 76   : 		if ( KALIMA_FLOOR_RANGE(iKalimaGateLevel)== FALSE )

  00148	85 db		 test	 ebx, ebx
  0014a	78 0c		 js	 SHORT $LN31@CreateKali@2
  0014c	33 c9		 xor	 ecx, ecx
  0014e	83 fb 06	 cmp	 ebx, 6
  00151	0f 9e c1	 setle	 cl
  00154	85 c9		 test	 ecx, ecx
  00156	75 3d		 jne	 SHORT $LN8@CreateKali@2
$LN31@CreateKali@2:

; 77   : 		{
; 78   : 			LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Failed to Summon Kalima Gate - Gate Level Check Error : %d",
; 79   : 				gObj[iIndex].AccountID, gObj[iIndex].Name, iKalimaGateLevel+1);

  00158	43		 inc	 ebx
  00159	53		 push	 ebx
  0015a	56		 push	 esi
  0015b	8b 45 e4	 mov	 eax, DWORD PTR tv580[ebp]
  0015e	50		 push	 eax
  0015f	68 00 00 00 00	 push	 OFFSET ??_C@_0EN@GPHOBJAE@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
  00164	6a 00		 push	 0
  00166	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 80   : 			return false;

  0016b	6a fe		 push	 -2			; fffffffeH
  0016d	9b		 fwait
  0016e	8d 4d f0	 lea	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  00171	51		 push	 ecx
  00172	68 00 00 00 00	 push	 OFFSET ___security_cookie
  00177	e8 00 00 00 00	 call	 __local_unwind4
  0017c	83 c4 20	 add	 esp, 32			; 00000020H
  0017f	33 c0		 xor	 eax, eax

; 185  : }

  00181	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  00184	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  0018b	59		 pop	 ecx
  0018c	5f		 pop	 edi
  0018d	5e		 pop	 esi
  0018e	5b		 pop	 ebx
  0018f	8b e5		 mov	 esp, ebp
  00191	5d		 pop	 ebp
  00192	c2 10 00	 ret	 16			; 00000010H
$LN8@CreateKali@2:

; 81   : 		}
; 82   : 
; 83   : 		iMapNumber = gObj[iIndex].MapNumber;

  00195	0f b6 c0	 movzx	 eax, al
  00198	89 45 dc	 mov	 DWORD PTR _iMapNumber$155726[ebp], eax

; 84   : 
; 85   : 		btMapAttr = MapC[iMapNumber].GetAttr(gObj[iIndex].X, gObj[iIndex].Y);

  0019b	69 c0 08 07 05
	00		 imul	 eax, 329480		; 00050708H
  001a1	8d 88 00 00 00
	00		 lea	 ecx, DWORD PTR ?MapC@@3PAVMapClass@@A[eax]
  001a7	89 4d d4	 mov	 DWORD PTR tv611[ebp], ecx
  001aa	0f bf 97 06 01
	00 00		 movsx	 edx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+262]
  001b1	52		 push	 edx
  001b2	0f bf 87 04 01
	00 00		 movsx	 eax, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+260]
  001b9	50		 push	 eax
  001ba	e8 00 00 00 00	 call	 ?GetAttr@MapClass@@QAEEHH@Z ; MapClass::GetAttr

; 86   : 
; 87   : 		if ( btMapAttr &1 != 0 )

  001bf	a8 01		 test	 al, 1
  001c1	74 53		 je	 SHORT $LN7@CreateKali@2

; 88   : 		{
; 89   : 			LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Failed to Summon Kalima Gate - Called in Saftey Area (Map:%d, X:%d, Y:%d)",
; 90   : 				gObj[iIndex].AccountID, gObj[iIndex].Name, gObj[iIndex].MapNumber,
; 91   : 				gObj[iIndex].X, gObj[iIndex].Y);

  001c3	0f bf 8f 06 01
	00 00		 movsx	 ecx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+262]
  001ca	51		 push	 ecx
  001cb	0f bf 97 04 01
	00 00		 movsx	 edx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+260]
  001d2	52		 push	 edx
  001d3	0f b6 87 09 01
	00 00		 movzx	 eax, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+265]
  001da	50		 push	 eax
  001db	56		 push	 esi
  001dc	8b 4d e4	 mov	 ecx, DWORD PTR tv580[ebp]
  001df	51		 push	 ecx
  001e0	68 00 00 00 00	 push	 OFFSET ??_C@_0FM@IGFLMFGN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
$LN35@CreateKali@2:
  001e5	6a 00		 push	 0
  001e7	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 92   : 			return false;

  001ec	6a fe		 push	 -2			; fffffffeH
  001ee	9b		 fwait
  001ef	8d 55 f0	 lea	 edx, DWORD PTR __$SEHRec$[ebp+8]
  001f2	52		 push	 edx
  001f3	68 00 00 00 00	 push	 OFFSET ___security_cookie
  001f8	e8 00 00 00 00	 call	 __local_unwind4
  001fd	83 c4 28	 add	 esp, 40			; 00000028H
$LN36@CreateKali@2:
  00200	33 c0		 xor	 eax, eax

; 185  : }

  00202	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  00205	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  0020c	59		 pop	 ecx
  0020d	5f		 pop	 edi
  0020e	5e		 pop	 esi
  0020f	5b		 pop	 ebx
  00210	8b e5		 mov	 esp, ebp
  00212	5d		 pop	 ebp
  00213	c2 10 00	 ret	 16			; 00000010H
$LN7@CreateKali@2:

; 93   : 		}
; 94   : 
; 95   : 		if ( gObj[iIndex].m_cKalimaGateExist == TRUE )

  00216	80 bf 2c 02 00
	00 01		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+556], 1
  0021d	75 5d		 jne	 SHORT $LN6@CreateKali@2

; 96   : 		{
; 97   : 			GCServerMsgStringSend(lMsg.Get( MSGGET( 4, 224)), iIndex, 1);

  0021f	6a 01		 push	 1
  00221	8b 45 08	 mov	 eax, DWORD PTR _iIndex$[ebp]
  00224	50		 push	 eax
  00225	68 e0 04 00 00	 push	 1248			; 000004e0H
  0022a	b9 00 00 00 00	 mov	 ecx, OFFSET ?lMsg@@3VCMsg@@A ; lMsg
  0022f	e8 00 00 00 00	 call	 ?Get@CMsg@@QAEPADH@Z	; CMsg::Get
  00234	50		 push	 eax
  00235	e8 00 00 00 00	 call	 ?GCServerMsgStringSend@@YAXPADHE@Z ; GCServerMsgStringSend

; 98   : 			LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Failed to Summon Kalima Gate - Already Have Gate (SummonIndex:%d)",
; 99   : 				gObj[iIndex].AccountID, gObj[iIndex].Name, gObj[iIndex].m_iKalimaGateIndex);

  0023a	8b 8f 30 02 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+560]
  00240	51		 push	 ecx
  00241	56		 push	 esi
  00242	8b 55 e4	 mov	 edx, DWORD PTR tv580[ebp]
  00245	52		 push	 edx
  00246	68 00 00 00 00	 push	 OFFSET ??_C@_0FE@NNCGKIKM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
  0024b	6a 00		 push	 0
  0024d	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 100  : 			return false;

  00252	6a fe		 push	 -2			; fffffffeH
  00254	9b		 fwait
  00255	8d 45 f0	 lea	 eax, DWORD PTR __$SEHRec$[ebp+8]
  00258	50		 push	 eax
  00259	68 00 00 00 00	 push	 OFFSET ___security_cookie
  0025e	e8 00 00 00 00	 call	 __local_unwind4
  00263	83 c4 2c	 add	 esp, 44			; 0000002cH
  00266	33 c0		 xor	 eax, eax

; 185  : }

  00268	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  0026b	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  00272	59		 pop	 ecx
  00273	5f		 pop	 edi
  00274	5e		 pop	 esi
  00275	5b		 pop	 ebx
  00276	8b e5		 mov	 esp, ebp
  00278	5d		 pop	 ebp
  00279	c2 10 00	 ret	 16			; 00000010H
$LN6@CreateKali@2:

; 101  : 		}
; 102  : 
; 103  : 		iMonsterType = iKalimaGateLevel+152;

  0027c	8d b3 98 00 00
	00		 lea	 esi, DWORD PTR [ebx+152]

; 104  : 		cX = cTX;

  00282	8a 45 10	 mov	 al, BYTE PTR _cTX$[ebp]
  00285	88 45 13	 mov	 BYTE PTR _cX$155729[ebp], al

; 105  : 		cY = cTY;

  00288	8a 4d 14	 mov	 cl, BYTE PTR _cTY$[ebp]
  0028b	88 4d 0f	 mov	 BYTE PTR _cY$155730[ebp], cl

; 106  : 
; 107  : 		btMapAttr = MapC[iMapNumber].GetAttr(cX, cY);

  0028e	0f b6 c9	 movzx	 ecx, cl
  00291	51		 push	 ecx
  00292	0f b6 d0	 movzx	 edx, al
  00295	52		 push	 edx
  00296	8b 4d d4	 mov	 ecx, DWORD PTR tv611[ebp]
  00299	e8 00 00 00 00	 call	 ?GetAttr@MapClass@@QAEEHH@Z ; MapClass::GetAttr

; 108  : 
; 109  : 		if ( btMapAttr != 0 )

  0029e	84 c0		 test	 al, al
  002a0	74 3c		 je	 SHORT $LN4@CreateKali@2

; 110  : 		{
; 111  : 			if (this->GetRandomLocation(iMapNumber, cX, cY) == 0)

  002a2	8d 45 0f	 lea	 eax, DWORD PTR _cY$155730[ebp]
  002a5	50		 push	 eax
  002a6	8d 4d 13	 lea	 ecx, DWORD PTR _cX$155729[ebp]
  002a9	51		 push	 ecx
  002aa	8b 55 dc	 mov	 edx, DWORD PTR _iMapNumber$155726[ebp]
  002ad	52		 push	 edx
  002ae	8b 4d d8	 mov	 ecx, DWORD PTR _this$[ebp]
  002b1	e8 00 00 00 00	 call	 ?GetRandomLocation@CKalimaGate@@AAEHHAAE0@Z ; CKalimaGate::GetRandomLocation
  002b6	85 c0		 test	 eax, eax
  002b8	75 24		 jne	 SHORT $LN4@CreateKali@2

; 112  : 			{
; 113  : 			LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Failed to Summon Kalima Gate - Failed to get Location (MapNumber:%d, X:%d, Y:%d)",
; 114  : 				gObj[iIndex].AccountID, gObj[iIndex].Name, gObj[iIndex].MapNumber, cX, cY);

  002ba	0f b6 45 0f	 movzx	 eax, BYTE PTR _cY$155730[ebp]
  002be	50		 push	 eax
  002bf	0f b6 4d 13	 movzx	 ecx, BYTE PTR _cX$155729[ebp]
  002c3	51		 push	 ecx
  002c4	0f b6 97 09 01
	00 00		 movzx	 edx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+265]
  002cb	52		 push	 edx
  002cc	8b 45 e0	 mov	 eax, DWORD PTR tv579[ebp]
  002cf	50		 push	 eax
  002d0	8b 4d e4	 mov	 ecx, DWORD PTR tv580[ebp]
  002d3	51		 push	 ecx
  002d4	68 00 00 00 00	 push	 OFFSET ??_C@_0GD@BNDCCFJF@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@

; 115  : 			return false;

  002d9	e9 07 ff ff ff	 jmp	 $LN35@CreateKali@2
$LN4@CreateKali@2:

; 116  : 			}
; 117  : 		}
; 118  : 
; 119  : 		if ( gObj[iIndex].MapNumber == 10 )

  002de	80 bf 09 01 00
	00 0a		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+265], 10 ; 0000000aH
  002e5	75 2f		 jne	 SHORT $LN3@CreateKali@2

; 120  : 		{
; 121  : 			LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Failed to Summon Kalima Gate - Uable to Summon in this Map (MapNumber:%d)",
; 122  : 				gObj[iIndex].AccountID, gObj[iIndex].Name, gObj[iIndex].MapNumber);

  002e7	6a 0a		 push	 10			; 0000000aH
  002e9	8b 45 e0	 mov	 eax, DWORD PTR tv579[ebp]
  002ec	50		 push	 eax
  002ed	8b 4d e4	 mov	 ecx, DWORD PTR tv580[ebp]
  002f0	51		 push	 ecx
  002f1	68 00 00 00 00	 push	 OFFSET ??_C@_0FM@OJLJJEMN@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Failed?5to?5Summ@
  002f6	6a 00		 push	 0
  002f8	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 123  : 			return false;

  002fd	6a fe		 push	 -2			; fffffffeH
  002ff	9b		 fwait
  00300	8d 55 f0	 lea	 edx, DWORD PTR __$SEHRec$[ebp+8]
  00303	52		 push	 edx
  00304	68 00 00 00 00	 push	 OFFSET ___security_cookie
  00309	e8 00 00 00 00	 call	 __local_unwind4
  0030e	83 c4 20	 add	 esp, 32			; 00000020H
  00311	e9 ea fe ff ff	 jmp	 $LN36@CreateKali@2
$LN3@CreateKali@2:

; 124  : 		}
; 125  : 
; 126  : 		iMonsterIndex = gObjAddMonster(iMapNumber);

  00316	8b 45 dc	 mov	 eax, DWORD PTR _iMapNumber$155726[ebp]
  00319	50		 push	 eax
  0031a	e8 00 00 00 00	 call	 ?gObjAddMonster@@YAFH@Z	; gObjAddMonster
  0031f	83 c4 04	 add	 esp, 4
  00322	0f bf d8	 movsx	 ebx, ax

; 127  : 
; 128  : 		if ( iMonsterIndex >= 0 )

  00325	85 db		 test	 ebx, ebx
  00327	0f 88 8a 01 00
	00		 js	 $LN2@CreateKali@2

; 129  : 		{
; 130  : 			LPMONSTER_ATTRIBUTE lpMATTR = gMAttr.GetAttr(iMonsterType);

  0032d	56		 push	 esi
  0032e	b9 00 00 00 00	 mov	 ecx, OFFSET ?gMAttr@@3VCMonsterAttr@@A ; gMAttr
  00333	e8 00 00 00 00	 call	 ?GetAttr@CMonsterAttr@@QAEPAUMONSTER_ATTRIBUTE@@H@Z ; CMonsterAttr::GetAttr
  00338	89 45 14	 mov	 DWORD PTR _lpMATTR$155749[ebp], eax

; 131  : 			
; 132  : 			if ( lpMATTR == NULL )

  0033b	85 c0		 test	 eax, eax
  0033d	75 34		 jne	 SHORT $LN1@CreateKali@2

; 133  : 			{
; 134  : 				gObjDel(iMonsterIndex);

  0033f	53		 push	 ebx
  00340	e8 00 00 00 00	 call	 ?gObjDel@@YAFH@Z	; gObjDel

; 135  : 				LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Kalima Gate Vanished - lpMATTR == NULL (SummonIndex:%d)",
; 136  : 					gObj[iIndex].AccountID, gObj[iIndex].Name, iMonsterIndex);

  00345	53		 push	 ebx
  00346	8b 4d e0	 mov	 ecx, DWORD PTR tv579[ebp]
  00349	51		 push	 ecx
  0034a	8b 55 e4	 mov	 edx, DWORD PTR tv580[ebp]
  0034d	52		 push	 edx
  0034e	68 00 00 00 00	 push	 OFFSET ??_C@_0EK@OMOPGPDM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
  00353	6a 00		 push	 0
  00355	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 137  : 				return false;

  0035a	6a fe		 push	 -2			; fffffffeH
  0035c	9b		 fwait
  0035d	8d 45 f0	 lea	 eax, DWORD PTR __$SEHRec$[ebp+8]
  00360	50		 push	 eax
  00361	68 00 00 00 00	 push	 OFFSET ___security_cookie
  00366	e8 00 00 00 00	 call	 __local_unwind4
  0036b	83 c4 24	 add	 esp, 36			; 00000024H
  0036e	e9 8d fe ff ff	 jmp	 $LN36@CreateKali@2
$LN1@CreateKali@2:

; 138  : 			}
; 139  : 
; 140  : 			gObjSetMonster(iMonsterIndex, iMonsterType);

  00373	56		 push	 esi
  00374	53		 push	 ebx
  00375	e8 00 00 00 00	 call	 ?gObjSetMonster@@YAHHH@Z ; gObjSetMonster
  0037a	83 c4 08	 add	 esp, 8

; 141  : 			gObj[iMonsterIndex].Live = TRUE;

  0037d	8b f3		 mov	 esi, ebx
  0037f	69 f6 64 15 00
	00		 imul	 esi, 5476		; 00001564H
  00385	c6 86 62 00 00
	00 01		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+98], 1

; 142  : 			gObj[iMonsterIndex].Life = 1000.0;

  0038c	d9 05 00 00 00
	00		 fld	 DWORD PTR __real@447a0000
  00392	d9 96 bc 00 00
	00		 fst	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+188]

; 143  : 			gObj[iMonsterIndex].MaxLife = 1000.0;

  00398	d9 9e c0 00 00
	00		 fstp	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+192]

; 144  : 			gObj[iMonsterIndex].m_PosNum = -1;

  0039e	83 c9 ff	 or	 ecx, -1
  003a1	66 89 8e 10 02
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+528], cx

; 145  : 			gObj[iMonsterIndex].X = cX;

  003a8	8a 55 13	 mov	 dl, BYTE PTR _cX$155729[ebp]
  003ab	0f b6 c2	 movzx	 eax, dl
  003ae	66 89 86 04 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+260], ax

; 146  : 			gObj[iMonsterIndex].Y = cY;

  003b5	0f b6 4d 0f	 movzx	 ecx, BYTE PTR _cY$155730[ebp]
  003b9	66 89 8e 06 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+262], cx

; 147  : 			gObj[iMonsterIndex].MTX = cX;

  003c0	66 89 86 24 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+292], ax

; 148  : 			gObj[iMonsterIndex].MTY = cY;

  003c7	66 89 8e 26 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+294], cx

; 149  : 			gObj[iMonsterIndex].TX = cX;

  003ce	66 89 86 20 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+288], ax

; 150  : 			gObj[iMonsterIndex].TY = cY;

  003d5	66 89 8e 22 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+290], cx

; 151  : 			gObj[iMonsterIndex].m_OldX = cX;

  003dc	66 89 86 1c 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+284], ax

; 152  : 			gObj[iMonsterIndex].m_OldY = cY;

  003e3	66 89 8e 1e 01
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+286], cx

; 153  : 			gObj[iMonsterIndex].StartX = cX;

  003ea	88 96 1a 01 00
	00		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+282], dl

; 154  : 			gObj[iMonsterIndex].StartY = cY;

  003f0	0f b6 55 0f	 movzx	 edx, BYTE PTR _cY$155730[ebp]
  003f4	88 96 1b 01 00
	00		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+283], dl

; 155  : 			gObj[iMonsterIndex].MapNumber = iMapNumber;

  003fa	8a 45 dc	 mov	 al, BYTE PTR _iMapNumber$155726[ebp]
  003fd	88 86 09 01 00
	00		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+265], al

; 156  : 			gObj[iMonsterIndex].m_MoveRange = 0;

  00403	33 c9		 xor	 ecx, ecx
  00405	66 89 8e 1e 03
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+798], cx

; 157  : 			gObj[iMonsterIndex].m_cKalimaGateEnterCount = 0;

  0040c	88 8e 34 02 00
	00		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564], cl

; 158  : 
; 159  : 			gObj[iIndex].m_cKalimaGateExist = TRUE;

  00412	c6 87 2c 02 00
	00 01		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+556], 1

; 160  : 			gObj[iIndex].m_iKalimaGateIndex = iMonsterIndex;

  00419	89 9f 30 02 00
	00		 mov	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[edi+560], ebx

; 161  : 
; 162  : 			gObj[iMonsterIndex].Level = lpMATTR->m_Level;

  0041f	8b 55 14	 mov	 edx, DWORD PTR _lpMATTR$155749[ebp]
  00422	66 8b 42 1c	 mov	 ax, WORD PTR [edx+28]
  00426	66 89 86 9c 00
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+156], ax

; 163  : 			gObj[iMonsterIndex].Type = OBJ_MONSTER;

  0042d	b9 02 00 00 00	 mov	 ecx, 2
  00432	66 89 8e 60 00
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+96], cx

; 164  : 			gObj[iMonsterIndex].MaxRegenTime = 1000;

  00439	c7 86 0c 02 00
	00 e8 03 00 00	 mov	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+524], 1000 ; 000003e8H

; 165  : 			gObj[iMonsterIndex].Dir = 1;

  00443	c6 86 08 01 00
	00 01		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+264], 1

; 166  : 
; 167  : 			gObj[iMonsterIndex].m_RecallMon = iIndex;

  0044a	8b 7d 08	 mov	 edi, DWORD PTR _iIndex$[ebp]
  0044d	89 be cc 02 00
	00		 mov	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+716], edi

; 168  : 			gObj[iMonsterIndex].RegenTime = GetTickCount();

  00453	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0
  00459	89 86 08 02 00
	00		 mov	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+520], eax

; 169  : 			gObj[iMonsterIndex].m_Attribute = iKalimaGateLevel + 51;

  0045f	8b 45 d0	 mov	 eax, DWORD PTR tv583[ebp]
  00462	8d 50 33	 lea	 edx, DWORD PTR [eax+51]
  00465	66 89 96 26 03
	00 00		 mov	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+806], dx

; 170  : 			gObj[iMonsterIndex].DieRegen = FALSE;

  0046c	c6 86 02 02 00
	00 00		 mov	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+514], 0

; 171  : 			
; 172  : 			LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Create Kalima Gate Successfuly (Live:%d, GateTick:%u, DieRegen:%d, Map:%d, X:%d, Y:%d, SummonIndex:%d, OwnerIndex:%d, GateNo.:%d)",
; 173  : 				gObj[iIndex].AccountID, gObj[iIndex].Name, gObj[iMonsterIndex].Live, gObj[iMonsterIndex].RegenTime,
; 174  : 				gObj[iMonsterIndex].DieRegen, gObj[iMonsterIndex].MapNumber, gObj[iMonsterIndex].X,
; 175  : 				gObj[iMonsterIndex].Y, iMonsterIndex, iIndex, iKalimaGateLevel+1);

  00473	40		 inc	 eax
  00474	50		 push	 eax
  00475	57		 push	 edi
  00476	53		 push	 ebx
  00477	0f bf 86 06 01
	00 00		 movsx	 eax, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+262]
  0047e	50		 push	 eax
  0047f	0f bf 8e 04 01
	00 00		 movsx	 ecx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+260]
  00486	51		 push	 ecx
  00487	0f b6 96 09 01
	00 00		 movzx	 edx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+265]
  0048e	52		 push	 edx
  0048f	6a 00		 push	 0
  00491	8b 86 08 02 00
	00		 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+520]
  00497	50		 push	 eax
  00498	0f b6 8e 62 00
	00 00		 movzx	 ecx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+98]
  0049f	51		 push	 ecx
  004a0	8b 55 e0	 mov	 edx, DWORD PTR tv579[ebp]
  004a3	52		 push	 edx
  004a4	8b 45 e4	 mov	 eax, DWORD PTR tv580[ebp]
  004a7	50		 push	 eax
  004a8	68 00 00 00 00	 push	 OFFSET ??_C@_0JE@GBKKIBCM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Create?5Kalima?5@
  004ad	6a 00		 push	 0
  004af	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd
  004b4	83 c4 34	 add	 esp, 52			; 00000034H
$LN2@CreateKali@2:

; 176  : 			bKalimaGateCreateSucceed = TRUE;
; 177  : 		}
; 178  : 	}
; 179  : 	__finally

  004b7	9b		 fwait
  004b8	c7 45 fc fe ff
	ff ff		 mov	 DWORD PTR __$SEHRec$[ebp+20], -2 ; fffffffeH
  004bf	e8 19 00 00 00	 call	 $LN28@CreateKali@2
$LN29@CreateKali@2:

; 182  : 	}
; 183  : 
; 184  : 	return true;

  004c4	b8 01 00 00 00	 mov	 eax, 1

; 185  : }

  004c9	8b 4d f0	 mov	 ecx, DWORD PTR __$SEHRec$[ebp+8]
  004cc	64 89 0d 00 00
	00 00		 mov	 DWORD PTR fs:0, ecx
  004d3	59		 pop	 ecx
  004d4	5f		 pop	 edi
  004d5	5e		 pop	 esi
  004d6	5b		 pop	 ebx
  004d7	8b e5		 mov	 esp, ebp
  004d9	5d		 pop	 ebp
  004da	c2 10 00	 ret	 16			; 00000010H
$LN26@CreateKali@2:
$LN37@CreateKali@2:
$LN28@CreateKali@2:

; 180  : 	{
; 181  : 		LeaveCriticalSection(&this->m_critKalimaGate);

  004dd	8b 4d d8	 mov	 ecx, DWORD PTR _this$[ebp]
  004e0	83 c1 04	 add	 ecx, 4
  004e3	51		 push	 ecx
  004e4	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__LeaveCriticalSection@4
$LN27@CreateKali@2:
$LN34@CreateKali@2:
  004ea	c3		 ret	 0
?CreateKalimaGate@CKalimaGate@@QAEHHEEE@Z ENDP		; CKalimaGate::CreateKalimaGate
_TEXT	ENDS
PUBLIC	??_C@_0GD@MOAKLAME@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Tra@ ; `string'
PUBLIC	??_C@_0FC@CCIHPNEM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ ; `string'
PUBLIC	??_C@_0FH@INKPFMP@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ ; `string'
PUBLIC	??_C@_0FC@ILNKILMI@?$FLKalima?$FN?5Kalima?5Gate?5Vanished?5?9?5@ ; `string'
PUBLIC	?KalimaGateAct@CKalimaGate@@QAEXH@Z		; CKalimaGate::KalimaGateAct
;	COMDAT ??_C@_0GD@MOAKLAME@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Tra@
CONST	SEGMENT
??_C@_0GD@MOAKLAME@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Tra@ DB '['
	DB	'Kalima] [%s][%s] - [%s][%s] Transported by Kalima Gate (Summo'
	DB	'nIndex:%d, GateNo.:%d, MapNumber:%d)', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0FC@CCIHPNEM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
CONST	SEGMENT
??_C@_0FC@CCIHPNEM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ DB '['
	DB	'Kalima] [%s][%s] Kalima Gate Vanished - Time Out (SummonIndex'
	DB	':%d, EnterCount:%d)', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0FH@INKPFMP@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
CONST	SEGMENT
??_C@_0FH@INKPFMP@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@ DB '['
	DB	'Kalima] [%s][%s] Kalima Gate Vanished - Summoner Died (Summon'
	DB	'Index:%d, EnterCount:%d)', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0FC@ILNKILMI@?$FLKalima?$FN?5Kalima?5Gate?5Vanished?5?9?5@
CONST	SEGMENT
??_C@_0FC@ILNKILMI@?$FLKalima?$FN?5Kalima?5Gate?5Vanished?5?9?5@ DB '[Kal'
	DB	'ima] Kalima Gate Vanished - Summoner Vanished (SummonIndex:%d'
	DB	', EnterCount:%d)', 00H			; `string'
; Function compile flags: /Ogtp
CONST	ENDS
;	COMDAT ?KalimaGateAct@CKalimaGate@@QAEXH@Z
_TEXT	SEGMENT
_i$155772 = -20						; size = 4
tv407 = -16						; size = 4
_iMapNumber$155784 = -12				; size = 4
tv524 = -8						; size = 4
_this$ = -4						; size = 4
_iIndex$ = 8						; size = 4
?KalimaGateAct@CKalimaGate@@QAEXH@Z PROC		; CKalimaGate::KalimaGateAct, COMDAT
; _this$ = ecx

; 189  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 14	 sub	 esp, 20			; 00000014H
  00006	53		 push	 ebx

; 190  : 	LPOBJ lpObj=NULL;
; 191  : 	LPOBJ lpObjCallOwner=NULL;
; 192  : 
; 193  : 	if ( OBJMAX_RANGE(iIndex ) == FALSE)

  00007	8b 5d 08	 mov	 ebx, DWORD PTR _iIndex$[ebp]
  0000a	89 4d fc	 mov	 DWORD PTR _this$[ebp], ecx
  0000d	85 db		 test	 ebx, ebx
  0000f	0f 88 d0 02 00
	00		 js	 $LN27@KalimaGate@2
  00015	33 c0		 xor	 eax, eax
  00017	81 fb e7 1c 00
	00		 cmp	 ebx, 7399		; 00001ce7H
  0001d	0f 9e c0	 setle	 al
  00020	85 c0		 test	 eax, eax
  00022	0f 84 bd 02 00
	00		 je	 $LN27@KalimaGate@2

; 194  : 	{
; 195  : 		return;
; 196  : 	}
; 197  : 
; 198  : 	if ( gObj[iIndex].Live == FALSE )

  00028	56		 push	 esi
  00029	8b f3		 mov	 esi, ebx
  0002b	69 f6 64 15 00
	00		 imul	 esi, 5476		; 00001564H
  00031	80 be 62 00 00
	00 00		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+98], 0
  00038	0f 84 a6 02 00
	00		 je	 $LN32@KalimaGate@2

; 199  : 	{
; 200  : 		return;
; 201  : 	}
; 202  : 
; 203  : 	if ( gObjIsConnected( gObj[iIndex].m_RecallMon ) == PLAYER_EMPTY )

  0003e	8b 86 cc 02 00
	00		 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+716]
  00044	50		 push	 eax
  00045	e8 00 00 00 00	 call	 ?gObjIsConnected@@YAHH@Z ; gObjIsConnected
  0004a	83 c4 04	 add	 esp, 4
  0004d	85 c0		 test	 eax, eax
  0004f	75 3c		 jne	 SHORT $LN19@KalimaGate@2

; 204  : 	{
; 205  : 		LogAdd(LOG_BLACK, "[Kalima] Kalima Gate Vanished - Summoner Vanished (SummonIndex:%d, EnterCount:%d)",
; 206  : 			iIndex, gObj[iIndex].m_cKalimaGateEnterCount );

  00051	0f be 8e 34 02
	00 00		 movsx	 ecx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564]
  00058	51		 push	 ecx
  00059	53		 push	 ebx
  0005a	68 00 00 00 00	 push	 OFFSET ??_C@_0FC@ILNKILMI@?$FLKalima?$FN?5Kalima?5Gate?5Vanished?5?9?5@
  0005f	50		 push	 eax
  00060	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 207  : 		GCDiePlayerSend( &gObj[iIndex], iIndex, 0, 0);

  00065	6a 00		 push	 0
  00067	6a 00		 push	 0
  00069	8d 96 00 00 00
	00		 lea	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi]
  0006f	53		 push	 ebx
  00070	52		 push	 edx
  00071	e8 00 00 00 00	 call	 ?GCDiePlayerSend@@YAXPAUOBJECTSTRUCT@@HEH@Z ; GCDiePlayerSend

; 208  : 		gObjDel(iIndex);

  00076	53		 push	 ebx
  00077	e8 00 00 00 00	 call	 ?gObjDel@@YAFH@Z	; gObjDel

; 209  : 		gObjCharZeroSet(iIndex);

  0007c	53		 push	 ebx
  0007d	e8 00 00 00 00	 call	 ?gObjCharZeroSet@@YAXH@Z ; gObjCharZeroSet
  00082	83 c4 28	 add	 esp, 40			; 00000028H
  00085	5e		 pop	 esi
  00086	5b		 pop	 ebx

; 298  : 										{
; 299  : 											return;
; 300  : 										}
; 301  : 									}
; 302  : 								}
; 303  : 							}
; 304  : 						}
; 305  : 					}
; 306  : 				}
; 307  : 			}
; 308  : 		}
; 309  : 	}
; 310  : }

  00087	8b e5		 mov	 esp, ebp
  00089	5d		 pop	 ebp
  0008a	c2 04 00	 ret	 4
$LN19@KalimaGate@2:

; 210  : 		return;
; 211  : 	}
; 212  : 
; 213  : 	lpObj = &gObj[iIndex];
; 214  : 	lpObjCallOwner = &gObj[lpObj->m_RecallMon];
; 215  : 
; 216  : 	if ( gObj[gObj[iIndex].m_RecallMon].DieRegen > 0 )

  0008d	8b 86 cc 02 00
	00		 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+716]
  00093	57		 push	 edi
  00094	69 c0 64 15 00
	00		 imul	 eax, 5476		; 00001564H
  0009a	8b be cc 02 00
	00		 mov	 edi, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+716]
  000a0	69 ff 64 15 00
	00		 imul	 edi, 5476		; 00001564H
  000a6	81 c7 00 00 00
	00		 add	 edi, OFFSET ?gObj@@3PAUOBJECTSTRUCT@@A ; gObj
  000ac	80 b8 02 02 00
	00 00		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[eax+514], 0
  000b3	7e 20		 jle	 SHORT $LN18@KalimaGate@2

; 217  : 	{
; 218  : 		lpObjCallOwner->AccountID[MAX_ACCOUNT_LEN]=0;

  000b5	c6 47 6e 00	 mov	 BYTE PTR [edi+110], 0

; 219  : 		lpObjCallOwner->Name[MAX_ACCOUNT_LEN]=0;

  000b9	c6 47 79 00	 mov	 BYTE PTR [edi+121], 0

; 220  : 
; 221  : 		LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Kalima Gate Vanished - Summoner Died (SummonIndex:%d, EnterCount:%d)",
; 222  : 			lpObjCallOwner->AccountID, lpObjCallOwner->Name,
; 223  : 			iIndex, gObj[iIndex].m_cKalimaGateEnterCount );

  000bd	0f be 8e 34 02
	00 00		 movsx	 ecx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564]
  000c4	51		 push	 ecx
  000c5	53		 push	 ebx
  000c6	8d 57 6f	 lea	 edx, DWORD PTR [edi+111]
  000c9	52		 push	 edx
  000ca	83 c7 64	 add	 edi, 100		; 00000064H
  000cd	57		 push	 edi
  000ce	68 00 00 00 00	 push	 OFFSET ??_C@_0FH@INKPFMP@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@

; 224  : 		this->DeleteKalimaGate(iIndex, gObj[iIndex].m_RecallMon);
; 225  : 		return;

  000d3	eb 27		 jmp	 SHORT $LN34@KalimaGate@2
$LN18@KalimaGate@2:

; 226  : 	}
; 227  : 
; 228  : 	if ( gObj[iIndex].m_cKalimaGateEnterCount >= MAX_KALIMA_ENTER )

  000d5	80 be 34 02 00
	00 05		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564], 5
  000dc	7c 41		 jl	 SHORT $LN17@KalimaGate@2

; 229  : 	{
; 230  : 		lpObjCallOwner->AccountID[MAX_ACCOUNT_LEN]=0;

  000de	c6 47 6e 00	 mov	 BYTE PTR [edi+110], 0

; 231  : 		lpObjCallOwner->Name[MAX_ACCOUNT_LEN]=0;

  000e2	c6 47 79 00	 mov	 BYTE PTR [edi+121], 0

; 232  : 		
; 233  : 		LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Kalima Gate Vanished - Enter Count Over (SummonIndex:%d, EnterCount:%d)",
; 234  : 			lpObjCallOwner->AccountID, lpObjCallOwner->Name,
; 235  : 			iIndex, gObj[iIndex].m_cKalimaGateEnterCount );

  000e6	0f be 8e 34 02
	00 00		 movsx	 ecx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564]
  000ed	51		 push	 ecx
  000ee	53		 push	 ebx
  000ef	8d 57 6f	 lea	 edx, DWORD PTR [edi+111]
  000f2	52		 push	 edx
  000f3	83 c7 64	 add	 edi, 100		; 00000064H
  000f6	57		 push	 edi
  000f7	68 00 00 00 00	 push	 OFFSET ??_C@_0FK@FFJOIHJB@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
$LN34@KalimaGate@2:
  000fc	6a 00		 push	 0
  000fe	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 236  : 		this->DeleteKalimaGate(iIndex, gObj[iIndex].m_RecallMon);

  00103	8b 86 cc 02 00
	00		 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+716]
  00109	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  0010c	83 c4 18	 add	 esp, 24			; 00000018H
  0010f	50		 push	 eax
  00110	53		 push	 ebx
  00111	e8 00 00 00 00	 call	 ?DeleteKalimaGate@CKalimaGate@@QAEHHH@Z ; CKalimaGate::DeleteKalimaGate
  00116	5f		 pop	 edi
  00117	5e		 pop	 esi
  00118	5b		 pop	 ebx

; 298  : 										{
; 299  : 											return;
; 300  : 										}
; 301  : 									}
; 302  : 								}
; 303  : 							}
; 304  : 						}
; 305  : 					}
; 306  : 				}
; 307  : 			}
; 308  : 		}
; 309  : 	}
; 310  : }

  00119	8b e5		 mov	 esp, ebp
  0011b	5d		 pop	 ebp
  0011c	c2 04 00	 ret	 4
$LN17@KalimaGate@2:

; 237  : 		return;
; 238  : 	}
; 239  : 		
; 240  : 	DWORD dwTickCount = GetTickCount();

  0011f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__GetTickCount@0

; 241  : 
; 242  : 	if ( dwTickCount > lpObj->RegenTime + KALIMA_GATE_TIMEOUT )

  00125	8b 8e 08 02 00
	00		 mov	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+520]
  0012b	81 c1 20 bf 02
	00		 add	 ecx, 180000		; 0002bf20H
  00131	3b c1		 cmp	 eax, ecx
  00133	76 43		 jbe	 SHORT $LN16@KalimaGate@2

; 243  : 	{
; 244  : 		lpObjCallOwner->AccountID[MAX_ACCOUNT_LEN]=0;

  00135	c6 47 6e 00	 mov	 BYTE PTR [edi+110], 0

; 245  : 		lpObjCallOwner->Name[MAX_ACCOUNT_LEN]=0;

  00139	c6 47 79 00	 mov	 BYTE PTR [edi+121], 0

; 246  : 		
; 247  : 		LogAdd(LOG_BLACK, "[Kalima] [%s][%s] Kalima Gate Vanished - Time Out (SummonIndex:%d, EnterCount:%d)",
; 248  : 			lpObjCallOwner->AccountID, lpObjCallOwner->Name,
; 249  : 			iIndex, gObj[iIndex].m_cKalimaGateEnterCount );

  0013d	0f be 96 34 02
	00 00		 movsx	 edx, BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564]
  00144	52		 push	 edx
  00145	53		 push	 ebx
  00146	8d 47 6f	 lea	 eax, DWORD PTR [edi+111]
  00149	50		 push	 eax
  0014a	8d 4f 64	 lea	 ecx, DWORD PTR [edi+100]
  0014d	51		 push	 ecx
  0014e	68 00 00 00 00	 push	 OFFSET ??_C@_0FC@CCIHPNEM@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Kalima?5Gate?5Va@
  00153	6a 00		 push	 0
  00155	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 250  : 		this->DeleteKalimaGate(lpObj->m_Index, lpObjCallOwner->m_Index);

  0015a	8b 17		 mov	 edx, DWORD PTR [edi]
  0015c	8b 86 00 00 00
	00		 mov	 eax, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi]
  00162	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00165	83 c4 18	 add	 esp, 24			; 00000018H
  00168	52		 push	 edx
  00169	50		 push	 eax
  0016a	e8 00 00 00 00	 call	 ?DeleteKalimaGate@CKalimaGate@@QAEHHH@Z ; CKalimaGate::DeleteKalimaGate
  0016f	5f		 pop	 edi
  00170	5e		 pop	 esi
  00171	5b		 pop	 ebx

; 298  : 										{
; 299  : 											return;
; 300  : 										}
; 301  : 									}
; 302  : 								}
; 303  : 							}
; 304  : 						}
; 305  : 					}
; 306  : 				}
; 307  : 			}
; 308  : 		}
; 309  : 	}
; 310  : }

  00172	8b e5		 mov	 esp, ebp
  00174	5d		 pop	 ebp
  00175	c2 04 00	 ret	 4
$LN16@KalimaGate@2:

; 251  : 		return;
; 252  : 	}
; 253  : 
; 254  : 	if ( lpObj->VPCount < 1 )

  00178	83 be 98 0a 00
	00 01		 cmp	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+2712], 1
  0017f	0f 8c 5e 01 00
	00		 jl	 $LN33@KalimaGate@2

; 255  : 	{
; 256  : 		return;
; 257  : 	}
; 258  : 
; 259  : 	int tObjNum=-1;
; 260  : 
; 261  : 	for ( int i=0;i<MAX_VIEWPORT_MONSTER;i++)

  00185	8d 8e 92 03 00
	00		 lea	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+914]
  0018b	c7 45 ec 00 00
	00 00		 mov	 DWORD PTR _i$155772[ebp], 0
  00192	89 4d f8	 mov	 DWORD PTR tv524[ebp], ecx
$LL31@KalimaGate@2:

; 262  : 	{
; 263  : 		tObjNum = lpObj->VpPlayer[i].number;

  00195	8b 55 f8	 mov	 edx, DWORD PTR tv524[ebp]
  00198	0f bf 0a	 movsx	 ecx, WORD PTR [edx]

; 264  : 
; 265  : 		if ( tObjNum >= 0 )

  0019b	85 c9		 test	 ecx, ecx
  0019d	0f 88 2c 01 00
	00		 js	 $LN13@KalimaGate@2

; 266  : 		{
; 267  : 			if ( gObj[tObjNum].Type == OBJ_USER )

  001a3	8b d9		 mov	 ebx, ecx
  001a5	69 db 64 15 00
	00		 imul	 ebx, 5476		; 00001564H
  001ab	66 83 bb 60 00
	00 00 01	 cmp	 WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ebx+96], 1
  001b3	89 5d f0	 mov	 DWORD PTR tv407[ebp], ebx
  001b6	0f 85 13 01 00
	00		 jne	 $LN13@KalimaGate@2

; 268  : 			{
; 269  : 				if ( gObj[tObjNum].Live != FALSE )

  001bc	80 bb 62 00 00
	00 00		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ebx+98], 0
  001c3	0f 84 06 01 00
	00		 je	 $LN13@KalimaGate@2

; 270  : 				{
; 271  : 					if ( abs(lpObj->Y - gObj[tObjNum].Y) < 2 )

  001c9	0f bf 93 06 01
	00 00		 movsx	 edx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ebx+262]
  001d0	0f bf 86 06 01
	00 00		 movsx	 eax, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+262]
  001d7	2b c2		 sub	 eax, edx
  001d9	99		 cdq
  001da	33 c2		 xor	 eax, edx
  001dc	2b c2		 sub	 eax, edx
  001de	83 f8 02	 cmp	 eax, 2
  001e1	0f 8d e8 00 00
	00		 jge	 $LN13@KalimaGate@2

; 272  : 					{
; 273  : 						if ( abs(lpObj->X - gObj[tObjNum].X) < 2 )

  001e7	0f bf 93 04 01
	00 00		 movsx	 edx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ebx+260]
  001ee	0f bf 86 04 01
	00 00		 movsx	 eax, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+260]
  001f5	2b c2		 sub	 eax, edx
  001f7	99		 cdq
  001f8	33 c2		 xor	 eax, edx
  001fa	2b c2		 sub	 eax, edx
  001fc	83 f8 02	 cmp	 eax, 2
  001ff	0f 8d ca 00 00
	00		 jge	 $LN13@KalimaGate@2

; 274  : 						{
; 275  : 							if ( lpObj->m_RecallMon == tObjNum || (gObj[tObjNum].PartyNumber != -1 && lpObjCallOwner->PartyNumber == gObj[tObjNum].PartyNumber ))

  00205	39 8e cc 02 00
	00		 cmp	 DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+716], ecx
  0020b	74 1b		 je	 SHORT $LN5@KalimaGate@2
  0020d	8b 9b a8 02 00
	00		 mov	 ebx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[ebx+680]
  00213	83 fb ff	 cmp	 ebx, -1
  00216	0f 84 b3 00 00
	00		 je	 $LN13@KalimaGate@2
  0021c	39 9f a8 02 00
	00		 cmp	 DWORD PTR [edi+680], ebx
  00222	0f 85 a7 00 00
	00		 jne	 $LN13@KalimaGate@2
$LN5@KalimaGate@2:

; 276  : 							{
; 277  : 								int iMoveMapLevel = lpObj->m_Attribute -51;

  00228	0f bf 9e 26 03
	00 00		 movsx	 ebx, WORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+806]
  0022f	83 eb 33	 sub	 ebx, 51			; 00000033H

; 278  : 								int iMapNumber = iMoveMapLevel + 24;

  00232	8d 43 18	 lea	 eax, DWORD PTR [ebx+24]

; 279  : 								int iGateNumber = g_iKalimaGateGateIndex[iMoveMapLevel];
; 280  : 								int iOverLevel = this->GetKalimaGateLevel(tObjNum);

  00235	51		 push	 ecx
  00236	8b 4d fc	 mov	 ecx, DWORD PTR _this$[ebp]
  00239	89 45 f4	 mov	 DWORD PTR _iMapNumber$155784[ebp], eax
  0023c	e8 00 00 00 00	 call	 ?GetKalimaGateLevel@CKalimaGate@@AAEHH@Z ; CKalimaGate::GetKalimaGateLevel

; 281  : 
; 282  : 								if ( iOverLevel >= iMoveMapLevel )

  00241	3b c3		 cmp	 eax, ebx
  00243	0f 8c 86 00 00
	00		 jl	 $LN13@KalimaGate@2

; 283  : 								{
; 284  : 									if ( gObjMoveGate(tObjNum, iGateNumber) == FALSE )

  00249	8b 04 9d 00 00
	00 00		 mov	 eax, DWORD PTR _g_iKalimaGateGateIndex[ebx*4]
  00250	8b 4d f8	 mov	 ecx, DWORD PTR tv524[ebp]
  00253	50		 push	 eax
  00254	0f bf 01	 movsx	 eax, WORD PTR [ecx]
  00257	50		 push	 eax
  00258	e8 00 00 00 00	 call	 ?gObjMoveGate@@YAHHH@Z	; gObjMoveGate

; 285  : 									{
; 286  : 										LogAdd(LOG_BLACK, "[Kalima] [%s][%s] - [%s][%s] move fail (MapNumber:%d)", 
; 287  : 											lpObjCallOwner->AccountID, lpObjCallOwner->Name,
; 288  : 											gObj[tObjNum].AccountID, gObj[tObjNum].Name, iMapNumber);

  0025d	8b 55 f4	 mov	 edx, DWORD PTR _iMapNumber$155784[ebp]
  00260	83 c4 08	 add	 esp, 8
  00263	52		 push	 edx
  00264	85 c0		 test	 eax, eax
  00266	75 2a		 jne	 SHORT $LN3@KalimaGate@2
  00268	8b 45 f0	 mov	 eax, DWORD PTR tv407[ebp]
  0026b	8d 88 6f 00 00
	00		 lea	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[eax+111]
  00271	51		 push	 ecx
  00272	8d 90 64 00 00
	00		 lea	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[eax+100]
  00278	52		 push	 edx
  00279	8d 47 6f	 lea	 eax, DWORD PTR [edi+111]
  0027c	50		 push	 eax
  0027d	8d 4f 64	 lea	 ecx, DWORD PTR [edi+100]
  00280	51		 push	 ecx
  00281	68 00 00 00 00	 push	 OFFSET ??_C@_0DG@DFEBENJO@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5mov@
  00286	6a 00		 push	 0
  00288	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd
  0028d	83 c4 1c	 add	 esp, 28			; 0000001cH

; 289  : 									}
; 290  : 									else

  00290	eb 3d		 jmp	 SHORT $LN13@KalimaGate@2
$LN3@KalimaGate@2:

; 291  : 									{
; 292  : 										LogAdd(LOG_BLACK, "[Kalima] [%s][%s] - [%s][%s] Transported by Kalima Gate (SummonIndex:%d, GateNo.:%d, MapNumber:%d)",
; 293  : 											lpObjCallOwner->AccountID, lpObjCallOwner->Name, 
; 294  : 											gObj[tObjNum].AccountID, gObj[tObjNum].Name, iIndex, iMoveMapLevel + 1, iMapNumber);

  00292	8b 45 08	 mov	 eax, DWORD PTR _iIndex$[ebp]
  00295	43		 inc	 ebx
  00296	53		 push	 ebx
  00297	50		 push	 eax
  00298	8b 45 f0	 mov	 eax, DWORD PTR tv407[ebp]
  0029b	8d 88 6f 00 00
	00		 lea	 ecx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[eax+111]
  002a1	51		 push	 ecx
  002a2	8d 90 64 00 00
	00		 lea	 edx, DWORD PTR ?gObj@@3PAUOBJECTSTRUCT@@A[eax+100]
  002a8	52		 push	 edx
  002a9	8d 47 6f	 lea	 eax, DWORD PTR [edi+111]
  002ac	50		 push	 eax
  002ad	8d 4f 64	 lea	 ecx, DWORD PTR [edi+100]
  002b0	51		 push	 ecx
  002b1	68 00 00 00 00	 push	 OFFSET ??_C@_0GD@MOAKLAME@?$FLKalima?$FN?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5?9?5?$FL?$CFs?$FN?$FL?$CFs?$FN?5Tra@
  002b6	6a 00		 push	 0
  002b8	e8 00 00 00 00	 call	 ?LogAdd@@YAXW4eLogColor@@PADZZ ; LogAdd

; 295  : 										gObj[iIndex].m_cKalimaGateEnterCount ++;

  002bd	fe 86 34 02 00
	00		 inc	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564]
  002c3	83 c4 24	 add	 esp, 36			; 00000024H

; 296  : 
; 297  : 										if ( gObj[iIndex].m_cKalimaGateEnterCount >= MAX_KALIMA_ENTER )

  002c6	80 be 34 02 00
	00 05		 cmp	 BYTE PTR ?gObj@@3PAUOBJECTSTRUCT@@A[esi+564], 5
  002cd	7d 14		 jge	 SHORT $LN33@KalimaGate@2
$LN13@KalimaGate@2:

; 255  : 	{
; 256  : 		return;
; 257  : 	}
; 258  : 
; 259  : 	int tObjNum=-1;
; 260  : 
; 261  : 	for ( int i=0;i<MAX_VIEWPORT_MONSTER;i++)

  002cf	8b 45 ec	 mov	 eax, DWORD PTR _i$155772[ebp]
  002d2	83 45 f8 0c	 add	 DWORD PTR tv524[ebp], 12 ; 0000000cH
  002d6	40		 inc	 eax
  002d7	89 45 ec	 mov	 DWORD PTR _i$155772[ebp], eax
  002da	83 f8 14	 cmp	 eax, 20			; 00000014H
  002dd	0f 8c b2 fe ff
	ff		 jl	 $LL31@KalimaGate@2
$LN33@KalimaGate@2:
  002e3	5f		 pop	 edi
$LN32@KalimaGate@2:
  002e4	5e		 pop	 esi
$LN27@KalimaGate@2:
  002e5	5b		 pop	 ebx

; 298  : 										{
; 299  : 											return;
; 300  : 										}
; 301  : 									}
; 302  : 								}
; 303  : 							}
; 304  : 						}
; 305  : 					}
; 306  : 				}
; 307  : 			}
; 308  : 		}
; 309  : 	}
; 310  : }

  002e6	8b e5		 mov	 esp, ebp
  002e8	5d		 pop	 ebp
  002e9	c2 04 00	 ret	 4
?KalimaGateAct@CKalimaGate@@QAEXH@Z ENDP		; CKalimaGate::KalimaGateAct
_TEXT	ENDS
EXTRN	_atexit:PROC
; Function compile flags: /Ogtp
;	COMDAT ??__Eg_KalimaGate@@YAXXZ
text$yc	SEGMENT
??__Eg_KalimaGate@@YAXXZ PROC				; `dynamic initializer for 'g_KalimaGate'', COMDAT

; 15   : CKalimaGate g_KalimaGate;

  00000	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_KalimaGate@@3VCKalimaGate@@A ; g_KalimaGate
  00005	e8 00 00 00 00	 call	 ??0CKalimaGate@@QAE@XZ	; CKalimaGate::CKalimaGate
  0000a	68 00 00 00 00	 push	 OFFSET ??__Fg_KalimaGate@@YAXXZ ; `dynamic atexit destructor for 'g_KalimaGate''
  0000f	e8 00 00 00 00	 call	 _atexit
  00014	59		 pop	 ecx
  00015	c3		 ret	 0
??__Eg_KalimaGate@@YAXXZ ENDP				; `dynamic initializer for 'g_KalimaGate''
; Function compile flags: /Ogtp
text$yc	ENDS
;	COMDAT ??__Fg_KalimaGate@@YAXXZ
text$yd	SEGMENT
??__Fg_KalimaGate@@YAXXZ PROC				; `dynamic atexit destructor for 'g_KalimaGate'', COMDAT
  00000	b9 00 00 00 00	 mov	 ecx, OFFSET ?g_KalimaGate@@3VCKalimaGate@@A ; g_KalimaGate
  00005	e9 00 00 00 00	 jmp	 ??1CKalimaGate@@UAE@XZ	; CKalimaGate::~CKalimaGate
??__Fg_KalimaGate@@YAXXZ ENDP				; `dynamic atexit destructor for 'g_KalimaGate''
text$yd	ENDS
PUBLIC	?g_KalimaGate@@3VCKalimaGate@@A			; g_KalimaGate
_BSS	SEGMENT
?g_KalimaGate@@3VCKalimaGate@@A DB 01cH DUP (?)		; g_KalimaGate
_BSS	ENDS
CRT$XCU	SEGMENT
_g_KalimaGate$initializer$ DD FLAT:??__Eg_KalimaGate@@YAXXZ
CRT$XCU	ENDS
END
